{
  "version": 3,
  "sources": ["../../../client/node_modules/@eleven-am/pondsocket-common/subjects/subject.js", "../../../client/node_modules/@eleven-am/pondsocket-common/subjects/behaviorSubject.js", "../../../client/node_modules/@eleven-am/pondsocket-common/subjects/index.js", "../../../client/node_modules/@eleven-am/pondsocket-common/enums.js", "../../../client/node_modules/@eleven-am/pondsocket-common/misc/uuid.js", "../../../client/node_modules/@eleven-am/pondsocket-common/misc/types.js", "../../../client/node_modules/@eleven-am/pondsocket-common/misc/index.js", "../../../client/node_modules/@eleven-am/pondsocket-common/schema.js", "../../../client/node_modules/@eleven-am/pondsocket-common/index.js", "../../../client/node_modules/@eleven-am/pondsocket-client/core/channel.js", "../../../client/node_modules/@eleven-am/pondsocket-client/browser/client.js", "../../../client/node_modules/es5-ext/global.js", "../../../client/node_modules/websocket/package.json", "../../../client/node_modules/websocket/lib/version.js", "../../../client/node_modules/websocket/lib/browser.js", "../../../client/node_modules/@eleven-am/pondsocket-client/node/node.js", "../../../client/node_modules/@eleven-am/pondsocket-client/index.js", "../../../client/src/index.ts", "../../../client/src/protocol.ts", "../../../client/src/bus.ts", "../../../client/src/transport.ts", "../../../client/src/logger.ts", "../../../client/src/patcher.ts", "../../../client/src/executor.ts", "../../../client/src/scripts.ts", "../../../client/src/runtime.ts"],
  "sourcesContent": ["\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _Subject_isClosed, _Subject_observers;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Subject = void 0;\nclass Subject {\n    constructor() {\n        _Subject_isClosed.set(this, void 0);\n        _Subject_observers.set(this, void 0);\n        __classPrivateFieldSet(this, _Subject_isClosed, false, \"f\");\n        __classPrivateFieldSet(this, _Subject_observers, new Set(), \"f\");\n    }\n    /**\n     * @desc Returns the number of subscribers\n     */\n    get size() {\n        return __classPrivateFieldGet(this, _Subject_observers, \"f\").size;\n    }\n    /**\n     * @desc Subscribes to a subject\n     * @param observer - The observer to subscribe\n     */\n    subscribe(observer) {\n        if (__classPrivateFieldGet(this, _Subject_isClosed, \"f\")) {\n            throw new Error('Cannot subscribe to a closed subject');\n        }\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").add(observer);\n        return () => __classPrivateFieldGet(this, _Subject_observers, \"f\").delete(observer);\n    }\n    /**\n     * @desc Publishes a message to all subscribers\n     * @param message - The message to publish\n     */\n    publish(message) {\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").forEach((observer) => observer(message));\n    }\n    /**\n     * @desc Closes the subject\n     */\n    close() {\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").clear();\n        __classPrivateFieldSet(this, _Subject_isClosed, true, \"f\");\n    }\n}\nexports.Subject = Subject;\n_Subject_isClosed = new WeakMap(), _Subject_observers = new WeakMap();\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _BehaviorSubject_lastMessage;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BehaviorSubject = void 0;\nconst subject_1 = require(\"./subject\");\nclass BehaviorSubject extends subject_1.Subject {\n    constructor(initialValue) {\n        super();\n        _BehaviorSubject_lastMessage.set(this, void 0);\n        __classPrivateFieldSet(this, _BehaviorSubject_lastMessage, initialValue, \"f\");\n    }\n    /**\n     * @desc Returns the last message published\n     */\n    get value() {\n        return __classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\");\n    }\n    /**\n     * @desc Publishes a message to all subscribers\n     * @param message - The message to publish\n     */\n    publish(message) {\n        __classPrivateFieldSet(this, _BehaviorSubject_lastMessage, message, \"f\");\n        super.publish(message);\n    }\n    /**\n     * @desc Subscribes to a subject\n     * @param observer - The observer to subscribe\n     */\n    subscribe(observer) {\n        if (__classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\")) {\n            observer(__classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\"));\n        }\n        return super.subscribe(observer);\n    }\n}\nexports.BehaviorSubject = BehaviorSubject;\n_BehaviorSubject_lastMessage = new WeakMap();\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./behaviorSubject\"), exports);\n__exportStar(require(\"./subject\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PubSubEvents = exports.Events = exports.ChannelReceiver = exports.SystemSender = exports.ErrorTypes = exports.ChannelState = exports.ClientActions = exports.ServerActions = exports.PresenceEventTypes = void 0;\nvar PresenceEventTypes;\n(function (PresenceEventTypes) {\n    PresenceEventTypes[\"JOIN\"] = \"JOIN\";\n    PresenceEventTypes[\"LEAVE\"] = \"LEAVE\";\n    PresenceEventTypes[\"UPDATE\"] = \"UPDATE\";\n})(PresenceEventTypes || (exports.PresenceEventTypes = PresenceEventTypes = {}));\nvar ServerActions;\n(function (ServerActions) {\n    ServerActions[\"PRESENCE\"] = \"PRESENCE\";\n    ServerActions[\"SYSTEM\"] = \"SYSTEM\";\n    ServerActions[\"BROADCAST\"] = \"BROADCAST\";\n    ServerActions[\"ERROR\"] = \"ERROR\";\n    ServerActions[\"CONNECT\"] = \"CONNECT\";\n})(ServerActions || (exports.ServerActions = ServerActions = {}));\nvar ClientActions;\n(function (ClientActions) {\n    ClientActions[\"JOIN_CHANNEL\"] = \"JOIN_CHANNEL\";\n    ClientActions[\"LEAVE_CHANNEL\"] = \"LEAVE_CHANNEL\";\n    ClientActions[\"BROADCAST\"] = \"BROADCAST\";\n})(ClientActions || (exports.ClientActions = ClientActions = {}));\nvar ChannelState;\n(function (ChannelState) {\n    ChannelState[\"IDLE\"] = \"IDLE\";\n    ChannelState[\"JOINING\"] = \"JOINING\";\n    ChannelState[\"JOINED\"] = \"JOINED\";\n    ChannelState[\"STALLED\"] = \"STALLED\";\n    ChannelState[\"CLOSED\"] = \"CLOSED\";\n})(ChannelState || (exports.ChannelState = ChannelState = {}));\nvar ErrorTypes;\n(function (ErrorTypes) {\n    ErrorTypes[\"UNAUTHORIZED_CONNECTION\"] = \"UNAUTHORIZED_CONNECTION\";\n    ErrorTypes[\"UNAUTHORIZED_JOIN_REQUEST\"] = \"UNAUTHORIZED_JOIN_REQUEST\";\n    ErrorTypes[\"UNAUTHORIZED_BROADCAST\"] = \"UNAUTHORIZED_BROADCAST\";\n    ErrorTypes[\"INVALID_MESSAGE\"] = \"INVALID_MESSAGE\";\n    ErrorTypes[\"HANDLER_NOT_FOUND\"] = \"HANDLER_NOT_FOUND\";\n    ErrorTypes[\"PRESENCE_ERROR\"] = \"PRESENCE_ERROR\";\n    ErrorTypes[\"CHANNEL_ERROR\"] = \"CHANNEL_ERROR\";\n    ErrorTypes[\"ENDPOINT_ERROR\"] = \"ENDPOINT_ERROR\";\n    ErrorTypes[\"INTERNAL_SERVER_ERROR\"] = \"INTERNAL_SERVER_ERROR\";\n})(ErrorTypes || (exports.ErrorTypes = ErrorTypes = {}));\nvar SystemSender;\n(function (SystemSender) {\n    SystemSender[\"ENDPOINT\"] = \"ENDPOINT\";\n    SystemSender[\"CHANNEL\"] = \"CHANNEL\";\n})(SystemSender || (exports.SystemSender = SystemSender = {}));\nvar ChannelReceiver;\n(function (ChannelReceiver) {\n    ChannelReceiver[\"ALL_USERS\"] = \"ALL_USERS\";\n    ChannelReceiver[\"ALL_EXCEPT_SENDER\"] = \"ALL_EXCEPT_SENDER\";\n})(ChannelReceiver || (exports.ChannelReceiver = ChannelReceiver = {}));\nvar Events;\n(function (Events) {\n    Events[\"ACKNOWLEDGE\"] = \"ACKNOWLEDGE\";\n    Events[\"CONNECTION\"] = \"CONNECTION\";\n})(Events || (exports.Events = Events = {}));\nvar PubSubEvents;\n(function (PubSubEvents) {\n    PubSubEvents[\"MESSAGE\"] = \"MESSAGE\";\n    PubSubEvents[\"PRESENCE\"] = \"PRESENCE\";\n    PubSubEvents[\"GET_PRESENCE\"] = \"GET_PRESENCE\";\n})(PubSubEvents || (exports.PubSubEvents = PubSubEvents = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uuid = uuid;\nfunction uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\n        .replace(/[xy]/g, (c) => {\n        const r = Math.random() * 16 | 0;\n        const v = c === 'x' ? r : (r & 0x3 | 0x8);\n        return v.toString(16);\n    });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./uuid\"), exports);\n__exportStar(require(\"./types\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.channelEventSchema = exports.serverMessageSchema = exports.presenceMessageSchema = exports.clientMessageSchema = exports.ValidationError = void 0;\nconst enums_1 = require(\"./enums\");\n// ============================================================================\n// Validation Error\n// ============================================================================\nclass ValidationError extends Error {\n    constructor(message, path) {\n        super(path ? `${path}: ${message}` : message);\n        this.path = path;\n        this.name = 'ValidationError';\n    }\n}\nexports.ValidationError = ValidationError;\n// ============================================================================\n// Validation Utilities\n// ============================================================================\nfunction isObject(value) {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\nfunction isString(value) {\n    return typeof value === 'string';\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nfunction isRecord(value) {\n    if (!isObject(value)) {\n        return false;\n    }\n    return Object.keys(value)\n        .every((key) => typeof key === 'string');\n}\nfunction validateString(value, fieldName) {\n    if (!isString(value)) {\n        throw new ValidationError(`Expected string, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateObject(value, fieldName) {\n    if (!isObject(value)) {\n        throw new ValidationError(`Expected object, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateRecord(value, fieldName) {\n    if (!isRecord(value)) {\n        throw new ValidationError(`Expected record with string keys, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateArray(value, fieldName) {\n    if (!isArray(value)) {\n        throw new ValidationError(`Expected array, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateEnum(value, enumObj, fieldName) {\n    const validValues = Object.values(enumObj);\n    if (!validValues.includes(value)) {\n        throw new ValidationError(`Expected one of [${validValues.join(', ')}], got ${JSON.stringify(value)}`, fieldName);\n    }\n}\n// ============================================================================\n// Schema Validators\n// ============================================================================\nexports.clientMessageSchema = {\n    parse(data) {\n        validateObject(data, 'clientMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Validate types\n        validateString(obj.event, 'event');\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateRecord(obj.payload, 'payload');\n        validateEnum(obj.action, enums_1.ClientActions, 'action');\n        return {\n            event: obj.event,\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            payload: obj.payload,\n            action: obj.action,\n        };\n    },\n};\nexports.presenceMessageSchema = {\n    parse(data) {\n        validateObject(data, 'presenceMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        // Validate types\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateEnum(obj.event, enums_1.PresenceEventTypes, 'event');\n        // Validate action is exactly PRESENCE\n        if (obj.action !== enums_1.ServerActions.PRESENCE) {\n            throw new ValidationError(`Expected ${enums_1.ServerActions.PRESENCE}, got ${JSON.stringify(obj.action)}`, 'action');\n        }\n        // Validate payload structure\n        validateObject(obj.payload, 'payload');\n        const payload = obj.payload;\n        if (!('presence' in payload)) {\n            throw new ValidationError('Missing required field', 'payload.presence');\n        }\n        if (!('changed' in payload)) {\n            throw new ValidationError('Missing required field', 'payload.changed');\n        }\n        validateArray(payload.presence, 'payload.presence');\n        // Validate each presence item is a record\n        payload.presence.forEach((item, index) => {\n            validateRecord(item, `payload.presence[${index}]`);\n        });\n        validateRecord(payload.changed, 'payload.changed');\n        return {\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            event: obj.event,\n            action: enums_1.ServerActions.PRESENCE,\n            payload: {\n                presence: payload.presence,\n                changed: payload.changed,\n            },\n        };\n    },\n};\nexports.serverMessageSchema = {\n    parse(data) {\n        validateObject(data, 'serverMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Validate types\n        validateString(obj.event, 'event');\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateRecord(obj.payload, 'payload');\n        // Validate action is one of the allowed server actions\n        const validActions = [\n            enums_1.ServerActions.BROADCAST,\n            enums_1.ServerActions.CONNECT,\n            enums_1.ServerActions.ERROR,\n            enums_1.ServerActions.SYSTEM,\n        ];\n        if (!validActions.includes(obj.action)) {\n            throw new ValidationError(`Expected one of [${validActions.join(', ')}], got ${JSON.stringify(obj.action)}`, 'action');\n        }\n        return {\n            event: obj.event,\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            payload: obj.payload,\n            action: obj.action,\n        };\n    },\n};\nexports.channelEventSchema = {\n    parse(data) {\n        validateObject(data, 'channelEvent');\n        const obj = data;\n        // Check action to determine which schema to use\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Discriminate based on action field\n        if (obj.action === enums_1.ServerActions.PRESENCE) {\n            return exports.presenceMessageSchema.parse(data);\n        }\n        return exports.serverMessageSchema.parse(data);\n    },\n};\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./subjects\"), exports);\n__exportStar(require(\"./enums\"), exports);\n__exportStar(require(\"./misc\"), exports);\n__exportStar(require(\"./schema\"), exports);\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _Channel_instances, _Channel_name, _Channel_queue, _Channel_presence, _Channel_presenceSub, _Channel_publisher, _Channel_joinParams, _Channel_receiver, _Channel_clientState, _Channel_joinState, _Channel_emptyQueue, _Channel_init, _Channel_onMessage, _Channel_publish, _Channel_subscribeToPresence;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Channel = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nclass Channel {\n    constructor(publisher, clientState, name, params) {\n        _Channel_instances.add(this);\n        _Channel_name.set(this, void 0);\n        _Channel_queue.set(this, void 0);\n        _Channel_presence.set(this, void 0);\n        _Channel_presenceSub.set(this, void 0);\n        _Channel_publisher.set(this, void 0);\n        _Channel_joinParams.set(this, void 0);\n        _Channel_receiver.set(this, void 0);\n        _Channel_clientState.set(this, void 0);\n        _Channel_joinState.set(this, void 0);\n        __classPrivateFieldSet(this, _Channel_name, name, \"f\");\n        __classPrivateFieldSet(this, _Channel_queue, [], \"f\");\n        __classPrivateFieldSet(this, _Channel_presence, [], \"f\");\n        __classPrivateFieldSet(this, _Channel_joinParams, params, \"f\");\n        __classPrivateFieldSet(this, _Channel_publisher, publisher, \"f\");\n        __classPrivateFieldSet(this, _Channel_clientState, clientState, \"f\");\n        __classPrivateFieldSet(this, _Channel_receiver, new pondsocket_common_1.Subject(), \"f\");\n        __classPrivateFieldSet(this, _Channel_joinState, new pondsocket_common_1.BehaviorSubject(pondsocket_common_1.ChannelState.IDLE), \"f\");\n        __classPrivateFieldSet(this, _Channel_presenceSub, () => {\n            // do nothing\n        }, \"f\");\n    }\n    /**\n     * @desc Gets the current connection state of the channel.\n     */\n    get channelState() {\n        return __classPrivateFieldGet(this, _Channel_joinState, \"f\").value;\n    }\n    /**\n     * @desc Gets the current presence of the channel.\n     */\n    get presence() {\n        return __classPrivateFieldGet(this, _Channel_presence, \"f\");\n    }\n    /**\n     * @desc Acknowledges the channel has been joined on the server.\n     * @param receiver - The receiver to subscribe to.\n     */\n    acknowledge(receiver) {\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.JOINED);\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_init).call(this, receiver);\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_emptyQueue).call(this);\n    }\n    /**\n     * @desc Connects to the channel.\n     */\n    join() {\n        const message = {\n            action: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n            event: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n            payload: __classPrivateFieldGet(this, _Channel_joinParams, \"f\"),\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId: (0, pondsocket_common_1.uuid)(),\n        };\n        if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n            return;\n        }\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.JOINING);\n        if (__classPrivateFieldGet(this, _Channel_clientState, \"f\").value) {\n            __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n        }\n        else {\n            const unsubscribe = __classPrivateFieldGet(this, _Channel_clientState, \"f\").subscribe((state) => {\n                if (state) {\n                    unsubscribe();\n                    if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINING) {\n                        __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n                    }\n                }\n            });\n        }\n    }\n    /**\n     * @desc Disconnects from the channel.\n     */\n    leave() {\n        const message = {\n            action: pondsocket_common_1.ClientActions.LEAVE_CHANNEL,\n            event: pondsocket_common_1.ClientActions.LEAVE_CHANNEL,\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId: (0, pondsocket_common_1.uuid)(),\n            payload: {},\n        };\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.CLOSED);\n        __classPrivateFieldGet(this, _Channel_presenceSub, \"f\").call(this);\n    }\n    /**\n     * @desc Monitors the channel state of the channel.\n     * @param callback - The callback to call when the connection state changes.\n     */\n    onChannelStateChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_joinState, \"f\").subscribe((data) => {\n            callback(data);\n        });\n    }\n    /**\n     * @desc Detects when clients join the channel.\n     * @param callback - The callback to call when a client joins the channel.\n     */\n    onJoin(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.JOIN) {\n                return callback(payload.changed);\n            }\n        });\n    }\n    /**\n     * @desc Detects when clients leave the channel.\n     * @param callback - The callback to call when a client leaves the channel.\n     */\n    onLeave(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.LEAVE) {\n                return callback(payload.changed);\n            }\n        });\n    }\n    /**\n     * @desc Monitors the channel for messages.\n     * @param callback - The callback to call when a message is received.\n     */\n    onMessage(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_onMessage).call(this, (event, message) => {\n            callback(event, message);\n        });\n    }\n    /**\n     * @desc Monitors the channel for messages.\n     * @param event - The event to monitor.\n     * @param callback - The callback to call when a message is received.\n     */\n    onMessageEvent(event, callback) {\n        return this.onMessage((eventReceived, message) => {\n            if (eventReceived === event) {\n                return callback(message);\n            }\n        });\n    }\n    /**\n     * @desc Detects when clients change their presence in the channel.\n     * @param callback - The callback to call when a client changes their presence in the channel.\n     */\n    onPresenceChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.UPDATE) {\n                return callback(payload);\n            }\n        });\n    }\n    /**\n     * @desc Monitors the presence of the channel.\n     * @param callback - The callback to call when the presence changes.\n     */\n    onUsersChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (_event, payload) => callback(payload.presence));\n    }\n    /**\n     * @desc Sends a message to specific clients in the channel.\n     * @param event - The event to send.\n     * @param payload - The message to send.\n     */\n    sendMessage(event, payload) {\n        const requestId = (0, pondsocket_common_1.uuid)();\n        const message = {\n            action: pondsocket_common_1.ClientActions.BROADCAST,\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId,\n            event,\n            payload,\n        };\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n    }\n    /**\n     * @desc Sends a message to the server and waits for a response.\n     * @param sentEvent - The event to send.\n     * @param payload - The message to send.\n     */\n    sendForResponse(sentEvent, payload) {\n        const requestId = (0, pondsocket_common_1.uuid)();\n        return new Promise((resolve) => {\n            const unsub = __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_onMessage).call(this, (_, message, responseId) => {\n                if (requestId === responseId) {\n                    resolve(message);\n                    unsub();\n                }\n            });\n            const message = {\n                action: pondsocket_common_1.ClientActions.BROADCAST,\n                channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n                requestId,\n                event: sentEvent,\n                payload,\n            };\n            __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n        });\n    }\n}\nexports.Channel = Channel;\n_Channel_name = new WeakMap(), _Channel_queue = new WeakMap(), _Channel_presence = new WeakMap(), _Channel_presenceSub = new WeakMap(), _Channel_publisher = new WeakMap(), _Channel_joinParams = new WeakMap(), _Channel_receiver = new WeakMap(), _Channel_clientState = new WeakMap(), _Channel_joinState = new WeakMap(), _Channel_instances = new WeakSet(), _Channel_emptyQueue = function _Channel_emptyQueue() {\n    __classPrivateFieldGet(this, _Channel_queue, \"f\")\n        .forEach((message) => __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message));\n    __classPrivateFieldSet(this, _Channel_queue, [], \"f\");\n}, _Channel_init = function _Channel_init(receiver) {\n    __classPrivateFieldGet(this, _Channel_presenceSub, \"f\").call(this);\n    const unsubMessages = receiver.subscribe((data) => {\n        if (data.channelName === __classPrivateFieldGet(this, _Channel_name, \"f\") && this.channelState === pondsocket_common_1.ChannelState.JOINED) {\n            __classPrivateFieldGet(this, _Channel_receiver, \"f\").publish(data);\n        }\n    });\n    const unsubStateChange = __classPrivateFieldGet(this, _Channel_clientState, \"f\").subscribe((state) => {\n        if (state && __classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.STALLED) {\n            const message = {\n                action: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n                event: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n                payload: __classPrivateFieldGet(this, _Channel_joinParams, \"f\"),\n                channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n                requestId: (0, pondsocket_common_1.uuid)(),\n            };\n            __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n        }\n        else if (!state && __classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n            __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.STALLED);\n        }\n    });\n    const unsubPresence = __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (_, payload) => {\n        __classPrivateFieldSet(this, _Channel_presence, payload.presence, \"f\");\n    });\n    __classPrivateFieldSet(this, _Channel_presenceSub, () => {\n        unsubMessages();\n        unsubStateChange();\n        unsubPresence();\n    }, \"f\");\n}, _Channel_onMessage = function _Channel_onMessage(callback) {\n    return __classPrivateFieldGet(this, _Channel_receiver, \"f\").subscribe((data) => {\n        if (data.action !== pondsocket_common_1.ServerActions.PRESENCE) {\n            return callback(data.event, data.payload, data.requestId);\n        }\n    });\n}, _Channel_publish = function _Channel_publish(data) {\n    if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n        return __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, data);\n    }\n    __classPrivateFieldGet(this, _Channel_queue, \"f\").push(data);\n}, _Channel_subscribeToPresence = function _Channel_subscribeToPresence(callback) {\n    return __classPrivateFieldGet(this, _Channel_receiver, \"f\").subscribe((data) => {\n        if (data.action === pondsocket_common_1.ServerActions.PRESENCE) {\n            return callback(data.event, data.payload);\n        }\n    });\n};\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _PondClient_instances, _PondClient_channels, _PondClient_createPublisher, _PondClient_handleAcknowledge, _PondClient_init;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nconst channel_1 = require(\"../core/channel\");\nclass PondClient {\n    constructor(endpoint, params = {}) {\n        _PondClient_instances.add(this);\n        _PondClient_channels.set(this, void 0);\n        let address;\n        try {\n            address = new URL(endpoint);\n        }\n        catch (e) {\n            address = new URL(window.location.toString());\n            address.pathname = endpoint;\n        }\n        this._disconnecting = false;\n        const query = new URLSearchParams(params);\n        address.search = query.toString();\n        const protocol = address.protocol === 'https:' ? 'wss:' : 'ws:';\n        if (address.protocol !== 'wss:' && address.protocol !== 'ws:') {\n            address.protocol = protocol;\n        }\n        this._address = address;\n        __classPrivateFieldSet(this, _PondClient_channels, new Map(), \"f\");\n        this._broadcaster = new pondsocket_common_1.Subject();\n        this._connectionState = new pondsocket_common_1.BehaviorSubject(false);\n        __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_init).call(this);\n    }\n    /**\n     * @desc Connects to the server and returns the socket.\n     */\n    connect() {\n        this._disconnecting = false;\n        const socket = new WebSocket(this._address.toString());\n        socket.onmessage = (message) => {\n            const lines = message.data.trim().split('\\n');\n            for (const line of lines) {\n                if (line.trim()) {\n                    const data = JSON.parse(line);\n                    const event = pondsocket_common_1.channelEventSchema.parse(data);\n                    this._broadcaster.publish(event);\n                }\n            }\n        };\n        socket.onerror = () => socket.close();\n        socket.onclose = () => {\n            this._connectionState.publish(false);\n            if (this._disconnecting) {\n                return;\n            }\n            setTimeout(() => {\n                this.connect();\n            }, 1000);\n        };\n        this._socket = socket;\n    }\n    /**\n     * @desc Returns the current state of the socket.\n     */\n    getState() {\n        return this._connectionState.value;\n    }\n    /**\n     * @desc Disconnects the socket.\n     */\n    disconnect() {\n        var _a;\n        this._connectionState.publish(false);\n        this._disconnecting = true;\n        (_a = this._socket) === null || _a === void 0 ? void 0 : _a.close();\n        __classPrivateFieldGet(this, _PondClient_channels, \"f\").clear();\n    }\n    /**\n     * @desc Creates a channel with the given name and params.\n     * @param name - The name of the channel.\n     * @param params - The params to send to the server.\n     */\n    createChannel(name, params) {\n        const channel = __classPrivateFieldGet(this, _PondClient_channels, \"f\").get(name);\n        if (channel && channel.channelState !== pondsocket_common_1.ChannelState.CLOSED) {\n            return channel;\n        }\n        const publisher = __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_createPublisher).call(this);\n        const newChannel = new channel_1.Channel(publisher, this._connectionState, name, params || {});\n        __classPrivateFieldGet(this, _PondClient_channels, \"f\").set(name, newChannel);\n        return newChannel;\n    }\n    /**\n     * @desc Subscribes to the connection state.\n     * @param callback - The callback to call when the state changes.\n     */\n    onConnectionChange(callback) {\n        return this._connectionState.subscribe(callback);\n    }\n}\nexports.PondClient = PondClient;\n_PondClient_channels = new WeakMap(), _PondClient_instances = new WeakSet(), _PondClient_createPublisher = function _PondClient_createPublisher() {\n    return (message) => {\n        if (this._connectionState.value) {\n            this._socket.send(JSON.stringify(message));\n        }\n    };\n}, _PondClient_handleAcknowledge = function _PondClient_handleAcknowledge(message) {\n    var _a;\n    const channel = (_a = __classPrivateFieldGet(this, _PondClient_channels, \"f\").get(message.channelName)) !== null && _a !== void 0 ? _a : new channel_1.Channel(__classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_createPublisher).call(this), this._connectionState, message.channelName, {});\n    __classPrivateFieldGet(this, _PondClient_channels, \"f\").set(message.channelName, channel);\n    channel.acknowledge(this._broadcaster);\n}, _PondClient_init = function _PondClient_init() {\n    this._broadcaster.subscribe((message) => {\n        if (message.event === pondsocket_common_1.Events.ACKNOWLEDGE) {\n            __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_handleAcknowledge).call(this, message);\n        }\n        else if (message.event === pondsocket_common_1.Events.CONNECTION && message.action === pondsocket_common_1.ServerActions.CONNECT) {\n            this._connectionState.publish(true);\n        }\n    });\n};\n", "var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Fallback to standard globalThis if available\n\tif (typeof globalThis === \"object\" && globalThis) return globalThis;\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of updates to Object.prototype being restricted\n\t\t// via preventExtensions, seal or freeze\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ works, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n", "{\n  \"name\": \"websocket\",\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"author\": \"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)\",\n  \"contributors\": [\n    \"I\u00F1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)\"\n  ],\n  \"version\": \"1.0.35\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"engines\": {\n    \"node\": \">=4.0.0\"\n  },\n  \"dependencies\": {\n    \"bufferutil\": \"^4.0.1\",\n    \"debug\": \"^2.2.0\",\n    \"es5-ext\": \"^0.10.63\",\n    \"typedarray-to-buffer\": \"^3.1.5\",\n    \"utf-8-validate\": \"^5.0.2\",\n    \"yaeti\": \"^0.0.6\"\n  },\n  \"devDependencies\": {\n    \"buffer-equal\": \"^1.0.0\",\n    \"gulp\": \"^4.0.2\",\n    \"gulp-jshint\": \"^2.0.4\",\n    \"jshint-stylish\": \"^2.2.1\",\n    \"jshint\": \"^2.0.0\",\n    \"tape\": \"^4.9.1\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"scripts\": {\n    \"test\": \"tape test/unit/*.js\",\n    \"gulp\": \"gulp\"\n  },\n  \"main\": \"index\",\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"license\": \"Apache-2.0\"\n}\n", "module.exports = require('../package.json').version;\n", "var _globalThis;\nif (typeof globalThis === 'object') {\n\t_globalThis = globalThis;\n} else {\n\ttry {\n\t\t_globalThis = require('es5-ext/global');\n\t} catch (error) {\n\t} finally {\n\t\tif (!_globalThis && typeof window !== 'undefined') { _globalThis = window; }\n\t\tif (!_globalThis) { throw new Error('Could not determine global this'); }\n\t}\n}\n\nvar NativeWebSocket = _globalThis.WebSocket || _globalThis.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\nif (NativeWebSocket) {\n\t['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'].forEach(function(prop) {\n\t\tObject.defineProperty(W3CWebSocket, prop, {\n\t\t\tget: function() { return NativeWebSocket[prop]; }\n\t\t});\n\t});\n}\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nconst client_1 = require(\"../browser/client\");\n// eslint-disable-next-line @typescript-eslint/no-var-requires,@typescript-eslint/no-require-imports\nconst WebSocket = require('websocket').w3cwebsocket;\nclass PondClient extends client_1.PondClient {\n    /**\n     * @desc Connects to the server and returns the socket.\n     */\n    connect(backoff = 1) {\n        this._disconnecting = false;\n        const socket = new WebSocket(this._address.toString());\n        socket.onopen = () => this._connectionState.publish(true);\n        socket.onmessage = (message) => {\n            const lines = message.data.trim().split('\\n');\n            for (const line of lines) {\n                if (line.trim()) {\n                    const data = JSON.parse(line);\n                    const event = pondsocket_common_1.channelEventSchema.parse(data);\n                    this._broadcaster.publish(event);\n                }\n            }\n        };\n        socket.onerror = () => socket.close();\n        socket.onclose = () => {\n            this._connectionState.publish(false);\n            if (this._disconnecting) {\n                return;\n            }\n            setTimeout(() => {\n                this.connect();\n            }, 1000);\n        };\n    }\n}\nexports.PondClient = PondClient;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = exports.ChannelState = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nObject.defineProperty(exports, \"ChannelState\", { enumerable: true, get: function () { return pondsocket_common_1.ChannelState; } });\nconst client_1 = require(\"./browser/client\");\nconst node_1 = require(\"./node/node\");\nconst PondClient = typeof window === 'undefined' ? node_1.PondClient : client_1.PondClient;\nexports.PondClient = PondClient;\n", "export { Runtime, RuntimeConfig, boot } from './runtime';\nexport { Logger, LogLevel, LoggerConfig } from './logger';\nexport { Transport, TransportConfig, ConnectionState, JoinPayload } from './transport';\nexport { Bus, Subscription } from './bus';\nexport { Patcher, PatcherCallbacks } from './patcher';\nexport { Executor, ExecutorConfig } from './executor';\nexport { ScriptExecutor, ScriptExecutorConfig } from './scripts';\n\nexport {\n    Topic,\n    StaticTopic,\n    ScriptTopic,\n    HandlerTopic,\n    Topics,\n    Boot,\n    Patch,\n    OpKind,\n    OpKinds,\n    Location,\n    Message,\n    ClientEvt,\n    ServerEvt,\n    ClientAck,\n    ServerAck,\n    ClientConfig,\n    EventOptions,\n    HandlerMeta,\n    ScriptMeta,\n    FramePatchPayload,\n    RouterNavPayload,\n    DOMCallPayload,\n    DOMSetPayload,\n    DOMQueryPayload,\n    DOMAsyncPayload,\n    DOMResponsePayload,\n    isBoot,\n    isServerError,\n    isServerEvt,\n    isServerAck,\n    isMessage,\n} from './protocol';\n\nimport { boot } from './runtime';\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', () => boot());\n    } else {\n        boot();\n    }\n}\n", "export type StaticTopic = 'router' | 'dom' | 'frame' | 'ack';\nexport type ScriptTopic = `script:${string}`;\nexport type HandlerTopic = `${string}:h${number}`;\nexport type Topic = StaticTopic | ScriptTopic | HandlerTopic;\n\nexport const Topics = {\n    Router: 'router' as const,\n    DOM: 'dom' as const,\n    Frame: 'frame' as const,\n    Ack: 'ack' as const,\n} as const;\n\nexport function isScriptTopic(topic: string): topic is ScriptTopic {\n    return topic.startsWith('script:');\n}\n\nexport function scriptTopic(scriptId: string): ScriptTopic {\n    return `script:${scriptId}`;\n}\n\nexport function isHandlerTopic(topic: string): topic is HandlerTopic {\n    return /^.+:h\\d+$/.test(topic);\n}\n\nexport function handlerTopic(handlerId: string): HandlerTopic {\n    return handlerId as HandlerTopic;\n}\n\nexport interface Message {\n    seq: number;\n    topic: string;\n    event: string;\n    data: unknown;\n}\n\nexport interface Event {\n    t: Topic;\n    sid: string;\n}\n\nexport interface ClientEvt extends Event {\n    a: string;\n    p?: unknown;\n}\n\nexport interface ServerEvt extends Event {\n    a: string;\n    p?: unknown;\n    seq?: number;\n}\n\nexport interface ClientAck extends Event {\n    seq: number;\n}\n\nexport interface ServerAck extends Event {\n    seq: number;\n}\n\nexport interface ClientConfig {\n    debug?: boolean;\n}\n\nexport interface Boot {\n    t: 'boot';\n    sid: string;\n    ver: number;\n    seq: number;\n    patch: Patch[];\n    location: Location;\n    client?: ClientConfig;\n}\n\nexport interface ServerError {\n    t: 'error';\n    sid: string;\n    code: string;\n    message: string;\n}\n\nexport interface Location {\n    path: string;\n    query: Record<string, string[]>;\n    hash: string;\n}\n\nexport interface EventOptions {\n    prevent?: boolean;\n    stop?: boolean;\n    passive?: boolean;\n    once?: boolean;\n    capture?: boolean;\n    debounce?: number;\n    throttle?: number;\n    listen?: string[];\n    props?: string[];\n}\n\nexport interface HandlerMeta extends EventOptions {\n    event: string;\n    handler: string;\n}\n\nexport interface ScriptMeta {\n    scriptId: string;\n    script: string;\n}\n\nexport interface StyleRule {\n    selector: string;\n    props: Record<string, string>;\n}\n\nexport interface MediaBlock {\n    query: string;\n    rules: StyleRule[];\n}\n\nexport interface Stylesheet {\n    rules?: StyleRule[];\n    mediaBlocks?: MediaBlock[];\n    hash?: string;\n}\n\nexport type OpKind =\n    | 'setText'\n    | 'setComment'\n    | 'setAttr'\n    | 'delAttr'\n    | 'setStyle'\n    | 'delStyle'\n    | 'setStyleDecl'\n    | 'delStyleDecl'\n    | 'setHandlers'\n    | 'setScript'\n    | 'delScript'\n    | 'setRef'\n    | 'delRef'\n    | 'replaceNode'\n    | 'addChild'\n    | 'delChild'\n    | 'moveChild';\n\nexport const OpKinds = {\n    SetText: 'setText' as OpKind,\n    SetComment: 'setComment' as OpKind,\n    SetAttr: 'setAttr' as OpKind,\n    DelAttr: 'delAttr' as OpKind,\n    SetStyle: 'setStyle' as OpKind,\n    DelStyle: 'delStyle' as OpKind,\n    SetStyleDecl: 'setStyleDecl' as OpKind,\n    DelStyleDecl: 'delStyleDecl' as OpKind,\n    SetHandlers: 'setHandlers' as OpKind,\n    SetScript: 'setScript' as OpKind,\n    DelScript: 'delScript' as OpKind,\n    SetRef: 'setRef' as OpKind,\n    DelRef: 'delRef' as OpKind,\n    ReplaceNode: 'replaceNode' as OpKind,\n    AddChild: 'addChild' as OpKind,\n    DelChild: 'delChild' as OpKind,\n    MoveChild: 'moveChild' as OpKind,\n} as const;\n\nexport interface Patch {\n    seq: number;\n    path: number[];\n    op: OpKind;\n    value?: unknown;\n    name?: string;\n    selector?: string;\n    index?: number;\n}\n\nexport function isBoot(msg: unknown): msg is Boot {\n    return typeof msg === 'object' && msg !== null && (msg as Boot).t === 'boot';\n}\n\nexport function isServerError(msg: unknown): msg is ServerError {\n    return typeof msg === 'object' && msg !== null && (msg as ServerError).t === 'error';\n}\n\nexport function isServerEvt(msg: unknown): msg is ServerEvt {\n    return (\n        typeof msg === 'object' &&\n        msg !== null &&\n        typeof (msg as ServerEvt).t === 'string' &&\n        typeof (msg as ServerEvt).a === 'string'\n    );\n}\n\nexport function isServerAck(msg: unknown): msg is ServerAck {\n    return (\n        typeof msg === 'object' &&\n        msg !== null &&\n        (msg as ServerAck).t === 'ack' &&\n        typeof (msg as ServerAck).seq === 'number'\n    );\n}\n\nexport function isMessage(msg: unknown): msg is Message {\n    return (\n        typeof msg === 'object' &&\n        msg !== null &&\n        typeof (msg as Message).seq === 'number' &&\n        typeof (msg as Message).topic === 'string' &&\n        typeof (msg as Message).event === 'string'\n    );\n}\n\nexport type FrameServerAction = 'patch';\n\nexport const FrameActions = {\n    Patch: 'patch' as FrameServerAction,\n} as const;\n\nexport type RouterServerAction = 'push' | 'replace' | 'back' | 'forward';\nexport type RouterClientAction = 'popstate';\n\nexport const RouterActions = {\n    Push: 'push' as RouterServerAction,\n    Replace: 'replace' as RouterServerAction,\n    Back: 'back' as RouterServerAction,\n    Forward: 'forward' as RouterServerAction,\n    Popstate: 'popstate' as RouterClientAction,\n} as const;\n\nexport interface RouterNavPayload {\n    path: string;\n    query: string;\n    hash: string;\n    replace: boolean;\n}\n\nexport type DOMServerAction = 'call' | 'set' | 'query' | 'async';\nexport type DOMClientAction = 'response';\n\nexport const DOMActions = {\n    Call: 'call' as DOMServerAction,\n    Set: 'set' as DOMServerAction,\n    Query: 'query' as DOMServerAction,\n    Async: 'async' as DOMServerAction,\n    Response: 'response' as DOMClientAction,\n} as const;\n\nexport interface DOMCallPayload {\n    ref: string;\n    method: string;\n    args?: unknown[];\n}\n\nexport interface DOMSetPayload {\n    ref: string;\n    prop: string;\n    value: unknown;\n}\n\nexport interface DOMQueryPayload {\n    requestId: string;\n    ref: string;\n    selectors: string[];\n}\n\nexport interface DOMAsyncPayload {\n    requestId: string;\n    ref: string;\n    method: string;\n    args?: unknown[];\n}\n\nexport interface DOMResponsePayload {\n    requestId: string;\n    values?: Record<string, unknown>;\n    result?: unknown;\n    error?: string;\n}\n\nexport type ScriptServerAction = 'send';\nexport type ScriptClientAction = 'message';\n\nexport const ScriptActions = {\n    Send: 'send' as ScriptServerAction,\n    Message: 'message' as ScriptClientAction,\n} as const;\n\nexport interface ScriptPayload {\n    scriptId: string;\n    event: string;\n    data?: unknown;\n}\n\nexport type HandlerClientAction = 'invoke';\n\nexport const HandlerActions = {\n    Invoke: 'invoke' as HandlerClientAction,\n} as const;\n\nexport interface HandlerEventPayload {\n    [key: string]: unknown;\n}\n\nexport interface FramePatchPayload {\n    seq: number;\n    patches: Patch[];\n}\n\nexport interface AckPayload {\n    seq: number;\n}\n\nexport interface RouterPopstatePayload {\n    path: string;\n    query: string;\n    hash: string;\n}\n\nexport interface StaticTopicActionMap {\n    frame: {\n        patch: FramePatchPayload;\n    };\n    router: {\n        push: RouterNavPayload;\n        replace: RouterNavPayload;\n        back: undefined;\n        forward: undefined;\n        popstate: RouterPopstatePayload;\n    };\n    dom: {\n        call: DOMCallPayload;\n        set: DOMSetPayload;\n        query: DOMQueryPayload;\n        async: DOMAsyncPayload;\n        response: DOMResponsePayload;\n    };\n    ack: {\n        ack: AckPayload;\n    };\n}\n\nexport interface ScriptTopicActions {\n    send: ScriptPayload;\n    message: ScriptPayload;\n}\n\nexport interface HandlerTopicActions {\n    invoke: HandlerEventPayload;\n}\n\nexport type ActionFor<T extends Topic> = T extends StaticTopic\n    ? keyof StaticTopicActionMap[T]\n    : T extends ScriptTopic\n        ? keyof ScriptTopicActions\n        : T extends HandlerTopic\n            ? keyof HandlerTopicActions\n            : never;\n\nexport type PayloadFor<T extends Topic, A extends string> = T extends StaticTopic\n    ? A extends keyof StaticTopicActionMap[T]\n        ? StaticTopicActionMap[T][A]\n        : never\n    : T extends ScriptTopic\n        ? A extends keyof ScriptTopicActions\n            ? ScriptTopicActions[A]\n            : never\n        : T extends HandlerTopic\n            ? A extends keyof HandlerTopicActions\n                ? HandlerTopicActions[A]\n                : never\n            : never;\n", "import {\n    Topic,\n    StaticTopic,\n    ScriptTopic,\n    HandlerTopic,\n    ActionFor,\n    PayloadFor,\n    ScriptTopicActions,\n    HandlerTopicActions,\n    scriptTopic,\n    handlerTopic,\n} from './protocol';\n\ntype SubscriberKey = `${StaticTopic}:${string}` | `${ScriptTopic}:${string}` | `${HandlerTopic}:${string}`;\ntype Callback<P> = (payload: P) => void;\n\ninterface Subscriber {\n    id: number;\n    callback: Callback<never>;\n}\n\ninterface WildcardSubscriber {\n    id: number;\n    callback: (topic: Topic, action: string, payload: unknown) => void;\n}\n\nexport interface Subscription {\n    unsubscribe: () => void;\n}\n\nexport class Bus {\n    private subscribers = new Map<SubscriberKey, Subscriber[]>();\n    private wildcardSubscribers: WildcardSubscriber[] = [];\n    private nextSubId = 0;\n\n    subscribe<T extends Topic, A extends ActionFor<T>>(\n        topic: T,\n        action: A,\n        callback: Callback<PayloadFor<T, A>>\n    ): Subscription {\n        const key: SubscriberKey = `${topic}:${String(action)}`;\n        const subId = ++this.nextSubId;\n        const sub: Subscriber = {\n            id: subId,\n            callback: callback as Callback<never>\n        };\n\n        const subs = this.subscribers.get(key) ?? [];\n        subs.push(sub);\n        this.subscribers.set(key, subs);\n\n        return {\n            unsubscribe: () => this.unsubscribe(key, subId),\n        };\n    }\n\n    upsert<T extends Topic, A extends ActionFor<T>>(\n        topic: T,\n        action: A,\n        callback: Callback<PayloadFor<T, A>>\n    ): Subscription {\n        const key: SubscriberKey = `${topic}:${String(action)}`;\n        const subs = this.subscribers.get(key);\n\n        if (subs && subs.length > 0) {\n            const first = subs[0];\n            first.callback = callback as Callback<never>;\n            if (subs.length > 1) {\n                this.subscribers.set(key, [first]);\n            }\n            const subId = first.id;\n            return {\n                unsubscribe: () => this.unsubscribe(key, subId),\n            };\n        }\n\n        const subId = ++this.nextSubId;\n        const sub: Subscriber = {\n            id: subId,\n            callback: callback as Callback<never>\n        };\n        this.subscribers.set(key, [sub]);\n\n        return {\n            unsubscribe: () => this.unsubscribe(key, subId),\n        };\n    }\n\n    subscribeAll(\n        callback: (topic: Topic, action: string, payload: unknown) => void\n    ): Subscription {\n        const subId = ++this.nextSubId;\n        const sub: WildcardSubscriber = { id: subId, callback };\n        this.wildcardSubscribers.push(sub);\n\n        return {\n            unsubscribe: () => this.unsubscribeWildcard(subId),\n        };\n    }\n\n    publish<T extends Topic, A extends ActionFor<T>>(\n        topic: T,\n        action: A,\n        payload: PayloadFor<T, A>\n    ): void {\n        const key: SubscriberKey = `${topic}:${String(action)}`;\n        const subs = this.subscribers.get(key) ?? [];\n\n        for (const sub of subs) {\n            try {\n                (sub.callback as Callback<PayloadFor<T, A>>)(payload);\n            } catch {\n                // swallow to prevent cascade\n            }\n        }\n\n        for (const sub of this.wildcardSubscribers) {\n            try {\n                sub.callback(topic, String(action), payload);\n            } catch {\n                // swallow\n            }\n        }\n    }\n\n    subscriberCount<T extends Topic, A extends ActionFor<T>>(topic: T, action: A): number {\n        const key: SubscriberKey = `${topic}:${String(action)}`;\n        return this.subscribers.get(key)?.length ?? 0;\n    }\n\n    subscribeScript<A extends keyof ScriptTopicActions>(\n        scriptId: string,\n        action: A,\n        callback: Callback<ScriptTopicActions[A]>\n    ): Subscription {\n        return this.subscribe(scriptTopic(scriptId), action, callback);\n    }\n\n    publishScript<A extends keyof ScriptTopicActions>(\n        scriptId: string,\n        action: A,\n        payload: ScriptTopicActions[A]\n    ): void {\n        const topic = scriptTopic(scriptId);\n        const key: SubscriberKey = `${topic}:${String(action)}`;\n        const subs = this.subscribers.get(key) ?? [];\n\n        for (const sub of subs) {\n            try {\n                (sub.callback as Callback<ScriptTopicActions[A]>)(payload);\n            } catch {\n            }\n        }\n\n        for (const sub of this.wildcardSubscribers) {\n            try {\n                sub.callback(topic, String(action), payload);\n            } catch {\n            }\n        }\n    }\n\n    publishHandler(\n        handlerId: string,\n        payload: HandlerTopicActions['invoke']\n    ): void {\n        const topic = handlerTopic(handlerId);\n        const key: SubscriberKey = `${topic}:invoke`;\n        const subs = this.subscribers.get(key) ?? [];\n\n        for (const sub of subs) {\n            try {\n                (sub.callback as Callback<HandlerTopicActions['invoke']>)(payload);\n            } catch {\n            }\n        }\n\n        for (const sub of this.wildcardSubscribers) {\n            try {\n                sub.callback(topic, 'invoke', payload);\n            } catch {\n            }\n        }\n    }\n\n    clear(): void {\n        this.subscribers.clear();\n        this.wildcardSubscribers = [];\n    }\n\n    private unsubscribe(key: SubscriberKey, subId: number): void {\n        const subs = this.subscribers.get(key);\n        if (!subs) return;\n\n        const idx = subs.findIndex((s) => s.id === subId);\n        if (idx !== -1) {\n            subs.splice(idx, 1);\n            if (subs.length === 0) {\n                this.subscribers.delete(key);\n            }\n        }\n    }\n\n    private unsubscribeWildcard(subId: number): void {\n        const idx = this.wildcardSubscribers.findIndex((s) => s.id === subId);\n        if (idx !== -1) {\n            this.wildcardSubscribers.splice(idx, 1);\n        }\n    }\n}\n", "import { PondClient, ChannelState } from '@eleven-am/pondsocket-client';\nimport {\n    Topic,\n    Topics,\n    Location,\n    ActionFor,\n    PayloadFor,\n    ClientEvt,\n    ClientAck,\n    isMessage,\n    HandlerEventPayload,\n    handlerTopic,\n    FramePatchPayload,\n    Patch,\n    Event,\n    ScriptPayload,\n} from './protocol';\nimport { Bus } from './bus';\nimport {Logger} from \"./logger\";\n\nexport interface TransportConfig {\n    endpoint: string;\n    sessionId: string;\n    version: number;\n    lastAck: number;\n    location: Location;\n    bus: Bus;\n}\n\nexport type ConnectionState = 'connecting' | 'connected' | 'disconnected' | 'stalled';\n\nexport interface JoinPayload {\n    sid: string;\n    ver: number;\n    ack: number;\n    loc: Location;\n}\n\nexport class Transport {\n    private readonly client: PondClient;\n    private readonly channel: ReturnType<PondClient['createChannel']>;\n    private readonly sessionId: string;\n    private readonly bus: Bus;\n    private state: ConnectionState = 'disconnected';\n    private stateListeners: Array<(state: ConnectionState) => void> = [];\n\n    constructor(config: TransportConfig) {\n        this.sessionId = config.sessionId;\n        this.bus = config.bus;\n\n        this.client = new PondClient(config.endpoint);\n\n        const joinPayload: JoinPayload = {\n            sid: config.sessionId,\n            ver: config.version,\n            ack: config.lastAck,\n            loc: config.location,\n        };\n\n        this.channel = this.client.createChannel(`live/${config.sessionId}`, joinPayload);\n\n        this.channel.onMessage((_event: string, payload: unknown) => {\n            this.handleMessage(payload);\n        });\n\n        this.channel.onChannelStateChange((channelState: ChannelState) => {\n            this.handleStateChange(channelState);\n        });\n    }\n\n    get sid(): string {\n        return this.sessionId;\n    }\n\n    get connectionState(): ConnectionState {\n        return this.state;\n    }\n\n    connect(): void {\n        this.state = 'connecting';\n        this.notifyStateChange();\n        this.channel.join();\n        this.client.connect();\n    }\n\n    disconnect(): void {\n        this.channel.leave();\n        this.client.disconnect();\n        this.state = 'disconnected';\n        this.notifyStateChange();\n    }\n\n    onStateChange(listener: (state: ConnectionState) => void): () => void {\n        this.stateListeners.push(listener);\n        return () => {\n            const idx = this.stateListeners.indexOf(listener);\n            if (idx !== -1) {\n                this.stateListeners.splice(idx, 1);\n            }\n        };\n    }\n\n    send<T extends Topic, A extends ActionFor<T>>(\n        topic: T,\n        action: A,\n        payload: PayloadFor<T, A>\n    ): void {\n        const evt: ClientEvt = {\n            t: topic,\n            sid: this.sessionId,\n            a: String(action),\n            p: payload,\n        };\n        this.sendMessage('evt', evt);\n    }\n\n    sendAck(seq: number): void {\n        const ack: ClientAck = {\n            t: Topics.Ack,\n            sid: this.sessionId,\n            seq,\n        };\n        this.sendMessage('ack', ack);\n    }\n\n    sendHandler(handlerId: string, payload: HandlerEventPayload): void {\n        const evt: ClientEvt = {\n            t: handlerTopic(handlerId),\n            sid: this.sessionId,\n            a: 'invoke',\n            p: payload,\n        };\n        this.sendMessage('evt', evt);\n    }\n\n    sendScript(scriptId: string, payload: ScriptPayload): void {\n        const evt: ClientEvt = {\n            t: `script:${scriptId}`,\n            sid: this.sessionId,\n            a: 'message',\n            p: payload,\n        };\n        this.sendMessage('evt', evt);\n    }\n\n    private handleMessage(payload: unknown): void {\n        Logger.info('TRANSPORT','Transport received message:', payload);\n        if (!isMessage(payload)) {\n            return;\n        }\n\n        const { seq, topic, event, data } = payload;\n\n        if (!this.isValidTopic(topic)) {\n            return;\n        }\n\n        this.publishToBus(topic, event, data, seq);\n    }\n\n    private isValidTopic(topic: string): topic is Topic {\n        return topic === 'router' || topic === 'dom' || topic === 'frame' || topic === 'ack' || topic.startsWith('script:');\n    }\n\n    private publishToBus(topic: Topic, action: string, data: unknown, seq: number): void {\n        switch (topic) {\n            case 'frame':\n                if (action === 'patch') {\n                    const payload: FramePatchPayload = {\n                        seq,\n                        patches: data as Patch[],\n                    };\n                    this.bus.publish('frame', 'patch', payload);\n                }\n                break;\n            case 'router':\n                if (action === 'push') {\n                    this.bus.publish('router', 'push', data as PayloadFor<'router', 'push'>);\n                } else if (action === 'replace') {\n                    this.bus.publish('router', 'replace', data as PayloadFor<'router', 'replace'>);\n                } else if (action === 'back') {\n                    this.bus.publish('router', 'back', undefined);\n                } else if (action === 'forward') {\n                    this.bus.publish('router', 'forward', undefined);\n                }\n                break;\n            case 'dom':\n                if (action === 'call') {\n                    this.bus.publish('dom', 'call', data as PayloadFor<'dom', 'call'>);\n                } else if (action === 'set') {\n                    this.bus.publish('dom', 'set', data as PayloadFor<'dom', 'set'>);\n                } else if (action === 'query') {\n                    this.bus.publish('dom', 'query', data as PayloadFor<'dom', 'query'>);\n                } else if (action === 'async') {\n                    this.bus.publish('dom', 'async', data as PayloadFor<'dom', 'async'>);\n                }\n                break;\n            case 'ack':\n                if (action === 'ack') {\n                    this.bus.publish('ack', 'ack', data as PayloadFor<'ack', 'ack'>);\n                }\n                break;\n            default:\n                if (topic.startsWith('script:') && action === 'send') {\n                    const payload = data as ScriptPayload;\n                    this.bus.publishScript(payload.scriptId, 'send', payload);\n                }\n                break;\n        }\n    }\n\n    private handleStateChange(channelState: ChannelState): void {\n        switch (channelState) {\n            case ChannelState.JOINED:\n                this.state = 'connected';\n                break;\n            case ChannelState.STALLED:\n                this.state = 'stalled';\n                break;\n            case ChannelState.CLOSED:\n                this.state = 'disconnected';\n                break;\n            case ChannelState.JOINING:\n            case ChannelState.IDLE:\n                this.state = 'connecting';\n                break;\n        }\n        this.notifyStateChange();\n    }\n\n    private notifyStateChange(): void {\n        for (const listener of this.stateListeners) {\n            try {\n                listener(this.state);\n            } catch {\n                // swallow\n            }\n        }\n    }\n\n    private sendMessage<T extends Event>(type: string, message: T): void {\n        Logger.info('TRANSPORT','Transport sending message:', type, message);\n        this.channel.sendMessage(type, message);\n    }\n}\n", "export type LogLevel = 'debug' | 'info' | 'warn' | 'error';\n\nexport interface LoggerConfig {\n    enabled: boolean;\n    level: LogLevel;\n}\n\nconst levels: Record<LogLevel, number> = {\n    debug: 0,\n    info: 1,\n    warn: 2,\n    error: 3,\n};\n\nclass LoggerImpl {\n    private enabled = false;\n    private level: LogLevel = 'info';\n\n    configure(config: Partial<LoggerConfig>): void {\n        if (config.enabled !== undefined) this.enabled = config.enabled;\n        if (config.level !== undefined) this.level = config.level;\n    }\n\n    debug(tag: string, message: string, ...args: unknown[]): void {\n        this.log('debug', tag, message, args);\n    }\n\n    info(tag: string, message: string, ...args: unknown[]): void {\n        this.log('info', tag, message, args);\n    }\n\n    warn(tag: string, message: string, ...args: unknown[]): void {\n        this.log('warn', tag, message, args);\n    }\n\n    error(tag: string, message: string, ...args: unknown[]): void {\n        this.log('error', tag, message, args);\n    }\n\n    private log(level: LogLevel, tag: string, message: string, args: unknown[]): void {\n        if (!this.enabled) return;\n        if (levels[level] < levels[this.level]) return;\n\n        const prefix = `[Pond:${tag}]`;\n        const fn = console[level] || console.log;\n\n        if (args.length > 0) {\n            fn(prefix, message, ...args);\n        } else {\n            fn(prefix, message);\n        }\n    }\n}\n\nexport const Logger = new LoggerImpl();\n", "import { Patch, HandlerMeta, ScriptMeta } from './protocol';\n\nexport interface StructuredNode {\n    tag?: string;\n    text?: string;\n    comment?: string;\n    attrs?: Record<string, string[]>;\n    style?: Record<string, string>;\n    children?: StructuredNode[];\n    handlers?: HandlerMeta[];\n    script?: ScriptMeta;\n    refId?: string;\n    unsafeHTML?: string;\n}\n\nexport type EventCallback = (handlerId: string, data: Record<string, unknown>) => void;\nexport type RefCallback = (refId: string, el: Element) => void;\nexport type RefDeleteCallback = (refId: string) => void;\nexport type ScriptCallback = (meta: ScriptMeta, el: Element) => void;\nexport type ScriptCleanupCallback = (scriptId: string) => void;\n\nexport interface PatcherCallbacks {\n    onEvent: EventCallback;\n    onRef: RefCallback;\n    onRefDelete: RefDeleteCallback;\n    onScript: ScriptCallback;\n    onScriptCleanup: ScriptCleanupCallback;\n}\n\ninterface HandlerState {\n    listener: (e: Event) => void;\n    cleanup?: () => void;\n}\n\nexport class Patcher {\n    private readonly root: Node;\n    private callbacks: PatcherCallbacks;\n    private handlerStore = new WeakMap<Element, Map<string, HandlerState>>();\n    private scriptStore = new WeakMap<Element, string>();\n\n    constructor(root: Node, callbacks: PatcherCallbacks) {\n        this.root = root;\n        this.callbacks = callbacks;\n    }\n\n    apply(patches: Patch[]): void {\n        const sorted = [...patches].sort((a, b) => a.seq - b.seq);\n        for (const patch of sorted) {\n            this.applyPatch(patch);\n        }\n    }\n\n    private applyPatch(patch: Patch): void {\n        const node = this.resolvePath(patch.path);\n        if (!node) {\n            return;\n        }\n\n        switch (patch.op) {\n            case 'setText':\n                this.setText(node, patch.value as string);\n                break;\n            case 'setComment':\n                this.setComment(node, patch.value as string);\n                break;\n            case 'setAttr':\n                this.setAttr(node as Element, patch.value as Record<string, string[]>);\n                break;\n            case 'delAttr':\n                this.delAttr(node as Element, patch.name!);\n                break;\n            case 'setStyle':\n                this.setStyle(node as HTMLElement, patch.value as Record<string, string>);\n                break;\n            case 'delStyle':\n                this.delStyle(node as HTMLElement, patch.name!);\n                break;\n            case 'setStyleDecl':\n                this.setStyleDecl(node as HTMLStyleElement, patch.selector!, patch.name!, patch.value as string);\n                break;\n            case 'delStyleDecl':\n                this.delStyleDecl(node as HTMLStyleElement, patch.selector!, patch.name!);\n                break;\n            case 'setHandlers':\n                this.setHandlers(node as Element, patch.value as HandlerMeta[]);\n                break;\n            case 'setScript':\n                this.setScript(node as Element, patch.value as ScriptMeta);\n                break;\n            case 'delScript':\n                this.delScript(node as Element);\n                break;\n            case 'setRef':\n                this.callbacks.onRef(patch.value as string, node as Element);\n                break;\n            case 'delRef':\n                this.callbacks.onRefDelete(patch.value as string);\n                break;\n            case 'replaceNode':\n                this.replaceNode(node, patch.value as StructuredNode);\n                break;\n            case 'addChild':\n                this.addChild(node, patch.index!, patch.value as StructuredNode);\n                break;\n            case 'delChild':\n                this.delChild(node, patch.index!);\n                break;\n            case 'moveChild':\n                this.moveChild(node, patch.value as { fromIndex: number; newIdx: number });\n                break;\n        }\n    }\n\n    private resolvePath(path: number[]): Node | null {\n        let node: Node | null = this.root;\n        for (const index of path) {\n            if (!node) return null;\n            node = node.childNodes[index] ?? null;\n        }\n        return node;\n    }\n\n    private setText(node: Node, text: string): void {\n        node.textContent = text;\n    }\n\n    private setComment(node: Node, text: string): void {\n        node.textContent = text;\n    }\n\n    private setAttr(el: Element, attrs: Record<string, string[]>): void {\n        for (const [name, values] of Object.entries(attrs)) {\n            if (name === 'class') {\n                el.className = values.join(' ');\n            } else if (name === 'value' && el instanceof HTMLInputElement) {\n                el.value = values[0] ?? '';\n            } else if (name === 'checked' && el instanceof HTMLInputElement) {\n                el.checked = values.length > 0 && values[0] !== 'false';\n            } else if (name === 'selected' && el instanceof HTMLOptionElement) {\n                el.selected = values.length > 0 && values[0] !== 'false';\n            } else if (values.length === 0) {\n                el.setAttribute(name, '');\n            } else {\n                el.setAttribute(name, values.join(' '));\n            }\n        }\n    }\n\n    private delAttr(el: Element, name: string): void {\n        if (name === 'value' && el instanceof HTMLInputElement) {\n            el.value = '';\n        } else if (name === 'checked' && el instanceof HTMLInputElement) {\n            el.checked = false;\n        } else if (name === 'selected' && el instanceof HTMLOptionElement) {\n            el.selected = false;\n        } else {\n            el.removeAttribute(name);\n        }\n    }\n\n    private setStyle(el: HTMLElement, styles: Record<string, string>): void {\n        for (const [prop, value] of Object.entries(styles)) {\n            el.style.setProperty(prop, value);\n        }\n    }\n\n    private delStyle(el: HTMLElement, prop: string): void {\n        el.style.removeProperty(prop);\n    }\n\n    private setStyleDecl(styleEl: HTMLStyleElement, selector: string, prop: string, value: string): void {\n        const sheet = styleEl.sheet;\n        if (!sheet) return;\n\n        const rule = this.findOrCreateRule(sheet, selector);\n        if (rule) {\n            rule.style.setProperty(prop, value);\n        }\n    }\n\n    private delStyleDecl(styleEl: HTMLStyleElement, selector: string, prop: string): void {\n        const sheet = styleEl.sheet;\n        if (!sheet) return;\n\n        const rule = this.findRule(sheet, selector);\n        if (rule) {\n            rule.style.removeProperty(prop);\n        }\n    }\n\n    private findRule(sheet: CSSStyleSheet, selector: string): CSSStyleRule | null {\n        for (let i = 0; i < sheet.cssRules.length; i++) {\n            const rule = sheet.cssRules[i];\n            if (rule instanceof CSSStyleRule && rule.selectorText === selector) {\n                return rule;\n            }\n        }\n        return null;\n    }\n\n    private findOrCreateRule(sheet: CSSStyleSheet, selector: string): CSSStyleRule | null {\n        let rule = this.findRule(sheet, selector);\n        if (!rule) {\n            const index = sheet.insertRule(`${selector} {}`, sheet.cssRules.length);\n            rule = sheet.cssRules[index] as CSSStyleRule;\n        }\n        return rule;\n    }\n\n    private setHandlers(el: Element, handlers: HandlerMeta[]): void {\n        const oldHandlers = this.handlerStore.get(el);\n        if (oldHandlers) {\n            oldHandlers.forEach((state) => {\n                if (state.cleanup) state.cleanup();\n            });\n        }\n\n        const newHandlers = new Map<string, HandlerState>();\n\n        for (const meta of handlers) {\n            const state = this.createHandler(el, meta);\n            newHandlers.set(meta.event, state);\n        }\n\n        this.handlerStore.set(el, newHandlers);\n    }\n\n    private createHandler(el: Element, meta: HandlerMeta): HandlerState {\n        let timeoutId: ReturnType<typeof setTimeout> | null = null;\n        let lastCall = 0;\n\n        const invoke = (e: Event) => {\n            if (meta.prevent && e.cancelable) {\n                e.preventDefault();\n            }\n            if (meta.stop) {\n                e.stopPropagation();\n            }\n\n            const data = this.extractEventData(e, meta.props ?? []);\n            this.callbacks.onEvent(meta.handler, data);\n        };\n\n        let handler: (e: Event) => void;\n\n        if (meta.debounce && meta.debounce > 0) {\n            handler = (e: Event) => {\n                if (meta.prevent && e.cancelable) e.preventDefault();\n                if (meta.stop) e.stopPropagation();\n\n                if (timeoutId) clearTimeout(timeoutId);\n                timeoutId = setTimeout(() => {\n                    const data = this.extractEventData(e, meta.props ?? []);\n                    this.callbacks.onEvent(meta.handler, data);\n                }, meta.debounce);\n            };\n        } else if (meta.throttle && meta.throttle > 0) {\n            handler = (e: Event) => {\n                if (meta.prevent && e.cancelable) e.preventDefault();\n                if (meta.stop) e.stopPropagation();\n\n                const now = Date.now();\n                if (now - lastCall >= meta.throttle!) {\n                    lastCall = now;\n                    const data = this.extractEventData(e, meta.props ?? []);\n                    this.callbacks.onEvent(meta.handler, data);\n                }\n            };\n        } else {\n            handler = invoke;\n        }\n\n        const options: AddEventListenerOptions = {};\n        if (meta.passive) options.passive = true;\n        if (meta.once) options.once = true;\n        if (meta.capture) options.capture = true;\n\n        el.addEventListener(meta.event, handler, options);\n\n        return {\n            listener: handler,\n            cleanup: () => {\n                el.removeEventListener(meta.event, handler, options);\n                if (timeoutId) clearTimeout(timeoutId);\n            },\n        };\n    }\n\n    private extractEventData(e: Event, props: string[]): Record<string, unknown> {\n        const result: Record<string, unknown> = {};\n        for (const prop of props) {\n            const value = this.resolveProp(e, prop);\n            if (value !== undefined) {\n                result[prop] = value;\n            }\n        }\n        return result;\n    }\n\n    private resolveProp(e: Event, path: string): unknown {\n        const segments = path.split('.').map(s => s.trim()).filter(Boolean);\n        if (segments.length === 0) return undefined;\n\n        const root = segments.shift()!;\n        let current: unknown;\n\n        switch (root) {\n            case 'event':\n                current = e;\n                break;\n            case 'target':\n                current = e.target;\n                break;\n            case 'currentTarget':\n                current = e.currentTarget;\n                break;\n            default:\n                current = (e as unknown as Record<string, unknown>)[root];\n        }\n\n        for (const segment of segments) {\n            if (current == null) return undefined;\n            try {\n                current = (current as Record<string, unknown>)[segment];\n            } catch {\n                return undefined;\n            }\n        }\n\n        return this.serializeValue(current);\n    }\n\n    private serializeValue(value: unknown): unknown {\n        if (value === null || value === undefined) return null;\n\n        const type = typeof value;\n        if (type === 'string' || type === 'number' || type === 'boolean') return value;\n\n        if (Array.isArray(value)) {\n            const mapped = value.map(v => this.serializeValue(v)).filter(v => v !== undefined);\n            return mapped.length > 0 ? mapped : null;\n        }\n\n        if (value instanceof Date) return value.toISOString();\n        if (value instanceof DOMTokenList) return Array.from(value);\n        if (value instanceof Node) return undefined;\n\n        try {\n            return JSON.parse(JSON.stringify(value));\n        } catch {\n            return undefined;\n        }\n    }\n\n    private setScript(el: Element, meta: ScriptMeta): void {\n        this.delScript(el);\n        this.scriptStore.set(el, meta.scriptId);\n        this.callbacks.onScript(meta, el);\n    }\n\n    private delScript(el: Element): void {\n        const scriptId = this.scriptStore.get(el);\n        if (scriptId) {\n            this.scriptStore.delete(el);\n            this.callbacks.onScriptCleanup(scriptId);\n        }\n    }\n\n    private replaceNode(oldNode: Node, newNodeData: StructuredNode): void {\n        const newNode = this.createNode(newNodeData);\n        if (newNode && oldNode.parentNode) {\n            this.cleanupTree(oldNode);\n            oldNode.parentNode.replaceChild(newNode, oldNode);\n        }\n    }\n\n    private addChild(parent: Node, index: number, nodeData: StructuredNode): void {\n        const newNode = this.createNode(nodeData);\n        if (!newNode) return;\n\n        const refChild = parent.childNodes[index] ?? null;\n        parent.insertBefore(newNode, refChild);\n    }\n\n    private delChild(parent: Node, index: number): void {\n        const child = parent.childNodes[index];\n        if (child) {\n            this.cleanupTree(child);\n            parent.removeChild(child);\n        }\n    }\n\n    private moveChild(parent: Node, move: { fromIndex: number; newIdx: number }): void {\n        const child = parent.childNodes[move.fromIndex];\n        if (!child) return;\n\n        parent.removeChild(child);\n        const refChild = parent.childNodes[move.newIdx] ?? null;\n        parent.insertBefore(child, refChild);\n    }\n\n    private cleanupTree(node: Node): void {\n        if (node.nodeType === Node.ELEMENT_NODE) {\n            const el = node as Element;\n\n            const handlers = this.handlerStore.get(el);\n            if (handlers) {\n                handlers.forEach((state) => {\n                    if (state.cleanup) state.cleanup();\n                });\n                this.handlerStore.delete(el);\n            }\n\n            const scriptId = this.scriptStore.get(el);\n            if (scriptId) {\n                this.scriptStore.delete(el);\n                this.callbacks.onScriptCleanup(scriptId);\n            }\n\n            for (let i = 0; i < node.childNodes.length; i++) {\n                this.cleanupTree(node.childNodes[i]);\n            }\n        }\n    }\n\n    private createNode(data: StructuredNode): Node | null {\n        if (data.text !== undefined) {\n            return document.createTextNode(data.text);\n        }\n\n        if (data.comment !== undefined) {\n            return document.createComment(data.comment);\n        }\n\n        if (!data.tag) return null;\n\n        const el = document.createElement(data.tag);\n\n        if (data.attrs) {\n            this.setAttr(el, data.attrs);\n        }\n\n        if (data.style) {\n            this.setStyle(el as HTMLElement, data.style);\n        }\n\n        if (data.handlers && data.handlers.length > 0) {\n            this.setHandlers(el, data.handlers);\n        }\n\n        if (data.script) {\n            this.setScript(el, data.script);\n        }\n\n        if (data.refId) {\n            this.callbacks.onRef(data.refId, el);\n        }\n\n        if (data.unsafeHTML) {\n            el.innerHTML = data.unsafeHTML;\n        } else if (data.children) {\n            for (const child of data.children) {\n                const childNode = this.createNode(child);\n                if (childNode) {\n                    el.appendChild(childNode);\n                }\n            }\n        }\n\n        return el;\n    }\n}\n", "import {\n    DOMCallPayload,\n    DOMSetPayload,\n    DOMQueryPayload,\n    DOMAsyncPayload,\n    DOMResponsePayload,\n    RouterNavPayload,\n    RouterPopstatePayload,\n} from './protocol';\nimport { Bus, Subscription } from './bus';\nimport { Transport } from './transport';\n\nexport type RefResolver = (refId: string) => Element | undefined;\n\nexport interface ExecutorConfig {\n    bus: Bus;\n    transport: Transport;\n    resolveRef: RefResolver;\n}\n\nexport class Executor {\n    private readonly bus: Bus;\n    private readonly transport: Transport;\n    private readonly resolveRef: RefResolver;\n    private readonly subscriptions: Subscription[] = [];\n    private popstateHandler: (() => void) | null = null;\n\n    constructor(config: ExecutorConfig) {\n        this.bus = config.bus;\n        this.transport = config.transport;\n        this.resolveRef = config.resolveRef;\n\n        this.setupDOMSubscriptions();\n        this.setupRouterSubscriptions();\n        this.setupPopstateListener();\n    }\n\n    destroy(): void {\n        for (const sub of this.subscriptions) {\n            sub.unsubscribe();\n        }\n        this.subscriptions.length = 0;\n\n        if (this.popstateHandler) {\n            window.removeEventListener('popstate', this.popstateHandler);\n            this.popstateHandler = null;\n        }\n    }\n\n    private setupDOMSubscriptions(): void {\n        this.subscriptions.push(\n            this.bus.subscribe('dom', 'call', (payload) => this.handleCall(payload))\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('dom', 'set', (payload) => this.handleSet(payload))\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('dom', 'query', (payload) => this.handleQuery(payload))\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('dom', 'async', (payload) => this.handleAsync(payload))\n        );\n    }\n\n    private setupRouterSubscriptions(): void {\n        this.subscriptions.push(\n            this.bus.subscribe('router', 'push', (payload) => this.handlePush(payload))\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('router', 'replace', (payload) => this.handleReplace(payload))\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('router', 'back', () => this.handleBack())\n        );\n        this.subscriptions.push(\n            this.bus.subscribe('router', 'forward', () => this.handleForward())\n        );\n    }\n\n    private setupPopstateListener(): void {\n        this.popstateHandler = () => {\n            const payload: RouterPopstatePayload = {\n                path: window.location.pathname,\n                query: window.location.search.replace(/^\\?/, ''),\n                hash: window.location.hash.replace(/^#/, ''),\n            };\n            this.transport.send('router', 'popstate', payload);\n        };\n        window.addEventListener('popstate', this.popstateHandler);\n    }\n\n    private handleCall(payload: DOMCallPayload): void {\n        const el = this.resolveRef(payload.ref);\n        if (!el) return;\n\n        const method = (el as unknown as Record<string, unknown>)[payload.method];\n        if (typeof method === 'function') {\n            method.apply(el, payload.args ?? []);\n        }\n    }\n\n    private handleSet(payload: DOMSetPayload): void {\n        const el = this.resolveRef(payload.ref);\n        if (!el) return;\n\n        (el as unknown as Record<string, unknown>)[payload.prop] = payload.value;\n    }\n\n    private handleQuery(payload: DOMQueryPayload): void {\n        const el = this.resolveRef(payload.ref);\n        const response: DOMResponsePayload = { requestId: payload.requestId };\n\n        if (!el) {\n            response.error = `ref not found: ${payload.ref}`;\n            this.transport.send('dom', 'response', response);\n            return;\n        }\n\n        const values: Record<string, unknown> = {};\n        for (const selector of payload.selectors) {\n            values[selector] = this.readProperty(el, selector);\n        }\n\n        response.values = values;\n        this.transport.send('dom', 'response', response);\n    }\n\n    private handleAsync(payload: DOMAsyncPayload): void {\n        const el = this.resolveRef(payload.ref);\n        const response: DOMResponsePayload = { requestId: payload.requestId };\n\n        if (!el) {\n            response.error = `ref not found: ${payload.ref}`;\n            this.transport.send('dom', 'response', response);\n            return;\n        }\n\n        const method = (el as unknown as Record<string, unknown>)[payload.method];\n        if (typeof method !== 'function') {\n            response.error = `method not found: ${payload.method}`;\n            this.transport.send('dom', 'response', response);\n            return;\n        }\n\n        Promise.resolve(method.apply(el, payload.args ?? []))\n            .then((result) => {\n                response.result = this.serializeValue(result);\n                this.transport.send('dom', 'response', response);\n            })\n            .catch((err) => {\n                response.error = err instanceof Error ? err.message : String(err);\n                this.transport.send('dom', 'response', response);\n            });\n    }\n\n    private handlePush(payload: RouterNavPayload): void {\n        const url = this.buildUrl(payload);\n        window.history.pushState({}, '', url);\n    }\n\n    private handleReplace(payload: RouterNavPayload): void {\n        const url = this.buildUrl(payload);\n        window.history.replaceState({}, '', url);\n    }\n\n    private handleBack(): void {\n        window.history.back();\n    }\n\n    private handleForward(): void {\n        window.history.forward();\n    }\n\n    private buildUrl(payload: RouterNavPayload): string {\n        let url = payload.path;\n        if (payload.query) {\n            url += '?' + payload.query;\n        }\n        if (payload.hash) {\n            url += '#' + payload.hash;\n        }\n        return url;\n    }\n\n    private readProperty(el: Element, path: string): unknown {\n        const segments = path.split('.');\n        let current: unknown = el;\n\n        for (const segment of segments) {\n            if (current == null) return undefined;\n            current = (current as Record<string, unknown>)[segment];\n        }\n\n        return this.serializeValue(current);\n    }\n\n    private serializeValue(value: unknown): unknown {\n        if (value === null || value === undefined) return null;\n\n        const type = typeof value;\n        if (type === 'string' || type === 'number' || type === 'boolean') return value;\n\n        if (Array.isArray(value)) {\n            return value.map((v) => this.serializeValue(v)).filter((v) => v !== undefined);\n        }\n\n        if (value instanceof Date) return value.toISOString();\n        if (value instanceof DOMTokenList) return Array.from(value);\n        if (value instanceof Node) return undefined;\n\n        try {\n            return JSON.parse(JSON.stringify(value));\n        } catch {\n            return undefined;\n        }\n    }\n}\n", "import { ScriptMeta, ScriptPayload } from './protocol';\nimport { Bus, Subscription } from './bus';\nimport { Logger } from './logger';\nimport { Transport } from './transport';\n\nexport interface ScriptTransport {\n    send(event: string, data: unknown): void;\n    on(event: string, handler: (data: unknown) => void): void;\n}\n\nexport interface ScriptInstance {\n    cleanup?: () => void;\n    eventHandlers: Map<string, (data: unknown) => void>;\n    subscription: Subscription;\n}\n\nexport interface ScriptExecutorConfig {\n    bus: Bus;\n    transport: Transport;\n}\n\ntype SandboxTarget = Record<string, unknown>;\n\nconst SANDBOX_WHITELIST: readonly string[] = [\n    'console',\n    'setTimeout',\n    'clearTimeout',\n    'setInterval',\n    'clearInterval',\n    'requestAnimationFrame',\n    'cancelAnimationFrame',\n    'Promise',\n    'Array',\n    'Object',\n    'String',\n    'Number',\n    'Boolean',\n    'Math',\n    'JSON',\n    'Date',\n    'Map',\n    'Set',\n    'WeakMap',\n    'WeakSet',\n    'Error',\n    'TypeError',\n    'RangeError',\n    'SyntaxError',\n    'ReferenceError',\n    'parseInt',\n    'parseFloat',\n    'isNaN',\n    'isFinite',\n    'encodeURI',\n    'decodeURI',\n    'encodeURIComponent',\n    'decodeURIComponent',\n    'atob',\n    'btoa',\n    'fetch',\n    'URL',\n    'URLSearchParams',\n    'TextEncoder',\n    'TextDecoder',\n    'Blob',\n    'File',\n    'FormData',\n    'Headers',\n    'Request',\n    'Response',\n    'AbortController',\n    'AbortSignal',\n    'Symbol',\n    'Proxy',\n    'Reflect',\n    'RegExp',\n    'Intl',\n    'BigInt',\n    'ArrayBuffer',\n    'DataView',\n    'Uint8Array',\n    'Uint16Array',\n    'Uint32Array',\n    'Int8Array',\n    'Int16Array',\n    'Int32Array',\n    'Float32Array',\n    'Float64Array',\n    'Uint8ClampedArray',\n    'BigInt64Array',\n    'BigUint64Array',\n];\n\nconst BIND_TO_WINDOW = new Set([\n    'setTimeout',\n    'clearTimeout',\n    'setInterval',\n    'clearInterval',\n    'requestAnimationFrame',\n    'cancelAnimationFrame',\n    'fetch',\n    'atob',\n    'btoa',\n]);\n\nfunction createSandbox(element: Element, transport: ScriptTransport): SandboxTarget {\n    const target: SandboxTarget = {\n        element,\n        transport,\n    };\n\n    for (const key of SANDBOX_WHITELIST) {\n        if (key in globalThis) {\n            const value = (globalThis as unknown as Record<string, unknown>)[key];\n            if (BIND_TO_WINDOW.has(key) && typeof value === 'function') {\n                target[key] = value.bind(globalThis);\n            } else {\n                target[key] = value;\n            }\n        }\n    }\n\n    return new Proxy(target, {\n        has: () => true,\n        get: (t, prop) => {\n            if (typeof prop === 'string' && prop in t) {\n                return t[prop];\n            }\n            return undefined;\n        },\n        set: (t, prop, value) => {\n            if (typeof prop === 'string') {\n                t[prop] = value;\n            }\n            return true;\n        },\n    });\n}\n\nexport class ScriptExecutor {\n    private readonly bus: Bus;\n    private readonly transport: Transport;\n    private readonly scripts = new Map<string, ScriptInstance>();\n\n    constructor(config: ScriptExecutorConfig) {\n        this.bus = config.bus;\n        this.transport = config.transport;\n    }\n\n    async execute(meta: ScriptMeta, element: Element): Promise<void> {\n        const { scriptId, script } = meta;\n\n        Logger.debug('Script', 'execute called', { scriptId, element: element.tagName, script: script.substring(0, 100) + '...' });\n\n        this.cleanup(scriptId);\n\n        const instance: ScriptInstance = {\n            eventHandlers: new Map(),\n            subscription: this.bus.subscribeScript(scriptId, 'send', (payload: ScriptPayload) => {\n                Logger.debug('Script', 'server message received', { scriptId, event: payload.event, data: payload.data });\n                this.handleServerMessage(scriptId, payload.event, payload.data);\n            }),\n        };\n\n        const transport: ScriptTransport = {\n            send: (event: string, data: unknown) => {\n                Logger.debug('Script', 'transport.send called', { scriptId, event, data });\n                const payload: ScriptPayload = {\n                    scriptId,\n                    event,\n                    data,\n                };\n                this.transport.sendScript(scriptId, payload);\n            },\n            on: (event: string, handler: (data: unknown) => void) => {\n                Logger.debug('Script', 'transport.on registered', { scriptId, event });\n                instance.eventHandlers.set(event, handler);\n            },\n        };\n\n        const sandbox = createSandbox(element, transport);\n\n        try {\n            Logger.debug('Script', 'creating function', { scriptId });\n            const fn = new Function(\n                'sandbox',\n                `with(sandbox) { return (${script})(element, transport); }`\n            );\n            Logger.debug('Script', 'executing function', { scriptId });\n            const cleanup = await fn(sandbox);\n\n            if (typeof cleanup === 'function') {\n                Logger.debug('Script', 'cleanup function returned', { scriptId });\n                instance.cleanup = cleanup;\n            }\n\n            this.scripts.set(scriptId, instance);\n            Logger.debug('Script', 'execute complete', { scriptId, handlers: Array.from(instance.eventHandlers.keys()) });\n        } catch (err) {\n            Logger.error('Script', 'execute failed', { scriptId, error: String(err) });\n            instance.subscription.unsubscribe();\n            throw err;\n        }\n    }\n\n    private handleServerMessage(scriptId: string, event: string, data: unknown): void {\n        Logger.debug('Script', 'handleServerMessage', { scriptId, event, data });\n        const instance = this.scripts.get(scriptId);\n        if (!instance) {\n            Logger.warn('Script', 'no instance found', { scriptId });\n            return;\n        }\n\n        const handler = instance.eventHandlers.get(event);\n        if (!handler) {\n            Logger.warn('Script', 'no handler found', { scriptId, event, availableHandlers: Array.from(instance.eventHandlers.keys()) });\n            return;\n        }\n\n        try {\n            Logger.debug('Script', 'invoking handler', { scriptId, event });\n            handler(data);\n        } catch (err) {\n            Logger.error('Script', 'handler error', { scriptId, event, error: String(err) });\n        }\n    }\n\n    cleanup(scriptId: string): void {\n        Logger.debug('Script', 'cleanup called', { scriptId });\n        const instance = this.scripts.get(scriptId);\n        if (!instance) {\n            Logger.debug('Script', 'cleanup: no instance found', { scriptId });\n            return;\n        }\n\n        if (instance.cleanup) {\n            try {\n                Logger.debug('Script', 'running cleanup function', { scriptId });\n                instance.cleanup();\n            } catch (err) {\n                Logger.error('Script', 'cleanup function error', { scriptId, error: String(err) });\n            }\n        }\n\n        instance.subscription.unsubscribe();\n        this.scripts.delete(scriptId);\n        Logger.debug('Script', 'cleanup complete', { scriptId });\n    }\n\n    destroy(): void {\n        for (const scriptId of this.scripts.keys()) {\n            this.cleanup(scriptId);\n        }\n    }\n}\n", "import {\n    Boot,\n    Location,\n    Patch,\n    FramePatchPayload,\n    ScriptMeta,\n    isBoot,\n    isServerError,\n} from './protocol';\nimport { Bus } from './bus';\nimport { Transport, ConnectionState } from './transport';\nimport { Patcher } from './patcher';\nimport { Executor } from './executor';\nimport { ScriptExecutor } from './scripts';\nimport { Logger } from './logger';\n\nexport interface RuntimeConfig {\n    root: Node;\n    sessionId: string;\n    version: number;\n    seq: number;\n    endpoint: string;\n    location: Location;\n    debug?: boolean;\n}\n\ninterface ResumeOK {\n    t: 'resume_ok';\n    from: number;\n    to: number;\n}\n\nfunction isResumeOK(msg: unknown): msg is ResumeOK {\n    return (\n        typeof msg === 'object' &&\n        msg !== null &&\n        (msg as ResumeOK).t === 'resume_ok'\n    );\n}\n\ndeclare global {\n    interface Window {\n        __POND_RUNTIME__?: Runtime;\n        __LIVEUI_BOOT__?: Boot;\n    }\n}\n\nexport class Runtime {\n    private readonly bus: Bus;\n    private readonly transport: Transport;\n    private readonly patcher: Patcher;\n    private readonly executor: Executor;\n    private readonly scripts: ScriptExecutor;\n    private readonly refs = new Map<string, Element>();\n\n    private cseq = 0;\n    private lastSeq = 0;\n    private connectedState = false;\n\n    constructor(config: RuntimeConfig) {\n        this.lastSeq = config.seq;\n\n        Logger.configure({ enabled: config.debug ?? false, level: 'debug' });\n        Logger.info('Runtime', 'Initializing', { sid: config.sessionId, ver: config.version });\n\n        this.bus = new Bus();\n\n        this.transport = new Transport({\n            endpoint: config.endpoint,\n            sessionId: config.sessionId,\n            version: config.version,\n            lastAck: config.seq,\n            location: config.location,\n            bus: this.bus,\n        });\n\n        const resolveRef = (refId: string) => this.refs.get(refId);\n\n        this.patcher = new Patcher(config.root, {\n            onEvent: (handlerId, data) => this.handleEvent(handlerId, data),\n            onRef: (refId, el) => {\n                this.refs.set(refId, el);\n                Logger.debug('Runtime', 'Ref set', refId);\n            },\n            onRefDelete: (refId) => {\n                this.refs.delete(refId);\n                Logger.debug('Runtime', 'Ref deleted', refId);\n            },\n            onScript: (meta, el) => this.handleScript(meta, el),\n            onScriptCleanup: (scriptId) => this.handleScriptCleanup(scriptId),\n        });\n\n        this.executor = new Executor({\n            bus: this.bus,\n            transport: this.transport,\n            resolveRef,\n        });\n\n        this.scripts = new ScriptExecutor({ bus: this.bus, transport: this.transport });\n\n        this.bus.subscribe('frame', 'patch', (payload) => this.handlePatch(payload));\n\n        this.transport.onStateChange((state) => this.handleStateChange(state));\n\n        window.__POND_RUNTIME__ = this;\n    }\n\n    connect(): void {\n        Logger.info('Runtime', 'Connecting');\n        this.transport.connect();\n    }\n\n    disconnect(): void {\n        Logger.info('Runtime', 'Disconnecting');\n        this.transport.disconnect();\n        this.executor.destroy();\n        this.scripts.destroy();\n        this.bus.clear();\n        this.refs.clear();\n    }\n\n    connected(): boolean {\n        return this.connectedState;\n    }\n\n    get seq(): number {\n        return this.lastSeq;\n    }\n\n    handleBoot(boot: Boot): void {\n        Logger.info('Runtime', 'Boot received', { ver: boot.ver, seq: boot.seq, patches: boot.patch?.length ?? 0 });\n\n        if (boot.patch && boot.patch.length > 0) {\n            this.applyPatches(boot.patch);\n        }\n\n        this.lastSeq = boot.seq;\n        this.transport.sendAck(boot.seq);\n    }\n\n    handleMessage(msg: unknown): void {\n        if (isServerError(msg)) {\n            const err = msg as { code: string; message: string };\n            Logger.error('Runtime', 'Server error', { code: err.code, message: err.message });\n            return;\n        }\n\n        if (isResumeOK(msg)) {\n            this.handleResumeOK(msg);\n            return;\n        }\n    }\n\n    private handlePatch(payload: FramePatchPayload): void {\n        Logger.debug('Runtime', 'Patch received', { seq: payload.seq, count: payload.patches?.length ?? 0 });\n\n        if (payload.patches && payload.patches.length > 0) {\n            this.applyPatches(payload.patches);\n        }\n\n        this.lastSeq = payload.seq;\n        this.transport.sendAck(payload.seq);\n    }\n\n    private handleResumeOK(resume: ResumeOK): void {\n        Logger.info('Runtime', 'Resume OK', { from: resume.from, to: resume.to });\n    }\n\n    private handleEvent(handlerId: string, data: Record<string, unknown>): void {\n        this.cseq++;\n        Logger.debug('Runtime', 'Event', { handler: handlerId, cseq: this.cseq });\n\n        const payload = {\n            ...data,\n            cseq: this.cseq,\n        };\n\n        this.transport.sendHandler(handlerId, payload);\n    }\n\n    private handleScript(meta: ScriptMeta, el: Element): void {\n        Logger.debug('Runtime', 'Script execute', meta.scriptId);\n        this.scripts.execute(meta, el).catch((err) => {\n            Logger.error('Runtime', 'Script error', { scriptId: meta.scriptId, error: String(err) });\n        });\n    }\n\n    private handleScriptCleanup(scriptId: string): void {\n        Logger.debug('Runtime', 'Script cleanup', scriptId);\n        this.scripts.cleanup(scriptId);\n    }\n\n    private handleStateChange(state: ConnectionState): void {\n        Logger.debug('Runtime', 'Connection state', state);\n\n        const wasConnected = this.connectedState;\n        this.connectedState = state === 'connected';\n\n        if (!wasConnected && this.connectedState) {\n            Logger.info('Runtime', 'Connected');\n        } else if (wasConnected && !this.connectedState) {\n            Logger.warn('Runtime', 'Disconnected');\n        }\n    }\n\n    private applyPatches(patches: Patch[]): void {\n        this.patcher.apply(patches);\n    }\n}\n\nexport function boot(): Runtime | null {\n    if (typeof window === 'undefined') return null;\n\n    const script = document.getElementById('live-boot');\n    let bootData: Boot | null = null;\n\n    if (script?.textContent) {\n        try {\n            bootData = JSON.parse(script.textContent);\n        } catch {\n            Logger.error('Runtime', 'Failed to parse boot payload');\n        }\n    }\n\n    if (!bootData) {\n        bootData = window.__LIVEUI_BOOT__ ?? null;\n    }\n\n    if (!bootData || !isBoot(bootData)) {\n        Logger.error('Runtime', 'No boot payload found');\n        return null;\n    }\n\n    const config: RuntimeConfig = {\n        root: document.documentElement,\n        sessionId: bootData.sid,\n        version: bootData.ver,\n        seq: bootData.seq,\n        endpoint: '/live',\n        location: bootData.location,\n        debug: bootData.client?.debug,\n    };\n\n    const runtime = new Runtime(config);\n    runtime.handleBoot(bootData);\n    runtime.connect();\n\n    return runtime;\n}\n"],
  "mappings": "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",
  "names": ["exports", "PresenceEventTypes", "ServerActions", "ClientActions", "ChannelState", "ErrorTypes", "SystemSender", "ChannelReceiver", "Events", "PubSubEvents", "exports", "exports", "message", "_Channel_emptyQueue", "_Channel_init", "_Channel_onMessage", "_Channel_publish", "_Channel_subscribeToPresence", "PondClient", "_PondClient_createPublisher", "_PondClient_handleAcknowledge", "_PondClient_init", "WebSocket", "PondClient", "PondClient", "subId", "boot"]
}
