{
  "version": 3,
  "sources": ["../../../../client/node_modules/@eleven-am/pondsocket-common/subjects/subject.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/subjects/behaviorSubject.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/subjects/index.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/enums.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/misc/uuid.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/misc/types.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/misc/index.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/schema.js", "../../../../client/node_modules/@eleven-am/pondsocket-common/index.js", "../../../../client/node_modules/@eleven-am/pondsocket-client/core/channel.js", "../../../../client/node_modules/@eleven-am/pondsocket-client/browser/client.js", "../../../../client/node_modules/es5-ext/global.js", "../../../../client/node_modules/websocket/package.json", "../../../../client/node_modules/websocket/lib/version.js", "../../../../client/node_modules/websocket/lib/browser.js", "../../../../client/node_modules/@eleven-am/pondsocket-client/node/node.js", "../../../../client/node_modules/@eleven-am/pondsocket-client/index.js", "../../../../client/src/entry.ts", "../../../../client/src/runtime.ts", "../../../../client/src/logger.ts", "../../../../client/src/boot.ts", "../../../../client/src/emitter.ts", "../../../../client/src/manifest.ts", "../../../../client/src/dom-registry.ts", "../../../../client/src/refs.ts", "../../../../client/src/events.ts", "../../../../client/src/router-bindings.ts", "../../../../client/src/patcher.ts", "../../../../client/src/uploads.ts", "../../../../client/src/metadata.ts", "../../../../client/src/hydration.ts", "../../../../client/src/event-detail.ts", "../../../../client/src/event-delegation.ts", "../../../../client/src/index.ts"],
  "sourcesContent": ["\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _Subject_isClosed, _Subject_observers;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Subject = void 0;\nclass Subject {\n    constructor() {\n        _Subject_isClosed.set(this, void 0);\n        _Subject_observers.set(this, void 0);\n        __classPrivateFieldSet(this, _Subject_isClosed, false, \"f\");\n        __classPrivateFieldSet(this, _Subject_observers, new Set(), \"f\");\n    }\n    /**\n     * @desc Returns the number of subscribers\n     */\n    get size() {\n        return __classPrivateFieldGet(this, _Subject_observers, \"f\").size;\n    }\n    /**\n     * @desc Subscribes to a subject\n     * @param observer - The observer to subscribe\n     */\n    subscribe(observer) {\n        if (__classPrivateFieldGet(this, _Subject_isClosed, \"f\")) {\n            throw new Error('Cannot subscribe to a closed subject');\n        }\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").add(observer);\n        return () => __classPrivateFieldGet(this, _Subject_observers, \"f\").delete(observer);\n    }\n    /**\n     * @desc Publishes a message to all subscribers\n     * @param message - The message to publish\n     */\n    publish(message) {\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").forEach((observer) => observer(message));\n    }\n    /**\n     * @desc Closes the subject\n     */\n    close() {\n        __classPrivateFieldGet(this, _Subject_observers, \"f\").clear();\n        __classPrivateFieldSet(this, _Subject_isClosed, true, \"f\");\n    }\n}\nexports.Subject = Subject;\n_Subject_isClosed = new WeakMap(), _Subject_observers = new WeakMap();\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _BehaviorSubject_lastMessage;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BehaviorSubject = void 0;\nconst subject_1 = require(\"./subject\");\nclass BehaviorSubject extends subject_1.Subject {\n    constructor(initialValue) {\n        super();\n        _BehaviorSubject_lastMessage.set(this, void 0);\n        __classPrivateFieldSet(this, _BehaviorSubject_lastMessage, initialValue, \"f\");\n    }\n    /**\n     * @desc Returns the last message published\n     */\n    get value() {\n        return __classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\");\n    }\n    /**\n     * @desc Publishes a message to all subscribers\n     * @param message - The message to publish\n     */\n    publish(message) {\n        __classPrivateFieldSet(this, _BehaviorSubject_lastMessage, message, \"f\");\n        super.publish(message);\n    }\n    /**\n     * @desc Subscribes to a subject\n     * @param observer - The observer to subscribe\n     */\n    subscribe(observer) {\n        if (__classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\")) {\n            observer(__classPrivateFieldGet(this, _BehaviorSubject_lastMessage, \"f\"));\n        }\n        return super.subscribe(observer);\n    }\n}\nexports.BehaviorSubject = BehaviorSubject;\n_BehaviorSubject_lastMessage = new WeakMap();\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./behaviorSubject\"), exports);\n__exportStar(require(\"./subject\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PubSubEvents = exports.Events = exports.ChannelReceiver = exports.SystemSender = exports.ErrorTypes = exports.ChannelState = exports.ClientActions = exports.ServerActions = exports.PresenceEventTypes = void 0;\nvar PresenceEventTypes;\n(function (PresenceEventTypes) {\n    PresenceEventTypes[\"JOIN\"] = \"JOIN\";\n    PresenceEventTypes[\"LEAVE\"] = \"LEAVE\";\n    PresenceEventTypes[\"UPDATE\"] = \"UPDATE\";\n})(PresenceEventTypes || (exports.PresenceEventTypes = PresenceEventTypes = {}));\nvar ServerActions;\n(function (ServerActions) {\n    ServerActions[\"PRESENCE\"] = \"PRESENCE\";\n    ServerActions[\"SYSTEM\"] = \"SYSTEM\";\n    ServerActions[\"BROADCAST\"] = \"BROADCAST\";\n    ServerActions[\"ERROR\"] = \"ERROR\";\n    ServerActions[\"CONNECT\"] = \"CONNECT\";\n})(ServerActions || (exports.ServerActions = ServerActions = {}));\nvar ClientActions;\n(function (ClientActions) {\n    ClientActions[\"JOIN_CHANNEL\"] = \"JOIN_CHANNEL\";\n    ClientActions[\"LEAVE_CHANNEL\"] = \"LEAVE_CHANNEL\";\n    ClientActions[\"BROADCAST\"] = \"BROADCAST\";\n})(ClientActions || (exports.ClientActions = ClientActions = {}));\nvar ChannelState;\n(function (ChannelState) {\n    ChannelState[\"IDLE\"] = \"IDLE\";\n    ChannelState[\"JOINING\"] = \"JOINING\";\n    ChannelState[\"JOINED\"] = \"JOINED\";\n    ChannelState[\"STALLED\"] = \"STALLED\";\n    ChannelState[\"CLOSED\"] = \"CLOSED\";\n})(ChannelState || (exports.ChannelState = ChannelState = {}));\nvar ErrorTypes;\n(function (ErrorTypes) {\n    ErrorTypes[\"UNAUTHORIZED_CONNECTION\"] = \"UNAUTHORIZED_CONNECTION\";\n    ErrorTypes[\"UNAUTHORIZED_JOIN_REQUEST\"] = \"UNAUTHORIZED_JOIN_REQUEST\";\n    ErrorTypes[\"UNAUTHORIZED_BROADCAST\"] = \"UNAUTHORIZED_BROADCAST\";\n    ErrorTypes[\"INVALID_MESSAGE\"] = \"INVALID_MESSAGE\";\n    ErrorTypes[\"HANDLER_NOT_FOUND\"] = \"HANDLER_NOT_FOUND\";\n    ErrorTypes[\"PRESENCE_ERROR\"] = \"PRESENCE_ERROR\";\n    ErrorTypes[\"CHANNEL_ERROR\"] = \"CHANNEL_ERROR\";\n    ErrorTypes[\"ENDPOINT_ERROR\"] = \"ENDPOINT_ERROR\";\n    ErrorTypes[\"INTERNAL_SERVER_ERROR\"] = \"INTERNAL_SERVER_ERROR\";\n})(ErrorTypes || (exports.ErrorTypes = ErrorTypes = {}));\nvar SystemSender;\n(function (SystemSender) {\n    SystemSender[\"ENDPOINT\"] = \"ENDPOINT\";\n    SystemSender[\"CHANNEL\"] = \"CHANNEL\";\n})(SystemSender || (exports.SystemSender = SystemSender = {}));\nvar ChannelReceiver;\n(function (ChannelReceiver) {\n    ChannelReceiver[\"ALL_USERS\"] = \"ALL_USERS\";\n    ChannelReceiver[\"ALL_EXCEPT_SENDER\"] = \"ALL_EXCEPT_SENDER\";\n})(ChannelReceiver || (exports.ChannelReceiver = ChannelReceiver = {}));\nvar Events;\n(function (Events) {\n    Events[\"ACKNOWLEDGE\"] = \"ACKNOWLEDGE\";\n    Events[\"CONNECTION\"] = \"CONNECTION\";\n})(Events || (exports.Events = Events = {}));\nvar PubSubEvents;\n(function (PubSubEvents) {\n    PubSubEvents[\"MESSAGE\"] = \"MESSAGE\";\n    PubSubEvents[\"PRESENCE\"] = \"PRESENCE\";\n    PubSubEvents[\"GET_PRESENCE\"] = \"GET_PRESENCE\";\n})(PubSubEvents || (exports.PubSubEvents = PubSubEvents = {}));\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.uuid = uuid;\nfunction uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'\n        .replace(/[xy]/g, (c) => {\n        const r = Math.random() * 16 | 0;\n        const v = c === 'x' ? r : (r & 0x3 | 0x8);\n        return v.toString(16);\n    });\n}\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./uuid\"), exports);\n__exportStar(require(\"./types\"), exports);\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.channelEventSchema = exports.serverMessageSchema = exports.presenceMessageSchema = exports.clientMessageSchema = exports.ValidationError = void 0;\nconst enums_1 = require(\"./enums\");\n// ============================================================================\n// Validation Error\n// ============================================================================\nclass ValidationError extends Error {\n    constructor(message, path) {\n        super(path ? `${path}: ${message}` : message);\n        this.path = path;\n        this.name = 'ValidationError';\n    }\n}\nexports.ValidationError = ValidationError;\n// ============================================================================\n// Validation Utilities\n// ============================================================================\nfunction isObject(value) {\n    return typeof value === 'object' && value !== null && !Array.isArray(value);\n}\nfunction isString(value) {\n    return typeof value === 'string';\n}\nfunction isArray(value) {\n    return Array.isArray(value);\n}\nfunction isRecord(value) {\n    if (!isObject(value)) {\n        return false;\n    }\n    return Object.keys(value)\n        .every((key) => typeof key === 'string');\n}\nfunction validateString(value, fieldName) {\n    if (!isString(value)) {\n        throw new ValidationError(`Expected string, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateObject(value, fieldName) {\n    if (!isObject(value)) {\n        throw new ValidationError(`Expected object, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateRecord(value, fieldName) {\n    if (!isRecord(value)) {\n        throw new ValidationError(`Expected record with string keys, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateArray(value, fieldName) {\n    if (!isArray(value)) {\n        throw new ValidationError(`Expected array, got ${typeof value}`, fieldName);\n    }\n}\nfunction validateEnum(value, enumObj, fieldName) {\n    const validValues = Object.values(enumObj);\n    if (!validValues.includes(value)) {\n        throw new ValidationError(`Expected one of [${validValues.join(', ')}], got ${JSON.stringify(value)}`, fieldName);\n    }\n}\n// ============================================================================\n// Schema Validators\n// ============================================================================\nexports.clientMessageSchema = {\n    parse(data) {\n        validateObject(data, 'clientMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Validate types\n        validateString(obj.event, 'event');\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateRecord(obj.payload, 'payload');\n        validateEnum(obj.action, enums_1.ClientActions, 'action');\n        return {\n            event: obj.event,\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            payload: obj.payload,\n            action: obj.action,\n        };\n    },\n};\nexports.presenceMessageSchema = {\n    parse(data) {\n        validateObject(data, 'presenceMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        // Validate types\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateEnum(obj.event, enums_1.PresenceEventTypes, 'event');\n        // Validate action is exactly PRESENCE\n        if (obj.action !== enums_1.ServerActions.PRESENCE) {\n            throw new ValidationError(`Expected ${enums_1.ServerActions.PRESENCE}, got ${JSON.stringify(obj.action)}`, 'action');\n        }\n        // Validate payload structure\n        validateObject(obj.payload, 'payload');\n        const payload = obj.payload;\n        if (!('presence' in payload)) {\n            throw new ValidationError('Missing required field', 'payload.presence');\n        }\n        if (!('changed' in payload)) {\n            throw new ValidationError('Missing required field', 'payload.changed');\n        }\n        validateArray(payload.presence, 'payload.presence');\n        // Validate each presence item is a record\n        payload.presence.forEach((item, index) => {\n            validateRecord(item, `payload.presence[${index}]`);\n        });\n        validateRecord(payload.changed, 'payload.changed');\n        return {\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            event: obj.event,\n            action: enums_1.ServerActions.PRESENCE,\n            payload: {\n                presence: payload.presence,\n                changed: payload.changed,\n            },\n        };\n    },\n};\nexports.serverMessageSchema = {\n    parse(data) {\n        validateObject(data, 'serverMessage');\n        const obj = data;\n        // Validate required fields\n        if (!('event' in obj)) {\n            throw new ValidationError('Missing required field', 'event');\n        }\n        if (!('requestId' in obj)) {\n            throw new ValidationError('Missing required field', 'requestId');\n        }\n        if (!('channelName' in obj)) {\n            throw new ValidationError('Missing required field', 'channelName');\n        }\n        if (!('payload' in obj)) {\n            throw new ValidationError('Missing required field', 'payload');\n        }\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Validate types\n        validateString(obj.event, 'event');\n        validateString(obj.requestId, 'requestId');\n        validateString(obj.channelName, 'channelName');\n        validateRecord(obj.payload, 'payload');\n        // Validate action is one of the allowed server actions\n        const validActions = [\n            enums_1.ServerActions.BROADCAST,\n            enums_1.ServerActions.CONNECT,\n            enums_1.ServerActions.ERROR,\n            enums_1.ServerActions.SYSTEM,\n        ];\n        if (!validActions.includes(obj.action)) {\n            throw new ValidationError(`Expected one of [${validActions.join(', ')}], got ${JSON.stringify(obj.action)}`, 'action');\n        }\n        return {\n            event: obj.event,\n            requestId: obj.requestId,\n            channelName: obj.channelName,\n            payload: obj.payload,\n            action: obj.action,\n        };\n    },\n};\nexports.channelEventSchema = {\n    parse(data) {\n        validateObject(data, 'channelEvent');\n        const obj = data;\n        // Check action to determine which schema to use\n        if (!('action' in obj)) {\n            throw new ValidationError('Missing required field', 'action');\n        }\n        // Discriminate based on action field\n        if (obj.action === enums_1.ServerActions.PRESENCE) {\n            return exports.presenceMessageSchema.parse(data);\n        }\n        return exports.serverMessageSchema.parse(data);\n    },\n};\n", "\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./subjects\"), exports);\n__exportStar(require(\"./enums\"), exports);\n__exportStar(require(\"./misc\"), exports);\n__exportStar(require(\"./schema\"), exports);\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _Channel_instances, _Channel_name, _Channel_queue, _Channel_presence, _Channel_presenceSub, _Channel_publisher, _Channel_joinParams, _Channel_receiver, _Channel_clientState, _Channel_joinState, _Channel_emptyQueue, _Channel_init, _Channel_onMessage, _Channel_publish, _Channel_subscribeToPresence;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Channel = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nclass Channel {\n    constructor(publisher, clientState, name, params) {\n        _Channel_instances.add(this);\n        _Channel_name.set(this, void 0);\n        _Channel_queue.set(this, void 0);\n        _Channel_presence.set(this, void 0);\n        _Channel_presenceSub.set(this, void 0);\n        _Channel_publisher.set(this, void 0);\n        _Channel_joinParams.set(this, void 0);\n        _Channel_receiver.set(this, void 0);\n        _Channel_clientState.set(this, void 0);\n        _Channel_joinState.set(this, void 0);\n        __classPrivateFieldSet(this, _Channel_name, name, \"f\");\n        __classPrivateFieldSet(this, _Channel_queue, [], \"f\");\n        __classPrivateFieldSet(this, _Channel_presence, [], \"f\");\n        __classPrivateFieldSet(this, _Channel_joinParams, params, \"f\");\n        __classPrivateFieldSet(this, _Channel_publisher, publisher, \"f\");\n        __classPrivateFieldSet(this, _Channel_clientState, clientState, \"f\");\n        __classPrivateFieldSet(this, _Channel_receiver, new pondsocket_common_1.Subject(), \"f\");\n        __classPrivateFieldSet(this, _Channel_joinState, new pondsocket_common_1.BehaviorSubject(pondsocket_common_1.ChannelState.IDLE), \"f\");\n        __classPrivateFieldSet(this, _Channel_presenceSub, () => {\n            // do nothing\n        }, \"f\");\n    }\n    /**\n     * @desc Gets the current connection state of the channel.\n     */\n    get channelState() {\n        return __classPrivateFieldGet(this, _Channel_joinState, \"f\").value;\n    }\n    /**\n     * @desc Gets the current presence of the channel.\n     */\n    get presence() {\n        return __classPrivateFieldGet(this, _Channel_presence, \"f\");\n    }\n    /**\n     * @desc Acknowledges the channel has been joined on the server.\n     * @param receiver - The receiver to subscribe to.\n     */\n    acknowledge(receiver) {\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.JOINED);\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_init).call(this, receiver);\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_emptyQueue).call(this);\n    }\n    /**\n     * @desc Connects to the channel.\n     */\n    join() {\n        const message = {\n            action: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n            event: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n            payload: __classPrivateFieldGet(this, _Channel_joinParams, \"f\"),\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId: (0, pondsocket_common_1.uuid)(),\n        };\n        if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n            return;\n        }\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.JOINING);\n        if (__classPrivateFieldGet(this, _Channel_clientState, \"f\").value) {\n            __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n        }\n        else {\n            const unsubscribe = __classPrivateFieldGet(this, _Channel_clientState, \"f\").subscribe((state) => {\n                if (state) {\n                    unsubscribe();\n                    if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINING) {\n                        __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n                    }\n                }\n            });\n        }\n    }\n    /**\n     * @desc Disconnects from the channel.\n     */\n    leave() {\n        const message = {\n            action: pondsocket_common_1.ClientActions.LEAVE_CHANNEL,\n            event: pondsocket_common_1.ClientActions.LEAVE_CHANNEL,\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId: (0, pondsocket_common_1.uuid)(),\n            payload: {},\n        };\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n        __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.CLOSED);\n        __classPrivateFieldGet(this, _Channel_presenceSub, \"f\").call(this);\n    }\n    /**\n     * @desc Monitors the channel state of the channel.\n     * @param callback - The callback to call when the connection state changes.\n     */\n    onChannelStateChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_joinState, \"f\").subscribe((data) => {\n            callback(data);\n        });\n    }\n    /**\n     * @desc Detects when clients join the channel.\n     * @param callback - The callback to call when a client joins the channel.\n     */\n    onJoin(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.JOIN) {\n                return callback(payload.changed);\n            }\n        });\n    }\n    /**\n     * @desc Detects when clients leave the channel.\n     * @param callback - The callback to call when a client leaves the channel.\n     */\n    onLeave(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.LEAVE) {\n                return callback(payload.changed);\n            }\n        });\n    }\n    /**\n     * @desc Monitors the channel for messages.\n     * @param callback - The callback to call when a message is received.\n     */\n    onMessage(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_onMessage).call(this, (event, message) => {\n            callback(event, message);\n        });\n    }\n    /**\n     * @desc Monitors the channel for messages.\n     * @param event - The event to monitor.\n     * @param callback - The callback to call when a message is received.\n     */\n    onMessageEvent(event, callback) {\n        return this.onMessage((eventReceived, message) => {\n            if (eventReceived === event) {\n                return callback(message);\n            }\n        });\n    }\n    /**\n     * @desc Detects when clients change their presence in the channel.\n     * @param callback - The callback to call when a client changes their presence in the channel.\n     */\n    onPresenceChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (event, payload) => {\n            if (event === pondsocket_common_1.PresenceEventTypes.UPDATE) {\n                return callback(payload);\n            }\n        });\n    }\n    /**\n     * @desc Monitors the presence of the channel.\n     * @param callback - The callback to call when the presence changes.\n     */\n    onUsersChange(callback) {\n        return __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (_event, payload) => callback(payload.presence));\n    }\n    /**\n     * @desc Sends a message to specific clients in the channel.\n     * @param event - The event to send.\n     * @param payload - The message to send.\n     */\n    sendMessage(event, payload) {\n        const requestId = (0, pondsocket_common_1.uuid)();\n        const message = {\n            action: pondsocket_common_1.ClientActions.BROADCAST,\n            channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n            requestId,\n            event,\n            payload,\n        };\n        __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n    }\n    /**\n     * @desc Sends a message to the server and waits for a response.\n     * @param sentEvent - The event to send.\n     * @param payload - The message to send.\n     */\n    sendForResponse(sentEvent, payload) {\n        const requestId = (0, pondsocket_common_1.uuid)();\n        return new Promise((resolve) => {\n            const unsub = __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_onMessage).call(this, (_, message, responseId) => {\n                if (requestId === responseId) {\n                    resolve(message);\n                    unsub();\n                }\n            });\n            const message = {\n                action: pondsocket_common_1.ClientActions.BROADCAST,\n                channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n                requestId,\n                event: sentEvent,\n                payload,\n            };\n            __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_publish).call(this, message);\n        });\n    }\n}\nexports.Channel = Channel;\n_Channel_name = new WeakMap(), _Channel_queue = new WeakMap(), _Channel_presence = new WeakMap(), _Channel_presenceSub = new WeakMap(), _Channel_publisher = new WeakMap(), _Channel_joinParams = new WeakMap(), _Channel_receiver = new WeakMap(), _Channel_clientState = new WeakMap(), _Channel_joinState = new WeakMap(), _Channel_instances = new WeakSet(), _Channel_emptyQueue = function _Channel_emptyQueue() {\n    __classPrivateFieldGet(this, _Channel_queue, \"f\")\n        .forEach((message) => __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message));\n    __classPrivateFieldSet(this, _Channel_queue, [], \"f\");\n}, _Channel_init = function _Channel_init(receiver) {\n    __classPrivateFieldGet(this, _Channel_presenceSub, \"f\").call(this);\n    const unsubMessages = receiver.subscribe((data) => {\n        if (data.channelName === __classPrivateFieldGet(this, _Channel_name, \"f\") && this.channelState === pondsocket_common_1.ChannelState.JOINED) {\n            __classPrivateFieldGet(this, _Channel_receiver, \"f\").publish(data);\n        }\n    });\n    const unsubStateChange = __classPrivateFieldGet(this, _Channel_clientState, \"f\").subscribe((state) => {\n        if (state && __classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.STALLED) {\n            const message = {\n                action: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n                event: pondsocket_common_1.ClientActions.JOIN_CHANNEL,\n                payload: __classPrivateFieldGet(this, _Channel_joinParams, \"f\"),\n                channelName: __classPrivateFieldGet(this, _Channel_name, \"f\"),\n                requestId: (0, pondsocket_common_1.uuid)(),\n            };\n            __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, message);\n        }\n        else if (!state && __classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n            __classPrivateFieldGet(this, _Channel_joinState, \"f\").publish(pondsocket_common_1.ChannelState.STALLED);\n        }\n    });\n    const unsubPresence = __classPrivateFieldGet(this, _Channel_instances, \"m\", _Channel_subscribeToPresence).call(this, (_, payload) => {\n        __classPrivateFieldSet(this, _Channel_presence, payload.presence, \"f\");\n    });\n    __classPrivateFieldSet(this, _Channel_presenceSub, () => {\n        unsubMessages();\n        unsubStateChange();\n        unsubPresence();\n    }, \"f\");\n}, _Channel_onMessage = function _Channel_onMessage(callback) {\n    return __classPrivateFieldGet(this, _Channel_receiver, \"f\").subscribe((data) => {\n        if (data.action !== pondsocket_common_1.ServerActions.PRESENCE) {\n            return callback(data.event, data.payload, data.requestId);\n        }\n    });\n}, _Channel_publish = function _Channel_publish(data) {\n    if (__classPrivateFieldGet(this, _Channel_joinState, \"f\").value === pondsocket_common_1.ChannelState.JOINED) {\n        return __classPrivateFieldGet(this, _Channel_publisher, \"f\").call(this, data);\n    }\n    __classPrivateFieldGet(this, _Channel_queue, \"f\").push(data);\n}, _Channel_subscribeToPresence = function _Channel_subscribeToPresence(callback) {\n    return __classPrivateFieldGet(this, _Channel_receiver, \"f\").subscribe((data) => {\n        if (data.action === pondsocket_common_1.ServerActions.PRESENCE) {\n            return callback(data.event, data.payload);\n        }\n    });\n};\n", "\"use strict\";\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _PondClient_instances, _PondClient_channels, _PondClient_createPublisher, _PondClient_handleAcknowledge, _PondClient_init;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nconst channel_1 = require(\"../core/channel\");\nclass PondClient {\n    constructor(endpoint, params = {}) {\n        _PondClient_instances.add(this);\n        _PondClient_channels.set(this, void 0);\n        let address;\n        try {\n            address = new URL(endpoint);\n        }\n        catch (e) {\n            address = new URL(window.location.toString());\n            address.pathname = endpoint;\n        }\n        this._disconnecting = false;\n        const query = new URLSearchParams(params);\n        address.search = query.toString();\n        const protocol = address.protocol === 'https:' ? 'wss:' : 'ws:';\n        if (address.protocol !== 'wss:' && address.protocol !== 'ws:') {\n            address.protocol = protocol;\n        }\n        this._address = address;\n        __classPrivateFieldSet(this, _PondClient_channels, new Map(), \"f\");\n        this._broadcaster = new pondsocket_common_1.Subject();\n        this._connectionState = new pondsocket_common_1.BehaviorSubject(false);\n        __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_init).call(this);\n    }\n    /**\n     * @desc Connects to the server and returns the socket.\n     */\n    connect() {\n        this._disconnecting = false;\n        const socket = new WebSocket(this._address.toString());\n        socket.onmessage = (message) => {\n            const lines = message.data.trim().split('\\n');\n            for (const line of lines) {\n                if (line.trim()) {\n                    const data = JSON.parse(line);\n                    const event = pondsocket_common_1.channelEventSchema.parse(data);\n                    this._broadcaster.publish(event);\n                }\n            }\n        };\n        socket.onerror = () => socket.close();\n        socket.onclose = () => {\n            this._connectionState.publish(false);\n            if (this._disconnecting) {\n                return;\n            }\n            setTimeout(() => {\n                this.connect();\n            }, 1000);\n        };\n        this._socket = socket;\n    }\n    /**\n     * @desc Returns the current state of the socket.\n     */\n    getState() {\n        return this._connectionState.value;\n    }\n    /**\n     * @desc Disconnects the socket.\n     */\n    disconnect() {\n        var _a;\n        this._connectionState.publish(false);\n        this._disconnecting = true;\n        (_a = this._socket) === null || _a === void 0 ? void 0 : _a.close();\n        __classPrivateFieldGet(this, _PondClient_channels, \"f\").clear();\n    }\n    /**\n     * @desc Creates a channel with the given name and params.\n     * @param name - The name of the channel.\n     * @param params - The params to send to the server.\n     */\n    createChannel(name, params) {\n        const channel = __classPrivateFieldGet(this, _PondClient_channels, \"f\").get(name);\n        if (channel && channel.channelState !== pondsocket_common_1.ChannelState.CLOSED) {\n            return channel;\n        }\n        const publisher = __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_createPublisher).call(this);\n        const newChannel = new channel_1.Channel(publisher, this._connectionState, name, params || {});\n        __classPrivateFieldGet(this, _PondClient_channels, \"f\").set(name, newChannel);\n        return newChannel;\n    }\n    /**\n     * @desc Subscribes to the connection state.\n     * @param callback - The callback to call when the state changes.\n     */\n    onConnectionChange(callback) {\n        return this._connectionState.subscribe(callback);\n    }\n}\nexports.PondClient = PondClient;\n_PondClient_channels = new WeakMap(), _PondClient_instances = new WeakSet(), _PondClient_createPublisher = function _PondClient_createPublisher() {\n    return (message) => {\n        if (this._connectionState.value) {\n            this._socket.send(JSON.stringify(message));\n        }\n    };\n}, _PondClient_handleAcknowledge = function _PondClient_handleAcknowledge(message) {\n    var _a;\n    const channel = (_a = __classPrivateFieldGet(this, _PondClient_channels, \"f\").get(message.channelName)) !== null && _a !== void 0 ? _a : new channel_1.Channel(__classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_createPublisher).call(this), this._connectionState, message.channelName, {});\n    __classPrivateFieldGet(this, _PondClient_channels, \"f\").set(message.channelName, channel);\n    channel.acknowledge(this._broadcaster);\n}, _PondClient_init = function _PondClient_init() {\n    this._broadcaster.subscribe((message) => {\n        if (message.event === pondsocket_common_1.Events.ACKNOWLEDGE) {\n            __classPrivateFieldGet(this, _PondClient_instances, \"m\", _PondClient_handleAcknowledge).call(this, message);\n        }\n        else if (message.event === pondsocket_common_1.Events.CONNECTION && message.action === pondsocket_common_1.ServerActions.CONNECT) {\n            this._connectionState.publish(true);\n        }\n    });\n};\n", "var naiveFallback = function () {\n\tif (typeof self === \"object\" && self) return self;\n\tif (typeof window === \"object\" && window) return window;\n\tthrow new Error(\"Unable to resolve global `this`\");\n};\n\nmodule.exports = (function () {\n\tif (this) return this;\n\n\t// Unexpected strict mode (may happen if e.g. bundled into ESM module)\n\n\t// Fallback to standard globalThis if available\n\tif (typeof globalThis === \"object\" && globalThis) return globalThis;\n\n\t// Thanks @mathiasbynens -> https://mathiasbynens.be/notes/globalthis\n\t// In all ES5+ engines global object inherits from Object.prototype\n\t// (if you approached one that doesn't please report)\n\ttry {\n\t\tObject.defineProperty(Object.prototype, \"__global__\", {\n\t\t\tget: function () { return this; },\n\t\t\tconfigurable: true\n\t\t});\n\t} catch (error) {\n\t\t// Unfortunate case of updates to Object.prototype being restricted\n\t\t// via preventExtensions, seal or freeze\n\t\treturn naiveFallback();\n\t}\n\ttry {\n\t\t// Safari case (window.__global__ works, but __global__ does not)\n\t\tif (!__global__) return naiveFallback();\n\t\treturn __global__;\n\t} finally {\n\t\tdelete Object.prototype.__global__;\n\t}\n})();\n", "{\n  \"name\": \"websocket\",\n  \"description\": \"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.\",\n  \"keywords\": [\n    \"websocket\",\n    \"websockets\",\n    \"socket\",\n    \"networking\",\n    \"comet\",\n    \"push\",\n    \"RFC-6455\",\n    \"realtime\",\n    \"server\",\n    \"client\"\n  ],\n  \"author\": \"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)\",\n  \"contributors\": [\n    \"I\u00F1aki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)\"\n  ],\n  \"version\": \"1.0.35\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/theturtle32/WebSocket-Node.git\"\n  },\n  \"homepage\": \"https://github.com/theturtle32/WebSocket-Node\",\n  \"engines\": {\n    \"node\": \">=4.0.0\"\n  },\n  \"dependencies\": {\n    \"bufferutil\": \"^4.0.1\",\n    \"debug\": \"^2.2.0\",\n    \"es5-ext\": \"^0.10.63\",\n    \"typedarray-to-buffer\": \"^3.1.5\",\n    \"utf-8-validate\": \"^5.0.2\",\n    \"yaeti\": \"^0.0.6\"\n  },\n  \"devDependencies\": {\n    \"buffer-equal\": \"^1.0.0\",\n    \"gulp\": \"^4.0.2\",\n    \"gulp-jshint\": \"^2.0.4\",\n    \"jshint-stylish\": \"^2.2.1\",\n    \"jshint\": \"^2.0.0\",\n    \"tape\": \"^4.9.1\"\n  },\n  \"config\": {\n    \"verbose\": false\n  },\n  \"scripts\": {\n    \"test\": \"tape test/unit/*.js\",\n    \"gulp\": \"gulp\"\n  },\n  \"main\": \"index\",\n  \"directories\": {\n    \"lib\": \"./lib\"\n  },\n  \"browser\": \"lib/browser.js\",\n  \"license\": \"Apache-2.0\"\n}\n", "module.exports = require('../package.json').version;\n", "var _globalThis;\nif (typeof globalThis === 'object') {\n\t_globalThis = globalThis;\n} else {\n\ttry {\n\t\t_globalThis = require('es5-ext/global');\n\t} catch (error) {\n\t} finally {\n\t\tif (!_globalThis && typeof window !== 'undefined') { _globalThis = window; }\n\t\tif (!_globalThis) { throw new Error('Could not determine global this'); }\n\t}\n}\n\nvar NativeWebSocket = _globalThis.WebSocket || _globalThis.MozWebSocket;\nvar websocket_version = require('./version');\n\n\n/**\n * Expose a W3C WebSocket class with just one or two arguments.\n */\nfunction W3CWebSocket(uri, protocols) {\n\tvar native_instance;\n\n\tif (protocols) {\n\t\tnative_instance = new NativeWebSocket(uri, protocols);\n\t}\n\telse {\n\t\tnative_instance = new NativeWebSocket(uri);\n\t}\n\n\t/**\n\t * 'native_instance' is an instance of nativeWebSocket (the browser's WebSocket\n\t * class). Since it is an Object it will be returned as it is when creating an\n\t * instance of W3CWebSocket via 'new W3CWebSocket()'.\n\t *\n\t * ECMAScript 5: http://bclary.com/2004/11/07/#a-13.2.2\n\t */\n\treturn native_instance;\n}\nif (NativeWebSocket) {\n\t['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'].forEach(function(prop) {\n\t\tObject.defineProperty(W3CWebSocket, prop, {\n\t\t\tget: function() { return NativeWebSocket[prop]; }\n\t\t});\n\t});\n}\n\n/**\n * Module exports.\n */\nmodule.exports = {\n    'w3cwebsocket' : NativeWebSocket ? W3CWebSocket : null,\n    'version'      : websocket_version\n};\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nconst client_1 = require(\"../browser/client\");\n// eslint-disable-next-line @typescript-eslint/no-var-requires,@typescript-eslint/no-require-imports\nconst WebSocket = require('websocket').w3cwebsocket;\nclass PondClient extends client_1.PondClient {\n    /**\n     * @desc Connects to the server and returns the socket.\n     */\n    connect(backoff = 1) {\n        this._disconnecting = false;\n        const socket = new WebSocket(this._address.toString());\n        socket.onopen = () => this._connectionState.publish(true);\n        socket.onmessage = (message) => {\n            const lines = message.data.trim().split('\\n');\n            for (const line of lines) {\n                if (line.trim()) {\n                    const data = JSON.parse(line);\n                    const event = pondsocket_common_1.channelEventSchema.parse(data);\n                    this._broadcaster.publish(event);\n                }\n            }\n        };\n        socket.onerror = () => socket.close();\n        socket.onclose = () => {\n            this._connectionState.publish(false);\n            if (this._disconnecting) {\n                return;\n            }\n            setTimeout(() => {\n                this.connect();\n            }, 1000);\n        };\n    }\n}\nexports.PondClient = PondClient;\n", "\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PondClient = exports.ChannelState = void 0;\nconst pondsocket_common_1 = require(\"@eleven-am/pondsocket-common\");\nObject.defineProperty(exports, \"ChannelState\", { enumerable: true, get: function () { return pondsocket_common_1.ChannelState; } });\nconst client_1 = require(\"./browser/client\");\nconst node_1 = require(\"./node/node\");\nconst PondClient = typeof window === 'undefined' ? node_1.PondClient : client_1.PondClient;\nexports.PondClient = PondClient;\n", "import LiveUI from './index';\nimport type { LiveUIOptions, BootPayload } from './types';\nimport { Logger } from './logger';\n\ntype LiveUIInstance = InstanceType<typeof LiveUI>;\n\ntype DevtoolsHook = {\n  installed?: boolean;\n  instance?: LiveUIInstance;\n};\n\ntype LiveUIWindow = Window & {\n  LiveUI?: typeof LiveUI & { boot?: typeof bootClient; instance?: LiveUIInstance };\n  LiveUIInstance?: LiveUIInstance;\n  __LIVEUI_BOOT__?: BootPayload;\n  __LIVEUI_OPTIONS__?: LiveUIOptions;\n  __LIVEUI_DEVTOOLS__?: DevtoolsHook;\n};\n\nlet bootPromise: Promise<LiveUIInstance> | null = null;\n\nfunction getWindow(): LiveUIWindow | null {\n  if (typeof window === 'undefined') {\n    return null;\n  }\n  return window as LiveUIWindow;\n}\n\nfunction detectBootPayload(target: LiveUIWindow): BootPayload | null {\n  if (target.__LIVEUI_BOOT__ && typeof target.__LIVEUI_BOOT__ === 'object') {\n    Logger.debug('[Entry]', 'Boot payload from window', {\n      sid: target.__LIVEUI_BOOT__.sid,\n      hasListPaths: Array.isArray(target.__LIVEUI_BOOT__.listPaths),\n      listPathsLength: Array.isArray(target.__LIVEUI_BOOT__.listPaths) ? target.__LIVEUI_BOOT__.listPaths.length : 0,\n    });\n    return target.__LIVEUI_BOOT__!;\n  }\n  if (typeof document === 'undefined') {\n    return null;\n  }\n  const script = document.getElementById('live-boot');\n  const content = script?.textContent?.trim();\n  if (!content) {\n    Logger.debug('[Entry]', 'No boot script content found');\n    return null;\n  }\n  Logger.debug('[Entry]', 'Boot script found', { contentLength: content.length });\n  try {\n    const payload = JSON.parse(content) as BootPayload;\n    target.__LIVEUI_BOOT__ = payload;\n    Logger.debug('[Entry]', 'Boot payload parsed successfully', {\n      sid: payload.sid,\n      hasListPaths: Array.isArray(payload.listPaths),\n      listPathsLength: Array.isArray(payload.listPaths) ? payload.listPaths.length : 0,\n      listPaths: payload.listPaths,\n      hasComponentPaths: Array.isArray(payload.componentPaths),\n      componentPathsLength: Array.isArray(payload.componentPaths) ? payload.componentPaths.length : 0,\n    });\n    return payload;\n  } catch (error) {\n    Logger.error('Failed to parse boot payload', error);\n    return null;\n  }\n}\n\nfunction attachGlobals(target: LiveUIWindow, instance: LiveUIInstance): void {\n  const LiveUIExport = LiveUI as typeof LiveUI & { boot?: typeof bootClient; instance?: LiveUIInstance };\n  LiveUIExport.boot = bootClient;\n  LiveUIExport.instance = instance;\n  target.LiveUI = LiveUIExport;\n  target.LiveUIInstance = instance;\n  if (target.__LIVEUI_DEVTOOLS__) {\n    target.__LIVEUI_DEVTOOLS__.installed = true;\n    target.__LIVEUI_DEVTOOLS__.instance = instance;\n  }\n}\n\nfunction createClient(target: LiveUIWindow): LiveUIInstance {\n  const inlineOptions = { ...(target.__LIVEUI_OPTIONS__ ?? {}) } as LiveUIOptions;\n  const bootPayload = detectBootPayload(target);\n  const resolvedBoot = inlineOptions.boot ?? bootPayload ?? null;\n  if (resolvedBoot) {\n    inlineOptions.boot = resolvedBoot;\n    target.__LIVEUI_BOOT__ = resolvedBoot;\n    if (typeof resolvedBoot.client?.debug === 'boolean') {\n      inlineOptions.debug = resolvedBoot.client.debug;\n    }\n  }\n  if (typeof inlineOptions.debug === 'undefined') {\n    inlineOptions.debug = false;\n  }\n  target.__LIVEUI_OPTIONS__ = inlineOptions;\n\n  const autoConnect = inlineOptions.autoConnect !== false;\n  inlineOptions.autoConnect = false;\n\n  const client = new LiveUI(inlineOptions);\n  attachGlobals(target, client);\n  Logger.debug('[Entry]', 'LiveUI client created', {\n    autoConnect,\n    debug: inlineOptions.debug,\n    hasBoot: Boolean(resolvedBoot),\n  });\n\n  if (autoConnect && resolvedBoot) {\n    void client.connect().catch((error) => {\n      Logger.error('Failed to connect after boot', error);\n    });\n  }\n\n  return client;\n}\n\nfunction scheduleBoot(target: LiveUIWindow): Promise<LiveUIInstance> {\n  return new Promise((resolve, reject) => {\n    const start = () => {\n      try {\n        const instance = createClient(target);\n        resolve(instance);\n      } catch (error) {\n        reject(error);\n      }\n    };\n    if (typeof document !== 'undefined' && document.readyState === 'loading') {\n      const handler = () => {\n        document.removeEventListener('DOMContentLoaded', handler);\n        start();\n      };\n      document.addEventListener('DOMContentLoaded', handler);\n    } else {\n      start();\n    }\n  });\n}\n\nexport function bootClient(options: { force?: boolean } = {}): Promise<LiveUIInstance> {\n  const target = getWindow();\n  if (!target) {\n    return Promise.reject(new Error('[LiveUI] window is not available in this environment'));\n  }\n  if (options.force) {\n    bootPromise = null;\n  }\n  if (!bootPromise) {\n    bootPromise = scheduleBoot(target);\n  }\n  return bootPromise;\n}\n\nif (typeof window !== 'undefined') {\n  void bootClient().catch((error) => {\n    Logger.error('Boot failed', error);\n  });\n}\n\nexport * from './index';\n", "import {ChannelState, PondClient} from '@eleven-am/pondsocket-client';\nimport {BootLoader} from './boot';\nimport {TypedEventEmitter} from './emitter';\nimport {Logger} from './logger';\nimport type {\n    BootPayload,\n    ClientAckMessage,\n    ClientEventMessage,\n    UploadClientMessage,\n    ClientNavMessage,\n    ClientRecoverMessage,\n    ConnectionState,\n    DiagnosticMessage,\n    DOMRequestMessage,\n    DOMResponseMessage,\n    ErrorMessage,\n    EventAckMessage,\n    FrameMessage,\n    InitMessage,\n    JoinMessage,\n    LiveUIEventMap,\n    LiveUIOptions,\n    PubsubControlMessage,\n    ResumeMessage,\n    TemplateMessage,\n    UploadControlMessage,\n    UploadMeta,\n} from './types';\n\nexport type ServerMessage =\n  | InitMessage\n  | FrameMessage\n  | TemplateMessage\n  | JoinMessage\n  | ResumeMessage\n  | ErrorMessage\n  | DiagnosticMessage\n  | PubsubControlMessage\n  | UploadControlMessage\n  | DOMRequestMessage\n  | EventAckMessage;\n\ntype PondChannel = ReturnType<PondClient['createChannel']>;\n\ntype PendingEvent = {\n  hid: string;\n  payload: ClientEventMessage['payload'];\n  seq: number;\n};\n\ntype InFlightEvent = {\n  seq: number;\n  acked: boolean;\n  frameApplied: boolean;\n};\n\ntype RuntimeEvents = {\n  state: ConnectionState;\n  connected: { sid: string; version: number };\n  disconnected: void;\n  error: { error: Error };\n  message: ServerMessage;\n  init: InitMessage;\n  frame: FrameMessage;\n  template: TemplateMessage;\n  resume: ResumeMessage;\n  join: JoinMessage;\n  diagnostic: DiagnosticMessage;\n  upload: UploadControlMessage;\n  domreq: DOMRequestMessage;\n  evtack: EventAckMessage;\n};\n\nexport interface RuntimeOptions extends LiveUIOptions {\n  reconnect?: boolean;\n  reconnectDelay?: number;\n  maxReconnectAttempts?: number;\n}\n\ntype ResolvedOptions = Required<\n  Pick<RuntimeOptions, 'endpoint' | 'uploadEndpoint' | 'autoConnect' | 'debug'>\n> & {\n  reconnect: boolean;\n  reconnectDelay: number;\n  maxReconnectAttempts: number;\n  boot?: BootPayload;\n};\n\nconst DEFAULT_OPTIONS: ResolvedOptions = {\n  endpoint: '/live',\n  uploadEndpoint: '/pondlive/upload/',\n  autoConnect: true,\n  debug: false,\n  reconnect: true,\n  reconnectDelay: 1000,\n  maxReconnectAttempts: 5,\n};\n\nexport class LiveRuntime {\n  private readonly options: ResolvedOptions;\n  private readonly events = new TypedEventEmitter<RuntimeEvents>();\n  private readonly bootLoader: BootLoader;\n\n  private client: PondClient | null = null;\n  private channel: PondChannel | null = null;\n  private bootPayload: BootPayload | null = null;\n  private connectPromise: Promise<void> | null = null;\n  private reconnectTimer: ReturnType<typeof setTimeout> | null = null;\n  private reconnectAttempts = 0;\n  private disposed = false;\n  private state: ConnectionState = { status: 'disconnected' };\n  private lastAck = 0;\n  private sessionId: string | null = null;\n  private version = 0;\n  private nextEventSeq = 1;\n  private lastEventAck = 0;\n  private readonly pendingEvents: PendingEvent[] = [];\n  private readonly inFlightEvents: InFlightEvent[] = [];\n  private maxInFlightEvents = 2;\n\n  constructor(options?: RuntimeOptions) {\n    this.options = {\n      ...DEFAULT_OPTIONS,\n      ...(options ?? {}),\n    };\n    Logger.configure({ debug: this.options.debug });\n    this.bootLoader = new BootLoader({ debug: this.options.debug });\n\n    this.bootPayload = this.options.boot\n      ? this.bootLoader.load(this.options.boot)\n      : this.bootLoader.load();\n    this.sessionId = this.bootPayload?.sid ?? null;\n    this.version = this.bootPayload?.ver ?? 0;\n    Logger.debug('[Runtime]', 'initialized', {\n      sessionId: this.sessionId,\n      version: this.version,\n      hasBoot: Boolean(this.bootPayload),\n    });\n\n    if (this.options.autoConnect && this.bootPayload) {\n      void this.connect();\n    }\n  }\n\n  on<K extends keyof RuntimeEvents>(event: K, listener: (payload: RuntimeEvents[K]) => void): () => void {\n    return this.events.on(event, listener);\n  }\n\n  once<K extends keyof RuntimeEvents>(event: K, listener: (payload: RuntimeEvents[K]) => void): () => void {\n    return this.events.once(event, listener);\n  }\n\n  off<K extends keyof RuntimeEvents>(event: K, listener: (payload: RuntimeEvents[K]) => void): void {\n    this.events.off(event, listener);\n  }\n\n  getState(): ConnectionState {\n    return this.state;\n  }\n\n  getBootPayload(): BootPayload | null {\n    return this.bootPayload;\n  }\n\n  getSessionId(): string | null {\n    return this.sessionId ?? this.bootPayload?.sid ?? null;\n  }\n\n  getUploadEndpoint(): string {\n    return this.bootPayload?.client?.upload ?? this.options.uploadEndpoint;\n  }\n\n  sendUploadMessage(payload: {\n    id: string;\n    op: 'change' | 'progress' | 'error' | 'cancelled';\n    meta?: UploadMeta;\n    loaded?: number;\n    total?: number;\n    error?: string;\n  }): void {\n    const sid = this.getSessionId();\n    if (!this.channel || !sid || !payload.id) {\n      return;\n    }\n    const message: UploadClientMessage = {\n      t: 'upload',\n      sid,\n      id: payload.id,\n      op: payload.op,\n    };\n    if (payload.meta) {\n      message.meta = payload.meta;\n    }\n    if (typeof payload.loaded === 'number') {\n      message.loaded = payload.loaded;\n    }\n    if (typeof payload.total === 'number') {\n      message.total = payload.total;\n    }\n    if (payload.error) {\n      message.error = payload.error;\n    }\n    Logger.debug('[Runtime]', '\u2192 sending upload message', message);\n    this.channel.sendMessage('upload', message);\n  }\n\n  sendDOMResponse(payload: {\n    id: string;\n    values?: Record<string, any>;\n    result?: any;\n    error?: string;\n  }): void {\n    const sid = this.getSessionId();\n    if (!this.channel || !sid || !payload.id) {\n      return;\n    }\n    const message: DOMResponseMessage = {\n      t: 'domres',\n      sid,\n      id: payload.id,\n    };\n    if (payload.values) {\n      message.values = payload.values;\n    }\n    if (payload.result !== undefined) {\n      message.result = payload.result;\n    }\n    if (payload.error) {\n      message.error = payload.error;\n    }\n    Logger.debug('[Runtime]', '\u2192 sending domres', message);\n    this.channel.sendMessage('domres', message);\n  }\n\n  async connect(): Promise<void> {\n    if (this.disposed) {\n      throw new Error('[LiveUI] runtime disposed');\n    }\n    Logger.debug('[Runtime]', 'connect requested', {\n      hasBoot: Boolean(this.bootPayload),\n      disposed: this.disposed,\n      state: this.state.status,\n    });\n    if (this.channel && this.state.status === 'connected') {\n      return;\n    }\n    if (this.connectPromise) {\n      return this.connectPromise;\n    }\n    this.connectPromise = new Promise<void>((resolve, reject) => {\n      try {\n        const boot = this.bootPayload ?? this.bootLoader.load();\n        if (!boot || typeof boot.sid !== 'string') {\n          throw new Error('[LiveUI] missing boot payload; call load() before connecting');\n        }\n        this.bootPayload = boot;\n        this.updateState({ status: 'connecting' });\n        Logger.debug('[Runtime]', 'opening socket', { endpoint: this.options.endpoint });\n        const client = new PondClient(this.options.endpoint);\n        this.client = client;\n        const joinPayload = this.buildJoinPayload(boot);\n        Logger.debug('[Runtime]', 'joining channel', {\n          sid: boot.sid,\n          ack: joinPayload.ack,\n          version: joinPayload.ver,\n        });\n        const channel = client.createChannel<LiveUIEventMap>(`live/${boot.sid}`, joinPayload);\n        this.channel = channel;\n\n        channel.onChannelStateChange((state) => {\n          Logger.debug('[Runtime]', 'channel state changed', state);\n          if (state === ChannelState.JOINED) {\n            this.reconnectAttempts = 0;\n            this.sessionId = boot.sid;\n            this.version = boot.ver ?? 0;\n            this.updateState({ status: 'connected', sessionId: boot.sid, version: this.version });\n            this.events.emit('connected', { sid: boot.sid, version: this.version });\n            Logger.debug('[Runtime]', 'session joined', { sid: boot.sid, version: this.version });\n            resolve();\n            this.connectPromise = null;\n          }\n        });\n\n        channel.onMessage((_event, payload) => {\n          Logger.debug('[Runtime]', '\u2190 received message', payload);\n          this.routeMessage(payload as ServerMessage);\n        });\n\n        channel.onLeave(() => {\n          this.handleChannelLeave();\n        });\n\n        client.connect();\n        channel.join();\n      } catch (error) {\n        Logger.debug('[Runtime]', 'connect failed', error);\n        this.connectPromise = null;\n        this.handleErrorEvent(error as Error);\n        reject(error);\n      }\n    });\n\n    return this.connectPromise;\n  }\n\n  disconnect(): void {\n    this.clearReconnectTimer();\n    this.reconnectAttempts = 0;\n    this.connectPromise = null;\n    if (this.channel) {\n      try {\n        this.channel.leave();\n      } catch (error) {\n        Logger.debug('[Runtime]', 'channel leave error', error);\n      }\n      this.channel = null;\n    }\n    if (this.client) {\n      try {\n        this.client.disconnect();\n      } catch (error) {\n        Logger.debug('[Runtime]', 'client disconnect error', error);\n      }\n      this.client = null;\n    }\n    this.updateState({ status: 'disconnected' });\n    this.events.emit('disconnected', undefined);\n  }\n\n  destroy(): void {\n    this.disposed = true;\n    this.disconnect();\n    this.events.clear();\n  }\n\n  sendEvent(hid: string, payload: ClientEventMessage['payload'], cseq?: number): void {\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!this.channel || !sid) {\n      return;\n    }\n    const seq = this.allocateEventSeq(cseq);\n    this.pendingEvents.push({ hid, payload, seq });\n    this.drainEventQueue();\n  }\n\n  sendNavigation(path: string, q: string, hash = ''): void {\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!this.channel || !sid) {\n      return;\n    }\n    Logger.debug('[Runtime]', 'send navigation', { path, q, hash });\n\n    const url = new URL(window.location.href);\n    url.pathname = path;\n    url.search = q;\n    url.hash = hash;\n    window.history.pushState({}, '', url.toString());\n\n    const message: ClientNavMessage = {\n      t: 'nav',\n      sid,\n      path,\n      q,\n      hash,\n    };\n    Logger.debug('[Runtime]', '\u2192 sending navigation', message);\n    this.channel.sendMessage('nav', message);\n  }\n\n  sendPopNavigation(path: string, q: string, hash = ''): void {\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!this.channel || !sid) {\n      return;\n    }\n    Logger.debug('[Runtime]', 'send pop navigation', { path, q, hash });\n    const message: ClientNavMessage = {\n      t: 'pop',\n      sid,\n      path,\n      q,\n      hash,\n    };\n    Logger.debug('[Runtime]', '\u2192 sending pop navigation', message);\n    this.channel.sendMessage('pop', message);\n  }\n\n  requestRecover(): void {\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!this.channel || !sid) {\n      return;\n    }\n    Logger.debug('[Runtime]', 'request recover', { sid });\n    const payload: ClientRecoverMessage = {\n      t: 'recover',\n      sid,\n    };\n    Logger.debug('[Runtime]', '\u2192 sending recover', payload);\n    this.channel.sendMessage('recover', payload);\n  }\n\n  private buildJoinPayload(boot: BootPayload) {\n    const ack = this.lastAck || boot.seq || 0;\n    return {\n      sid: boot.sid,\n      ver: boot.ver ?? 0,\n      ack,\n      loc: {\n        path: boot.location?.path ?? '/',\n        q: boot.location?.q ?? '',\n        hash: boot.location?.hash ?? '',\n      },\n    };\n  }\n\n  private routeMessage(msg: ServerMessage): void {\n    if (!msg || typeof (msg as any).t !== 'string') {\n      return;\n    }\n    Logger.debug('[Runtime]', 'received message', { type: (msg as any)?.t });\n    this.events.emit('message', msg);\n    switch (msg.t) {\n      case 'init':\n        this.handleInit(msg as InitMessage);\n        break;\n      case 'frame':\n        this.handleFrame(msg as FrameMessage);\n        break;\n      case 'template':\n        this.events.emit('template', msg as TemplateMessage);\n        break;\n      case 'resume':\n        this.events.emit('resume', msg as ResumeMessage);\n        break;\n      case 'join':\n        this.events.emit('join', msg as JoinMessage);\n        break;\n      case 'evt-ack':\n        this.handleEventAck(msg as EventAckMessage);\n        break;\n      case 'diagnostic':\n        this.events.emit('diagnostic', msg as DiagnosticMessage);\n        break;\n      case 'error':\n        this.handleErrorMessage(msg as ErrorMessage);\n        break;\n      case 'upload':\n        this.events.emit('upload', msg as UploadControlMessage);\n        break;\n      case 'domreq':\n        this.events.emit('domreq', msg as DOMRequestMessage);\n        break;\n      default:\n        break;\n    }\n  }\n\n  private handleInit(msg: InitMessage): void {\n    const prevSid = this.sessionId;\n    this.sessionId = msg.sid;\n    if (!prevSid || prevSid !== msg.sid) {\n      this.resetEventSequencing();\n    }\n    this.version = msg.ver;\n    Logger.debug('[Runtime]', 'init received', { sid: msg.sid, version: msg.ver, seq: msg.seq });\n    if (typeof msg.seq === 'number') {\n      this.lastAck = msg.seq;\n      this.sendAck(msg.seq);\n    }\n    this.events.emit('init', msg);\n    this.markEventFrameApplied();\n  }\n\n  private handleFrame(msg: FrameMessage): void {\n    this.version = msg.ver;\n    Logger.debug('[Runtime]', 'frame received', {\n      version: msg.ver,\n      seq: msg.seq,\n      ops: Array.isArray(msg.patch) ? msg.patch.length : 0,\n    });\n    if (typeof msg.seq === 'number') {\n      this.lastAck = msg.seq;\n      this.sendAck(msg.seq);\n    }\n    this.events.emit('frame', msg);\n    this.markEventFrameApplied();\n  }\n\n  private handleErrorMessage(msg: ErrorMessage): void {\n    const error = new Error(msg.message ?? 'server error');\n    error.name = msg.code ?? 'ServerError';\n    this.handleErrorEvent(error);\n  }\n\n  private handleChannelLeave(): void {\n    Logger.debug('[Runtime]', 'channel left, cleaning up');\n    this.channel = null;\n    this.sessionId = null;\n    this.version = 0;\n    this.resetEventSequencing();\n    if (this.client) {\n      try {\n        this.client.disconnect();\n      } catch (error) {\n        Logger.debug('[Runtime]', 'client disconnect error', error);\n      }\n      this.client = null;\n    }\n    this.updateState({ status: 'disconnected' });\n    this.events.emit('disconnected', undefined);\n    if (!this.disposed && this.options.reconnect) {\n      this.scheduleReconnect();\n    }\n  }\n\n  private scheduleReconnect(): void {\n    if (this.reconnectAttempts >= this.options.maxReconnectAttempts) {\n      return;\n    }\n    if (this.reconnectTimer) {\n      return;\n    }\n    this.reconnectAttempts += 1;\n    const delay = this.options.reconnectDelay * Math.pow(2, this.reconnectAttempts - 1);\n    Logger.debug('[Runtime]', 'scheduling reconnect', {\n      attempt: this.reconnectAttempts,\n      delay,\n    });\n    this.updateState({ status: 'reconnecting', attempt: this.reconnectAttempts });\n    this.reconnectTimer = setTimeout(() => {\n      this.reconnectTimer = null;\n      void this.connect();\n    }, delay);\n  }\n\n  private clearReconnectTimer(): void {\n    if (this.reconnectTimer) {\n      clearTimeout(this.reconnectTimer);\n      this.reconnectTimer = null;\n    }\n  }\n\n  private sendAck(seq: number): void {\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!this.channel || !sid) {\n      return;\n    }\n    Logger.debug('[Runtime]', 'acknowledging frame', { seq });\n    const payload: ClientAckMessage = {\n      t: 'ack',\n      sid,\n      seq,\n    };\n    Logger.debug('[Runtime]', '\u2192 sending ack', payload);\n    this.channel.sendMessage('ack', payload);\n  }\n\n  private drainEventQueue(): void {\n    if (!this.channel) {\n      return;\n    }\n    const sid = this.sessionId ?? this.bootPayload?.sid;\n    if (!sid) {\n      return;\n    }\n    while (this.pendingEvents.length > 0 && this.inFlightEvents.length < this.maxInFlightEvents) {\n      const next = this.pendingEvents.shift();\n      if (!next) {\n        break;\n      }\n      this.transmitEvent(next, sid);\n    }\n  }\n\n  private transmitEvent(event: PendingEvent, sid: string): void {\n    if (!this.channel) {\n      return;\n    }\n    Logger.debug('[Runtime]', 'send event', { handler: event.hid, cseq: event.seq });\n    const message: ClientEventMessage = {\n      t: 'evt',\n      sid,\n      hid: event.hid,\n      payload: event.payload,\n      cseq: event.seq,\n    };\n    Logger.debug('[Runtime]', '\u2192 sending event', message);\n    this.inFlightEvents.push({ seq: event.seq, acked: false, frameApplied: false });\n    this.channel.sendMessage('evt', message);\n  }\n\n  private allocateEventSeq(forced?: number): number {\n    if (typeof forced === 'number' && forced > 0) {\n      if (forced >= this.nextEventSeq) {\n        this.nextEventSeq = forced + 1;\n      }\n      return forced;\n    }\n    const seq = this.nextEventSeq;\n    this.nextEventSeq += 1;\n    return seq;\n  }\n\n  private handleEventAck(msg: EventAckMessage): void {\n    const ack = typeof msg.cseq === 'number' ? msg.cseq : 0;\n    if (ack > this.lastEventAck) {\n      this.lastEventAck = ack;\n    }\n    if (ack >= this.nextEventSeq) {\n      this.nextEventSeq = ack + 1;\n    }\n    this.markEventAcked(ack);\n    this.events.emit('evtack', msg);\n  }\n\n  private resetEventSequencing(): void {\n    this.nextEventSeq = 1;\n    this.lastEventAck = 0;\n    this.pendingEvents.length = 0;\n    this.inFlightEvents.length = 0;\n  }\n\n  private markEventAcked(seq: number): void {\n    for (const entry of this.inFlightEvents) {\n      if (entry.seq === seq) {\n        entry.acked = true;\n        break;\n      }\n    }\n    this.releaseCompletedEvent();\n  }\n\n  private markEventFrameApplied(): void {\n    for (const entry of this.inFlightEvents) {\n      if (!entry.frameApplied) {\n        entry.frameApplied = true;\n        break;\n      }\n    }\n    this.releaseCompletedEvent();\n  }\n\n  private releaseCompletedEvent(): void {\n    let released = false;\n    while (this.inFlightEvents.length > 0 && this.inFlightEvents[0].acked && this.inFlightEvents[0].frameApplied) {\n      this.inFlightEvents.shift();\n      released = true;\n    }\n    if (released) {\n      this.drainEventQueue();\n    }\n  }\n\n  private handleErrorEvent(error: Error): void {\n    Logger.warn('[Runtime]', 'runtime error', error);\n    this.events.emit('error', { error });\n    this.updateState({ status: 'error', error });\n  }\n\n  private updateState(next: ConnectionState): void {\n    this.state = next;\n    this.events.emit('state', next);\n  }\n\n}\n", "export interface LoggerOptions {\n  debug?: boolean;\n}\n\nexport class Logger {\n  private static debugEnabled = false;\n\n  static configure(options?: LoggerOptions): void {\n    Logger.debugEnabled = Boolean(options?.debug);\n  }\n\n  static debug(...args: unknown[]): void {\n    if (!Logger.debugEnabled) {\n      return;\n    }\n    Logger.emit('log', 'debug', args);\n  }\n\n  static info(...args: unknown[]): void {\n    Logger.emit('log', 'info', args);\n  }\n\n  static warn(...args: unknown[]): void {\n    Logger.emit('warn', 'warn', args);\n  }\n\n  static error(...args: unknown[]): void {\n    Logger.emit('error', 'error', args);\n  }\n\n  private static emit(method: 'log' | 'warn' | 'error', level: string, args: unknown[]): void {\n    if (typeof console === 'undefined') {\n      return;\n    }\n    const emitter = (console[method] as (...data: unknown[]) => void) ?? console.log;\n    emitter(`[LiveUI][${level}]`, ...args);\n  }\n}\n", "import type {BootPayload} from './types';\nimport {Logger} from './logger';\n\nexport type BootSource = BootPayload | null | undefined;\n\nexport interface BootLoaderOptions {\n  debug?: boolean;\n  scriptId?: string;\n}\n\nexport class BootLoader {\n  private payload: BootPayload | null = null;\n  private readonly options: Required<BootLoaderOptions>;\n\n  constructor(options?: BootLoaderOptions) {\n    this.options = {\n      debug: options?.debug ?? false,\n      scriptId: options?.scriptId ?? 'live-boot',\n    };\n  }\n\n  load(explicit?: BootSource): BootPayload | null {\n    const candidate = explicit ?? this.readWindowPayload() ?? this.readScriptPayload();\n    if (candidate && typeof candidate.sid === 'string') {\n      this.payload = candidate;\n      this.cacheToWindow(candidate);\n      if (this.options.debug) {\n        Logger.debug('[boot]', 'payload loaded', {\n          sid: candidate.sid,\n          version: candidate.ver,\n          hasHtml: Boolean(candidate.html),\n        });\n      }\n      return this.payload;\n    }\n    if (this.options.debug) {\n      this.log('boot payload unavailable');\n    }\n    return this.payload;\n  }\n\n  get(): BootPayload | null {\n    return this.payload;\n  }\n\n  ensure(): BootPayload {\n    const boot = this.payload ?? this.load();\n    if (!boot || typeof boot.sid !== 'string') {\n      throw new Error('[LiveUI] boot payload is required before connecting');\n    }\n    return boot;\n  }\n\n  private readWindowPayload(): BootPayload | null {\n    if (typeof window === 'undefined') {\n      return null;\n    }\n    const globalAny = window as typeof window & { __LIVEUI_BOOT__?: BootPayload };\n    const payload = globalAny.__LIVEUI_BOOT__;\n    if (payload && typeof payload.sid === 'string') {\n      return payload;\n    }\n    return null;\n  }\n\n  private readScriptPayload(): BootPayload | null {\n    if (typeof document === 'undefined') {\n      return null;\n    }\n    const script = document.getElementById(this.options.scriptId);\n    const content = script?.textContent;\n    if (!content) {\n      return null;\n    }\n    try {\n        return JSON.parse(content) as BootPayload;\n    } catch (error) {\n      this.log('failed to parse boot payload', error);\n      return null;\n    }\n  }\n\n  private cacheToWindow(payload: BootPayload): void {\n    if (typeof window === 'undefined') {\n      return;\n    }\n    const globalAny = window as typeof window & { __LIVEUI_BOOT__?: BootPayload };\n    globalAny.__LIVEUI_BOOT__ = payload;\n  }\n\n  private log(message: string, error?: unknown): void {\n    if (!this.options.debug) {\n      return;\n    }\n    if (error) {\n      Logger.warn('[boot]', message, error);\n    } else {\n      Logger.warn('[boot]', message);\n    }\n  }\n}\n", "import {Logger} from './logger';\n\nexport type EventMap = Record<string, any>;\n\nexport type Listener<T> = (payload: T) => void;\n\nexport class TypedEventEmitter<Events extends EventMap> {\n  private listeners: Map<keyof Events, Set<Listener<any>>> = new Map();\n\n  on<K extends keyof Events>(event: K, listener: Listener<Events[K]>): () => void {\n    const bucket = this.listeners.get(event) ?? new Set();\n    bucket.add(listener as Listener<any>);\n    this.listeners.set(event, bucket);\n    return () => this.off(event, listener);\n  }\n\n  once<K extends keyof Events>(event: K, listener: Listener<Events[K]>): () => void {\n    const unsubscribe = this.on(event, (payload) => {\n      unsubscribe();\n      listener(payload);\n    });\n    return unsubscribe;\n  }\n\n  off<K extends keyof Events>(event: K, listener: Listener<Events[K]>): void {\n    const bucket = this.listeners.get(event);\n    if (!bucket) {\n      return;\n    }\n    bucket.delete(listener as Listener<any>);\n    if (bucket.size === 0) {\n      this.listeners.delete(event);\n    }\n  }\n\n  emit<K extends keyof Events>(event: K, payload: Events[K]): void {\n    const bucket = this.listeners.get(event);\n    if (!bucket) {\n      return;\n    }\n    for (const listener of Array.from(bucket)) {\n      try {\n        (listener as Listener<Events[K]>)(payload);\n      } catch (error) {\n        Logger.error('event listener error', event, error);\n      }\n    }\n  }\n\n  clear(): void {\n    this.listeners.clear();\n  }\n}\n", "import type {\n  SlotPathDescriptor,\n  ListPathDescriptor,\n  ComponentPathDescriptor,\n  PathSegmentDescriptor,\n} from './types';\nimport { Logger } from './logger';\n\nexport interface ComponentRange {\n  container: ParentNode;\n  startIndex: number;\n  endIndex: number;\n}\n\nconst componentRanges = new Map<string, ComponentRange>();\n\nexport function registerComponentRanges(ranges: Map<string, ComponentRange>): void {\n  ranges.forEach((range, id) => {\n    if (id) {\n      componentRanges.set(id, range);\n    }\n  });\n  // DEBUG: Log all registered component ranges\n  const rangeData = Array.from(componentRanges.entries()).map(([id, range]) => ({\n    id: id.substring(0, 12) + '...',\n    container: range.container.nodeName,\n    start: range.startIndex,\n    end: range.endIndex,\n    childCount: range.container.childNodes.length,\n  }));\n  Logger.debug('[Manifest]', 'registered component ranges', { count: componentRanges.size, ranges: rangeData });\n}\n\nexport function getComponentRange(id: string): ComponentRange | undefined {\n  return componentRanges.get(id);\n}\n\n// DEBUG: Expose component ranges for debugging\nif (typeof window !== 'undefined') {\n  (window as any).__DEBUG_COMPONENT_RANGES__ = componentRanges;\n}\n\nexport function resolveSlotAnchors(\n  descriptors: SlotPathDescriptor[] | undefined,\n  overrides?: Map<string, ComponentRange>,\n): Map<number, Node> {\n  const anchors = new Map<number, Node>();\n  if (!Array.isArray(descriptors)) {\n    return anchors;\n  }\n  for (const descriptor of descriptors) {\n    if (!descriptor) continue;\n    const slotId = Number(descriptor.slot);\n    if (!Number.isInteger(slotId) || slotId < 0 || anchors.has(slotId)) {\n      continue;\n    }\n    const range = overrides?.get(descriptor.componentId) ?? getComponentRange(descriptor.componentId);\n    if (!range) {\n      continue;\n    }\n    const anchor = resolveNodeBySegments(range, descriptor.path);\n    if (!anchor) {\n      continue;\n    }\n    let target: Node | null = anchor;\n    const textIndex = Number(descriptor.textChildIndex);\n    if (Number.isInteger(textIndex) && textIndex >= 0) {\n      if (anchor instanceof Text) {\n        target = anchor;\n      } else if (anchor instanceof Element || anchor instanceof DocumentFragment) {\n        const existing = anchor.childNodes.item(textIndex);\n        if (existing) {\n          target = existing;\n        } else if (typeof document !== 'undefined') {\n          const textNode = document.createTextNode('');\n          const before = anchor.childNodes.item(textIndex) ?? null;\n          anchor.insertBefore(textNode, before);\n          target = textNode;\n        }\n      } else {\n        target = null;\n      }\n    }\n    if (!target) {\n      continue;\n    }\n    anchors.set(slotId, target);\n  }\n  return anchors;\n}\n\nexport function resolveListContainers(\n  descriptors: ListPathDescriptor[] | undefined,\n  overrides?: Map<string, ComponentRange>,\n): Map<number, Element> {\n  const containers = new Map<number, Element>();\n  Logger.debug('[Manifest]', 'resolveListContainers START', {\n    descriptorsIsArray: Array.isArray(descriptors),\n    descriptorsLength: Array.isArray(descriptors) ? descriptors.length : 'N/A',\n    hasOverrides: Boolean(overrides),\n  });\n  if (!Array.isArray(descriptors)) {\n    Logger.debug('[Manifest]', 'resolveListContainers: descriptors not an array, returning empty');\n    return containers;\n  }\n  for (let i = 0; i < descriptors.length; i++) {\n    const descriptor = descriptors[i];\n    Logger.debug('[Manifest]', `resolveListContainers: processing descriptor[${i}]`, {\n      descriptor,\n      hasDescriptor: Boolean(descriptor),\n    });\n    if (!descriptor) continue;\n    const slotId = Number(descriptor.slot);\n    if (!Number.isInteger(slotId) || slotId < 0 || containers.has(slotId)) {\n      Logger.debug('[Manifest]', `resolveListContainers: skipping descriptor[${i}] - invalid slot`, {\n        slotId,\n        isInteger: Number.isInteger(slotId),\n        alreadyHas: containers.has(slotId),\n      });\n      continue;\n    }\n    const range = overrides?.get(descriptor.componentId) ?? getComponentRange(descriptor.componentId);\n    if (!range) {\n      Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - NO RANGE FOUND`, {\n        componentId: descriptor.componentId,\n        hasOverride: Boolean(overrides?.get(descriptor.componentId)),\n        hasComponentRange: Boolean(getComponentRange(descriptor.componentId)),\n      });\n      continue;\n    }\n    Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - found range`, {\n      componentId: descriptor.componentId,\n      range,\n      atRoot: descriptor.atRoot,\n    });\n    if (descriptor.atRoot) {\n      const element = resolveRangeContainerElement(range);\n      if (element) {\n        Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - resolved atRoot element`, {\n          slotId,\n          elementNodeName: element.nodeName,\n        });\n        containers.set(slotId, element);\n      } else {\n        Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - atRoot but no container element`);\n      }\n      continue;\n    }\n    const node = resolveNodeBySegments(range, descriptor.path);\n    Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - resolved node by segments`, {\n      nodeType: node?.nodeName,\n      isElement: node instanceof Element,\n    });\n    if (!(node instanceof Element)) {\n      Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - node not an Element, skipping`);\n      continue;\n    }\n    containers.set(slotId, node);\n    Logger.debug('[Manifest]', `resolveListContainers: descriptor[${i}] - SUCCESS`, {\n      slotId,\n      elementNodeName: node.nodeName,\n    });\n  }\n  Logger.debug('[Manifest]', 'resolveListContainers END', { containerCount: containers.size });\n  return containers;\n}\n\nexport function applyComponentRanges(\n  descriptors: ComponentPathDescriptor[] | undefined,\n  options?: { root?: ParentNode | null },\n): Map<string, ComponentRange> {\n  const ranges = computeComponentRanges(descriptors, options);\n  registerComponentRanges(ranges);\n  return ranges;\n}\n\nfunction computeComponentRanges(\n  descriptors: ComponentPathDescriptor[] | undefined,\n  options?: { root?: ParentNode | null },\n): Map<string, ComponentRange> {\n  const ranges = new Map<string, ComponentRange>();\n  if (!Array.isArray(descriptors)) {\n    return ranges;\n  }\n  const root = options?.root ?? document.body ?? document;\n  const baseRange: ComponentRange | null = root\n    ? { container: root, startIndex: 0, endIndex: root.childNodes.length - 1 }\n    : null;\n  const pending = new Map<string, ComponentPathDescriptor>();\n  descriptors.forEach((descriptor) => {\n    if (descriptor && typeof descriptor.componentId === 'string') {\n      pending.set(descriptor.componentId, descriptor);\n    }\n  });\n  let progressed = true;\n  while (pending.size > 0 && progressed) {\n    progressed = false;\n    for (const [id, descriptor] of Array.from(pending.entries())) {\n      const parentRange = descriptor.parentId ? ranges.get(descriptor.parentId) : baseRange;\n      if (!parentRange) {\n        continue;\n      }\n      Logger.debug('[Manifest]', 'computing component range', {\n        id,\n        parentId: descriptor.parentId,\n        parentPath: descriptor.parentPath,\n        firstChild: descriptor.firstChild,\n        lastChild: descriptor.lastChild,\n        parentRangeContainer: parentRange.container.nodeName,\n        parentRangeStart: parentRange.startIndex,\n        parentRangeEnd: parentRange.endIndex,\n      });\n      const firstNode = resolveNodeForComponent(parentRange, descriptor.parentPath, descriptor.firstChild);\n      const lastNode = resolveNodeForComponent(parentRange, descriptor.parentPath, descriptor.lastChild);\n      Logger.debug('[Manifest]', 'resolved boundary nodes', {\n        id,\n        firstNode: firstNode?.nodeName,\n        lastNode: lastNode?.nodeName,\n      });\n      const container = chooseComponentContainer(firstNode, lastNode, parentRange.container);\n      const topLevelFirst = ascendToContainer(firstNode, container) ?? firstNode;\n      const topLevelLast = ascendToContainer(lastNode, container) ?? lastNode ?? topLevelFirst;\n      let startIndex = topLevelFirst ? getNodeIndex(container, topLevelFirst) : parentRange.startIndex;\n      if (startIndex < 0) {\n        startIndex = parentRange.startIndex;\n      }\n      let endIndex = topLevelLast ? getNodeIndex(container, topLevelLast) : startIndex;\n      if (endIndex < startIndex) {\n        endIndex = startIndex;\n      }\n      Logger.debug('[Manifest]', 'computed component range', {\n        id,\n        container: container.nodeName,\n        startIndex,\n        endIndex,\n      });\n      ranges.set(id, { container, startIndex, endIndex });\n      pending.delete(id);\n      progressed = true;\n    }\n  }\n  return ranges;\n}\n\nexport function resolveNodeInComponent(\n  componentId: string,\n  path?: PathSegmentDescriptor[] | null,\n  overrides?: Map<string, ComponentRange>,\n): Node | null {\n  const range = overrides?.get(componentId) ?? getComponentRange(componentId);\n  if (!range) {\n    return null;\n  }\n  return resolveNodeBySegments(range, path);\n}\n\nfunction resolveNodeBySegments(\n  range: ComponentRange,\n  segments?: PathSegmentDescriptor[] | null,\n): Node | null {\n  if (!range || range.endIndex < range.startIndex) {\n    Logger.debug('[Manifest]', 'resolveNodeBySegments: invalid range', { range });\n    return null;\n  }\n  const container = range.container;\n  if (!container) {\n    Logger.debug('[Manifest]', 'resolveNodeBySegments: no container', { range });\n    return null;\n  }\n  Logger.debug('[Manifest]', 'resolveNodeBySegments START', {\n    segments,\n    rangeInfo: {\n      containerNodeName: container.nodeName,\n      startIndex: range.startIndex,\n      endIndex: range.endIndex,\n      childCount: container.childNodes.length,\n    },\n  });\n  if (!Array.isArray(segments) || segments.length === 0) {\n    const root = resolveRangeRoot(range);\n    Logger.debug('[Manifest]', 'resolveNodeBySegments: using range root', { result: root?.nodeName });\n    return root;\n  }\n  let current: Node | null = null;\n  let activeRange: ComponentRange = range;\n\n  for (let i = 0; i < segments.length; i++) {\n    const segment = segments[i];\n    if (!segment) {\n      continue;\n    }\n    if (segment.kind === 'range') {\n      current = resolveRangeChild(activeRange, segment.index);\n      Logger.debug('[Manifest]', 'resolveNodeBySegments: range segment', {\n        step: i,\n        offset: segment.index,\n        node: current?.nodeName,\n      });\n      if (!current) {\n        return null;\n      }\n      // After resolving a range segment, if current is an Element/Fragment,\n      // create a new range context for potential subsequent segments\n      if (current instanceof Element || current instanceof DocumentFragment) {\n        activeRange = {\n          container: current,\n          startIndex: 0,\n          endIndex: current.childNodes.length - 1,\n        };\n      } else if (i < segments.length - 1) {\n        // If we resolved to a non-Element/Fragment and there are more segments,\n        // fail now since we can't navigate further from text nodes, etc.\n        Logger.debug('[Manifest]', 'resolveNodeBySegments: range resolved to non-Element with remaining segments', {\n          step: i,\n          current: current?.nodeName,\n          remainingSegments: segments.length - 1 - i,\n        });\n        return null;\n      }\n      continue;\n    }\n    if (!current) {\n      current = resolveRangeChild(activeRange, segment.index);\n      Logger.debug('[Manifest]', 'resolveNodeBySegments: selecting top-level child', {\n        step: i,\n        offset: segment.index,\n        node: current?.nodeName,\n      });\n      if (!current) {\n        return null;\n      }\n      continue;\n    }\n    if (!(current instanceof Element || current instanceof DocumentFragment)) {\n      Logger.debug('[Manifest]', 'resolveNodeBySegments: current not Element/Fragment', {\n        step: i,\n        current: current?.nodeName,\n      });\n      return null;\n    }\n    const clamped = clampIndex(current, segment.index);\n    const next: Node | null = current.childNodes.item(clamped) ?? null;\n    Logger.debug('[Manifest]', 'resolveNodeBySegments: navigating dom segment', {\n      step: i,\n      index: segment.index,\n      clamped,\n      currentNodeName: current.nodeName,\n      nextNodeName: next?.nodeName,\n    });\n    current = next;\n    if (!current) {\n      return null;\n    }\n  }\n  Logger.debug('[Manifest]', 'resolveNodeBySegments END', { result: current?.nodeName });\n  return current ?? resolveRangeRoot(range);\n}\n\nfunction resolveNodeForComponent(\n  range: ComponentRange,\n  parentPath?: PathSegmentDescriptor[] | null,\n  childPath?: PathSegmentDescriptor[] | null,\n): Node | null {\n  const combined = combineSegments(parentPath, childPath);\n  if (combined) {\n    return resolveNodeBySegments(range, combined);\n  }\n  return resolveNodeBySegments(range, parentPath) ?? resolveNodeBySegments(range, childPath);\n}\n\nfunction combineSegments(\n  base?: PathSegmentDescriptor[] | null,\n  extra?: PathSegmentDescriptor[] | null,\n): PathSegmentDescriptor[] | undefined {\n  const result: PathSegmentDescriptor[] = [];\n  if (Array.isArray(base) && base.length > 0) {\n    result.push(...base);\n  }\n  if (Array.isArray(extra) && extra.length > 0) {\n    result.push(...extra);\n  }\n  return result.length > 0 ? result : undefined;\n}\n\nfunction chooseComponentContainer(\n  firstNode: Node | null,\n  lastNode: Node | null,\n  fallback: ParentNode | null,\n): ParentNode {\n  const firstAncestors = collectAncestorParents(firstNode);\n  if (!lastNode) {\n    return firstAncestors[0] ?? (fallback as ParentNode);\n  }\n  const lastAncestors = collectAncestorParents(lastNode);\n  for (const ancestor of firstAncestors) {\n    if (lastAncestors.includes(ancestor)) {\n      return ancestor;\n    }\n  }\n  return firstAncestors[0] ?? lastAncestors[0] ?? (fallback as ParentNode);\n}\n\nfunction collectAncestorParents(node: Node | null): ParentNode[] {\n  const parents: ParentNode[] = [];\n  let current: Node | null = node;\n  while (current && current.parentNode) {\n    const parent = current.parentNode;\n    parents.push(parent);\n    current = parent;\n  }\n  return parents;\n}\n\nfunction ascendToContainer(node: Node | null, container: ParentNode | null): Node | null {\n  if (!node || !container) {\n    return node;\n  }\n  let current: Node | null = node;\n  while (current && current.parentNode && current.parentNode !== container) {\n    current = current.parentNode;\n  }\n  return current;\n}\n\nfunction clampIndex(container: ParentNode, index: number): number {\n  const max = container.childNodes.length - 1;\n  if (max < 0) {\n    return 0;\n  }\n  if (index < 0) {\n    return 0;\n  }\n  if (index > max) {\n    return max;\n  }\n  return index;\n}\n\nfunction getNodeIndex(container: ParentNode, node: Node | null): number {\n  if (!container || !node) {\n    return -1;\n  }\n  const nodes = container.childNodes;\n  for (let i = 0; i < nodes.length; i++) {\n    if (nodes.item(i) === node) {\n      return i;\n    }\n  }\n  return -1;\n}\n\nfunction resolveRangeRoot(range: ComponentRange): Node | null {\n  return resolveRangeChild(range, 0);\n}\n\nfunction resolveRangeChild(range: ComponentRange, offset: number): Node | null {\n  const container = range.container;\n  if (!container || container.childNodes.length === 0) {\n    return null;\n  }\n  const start = clampIndex(container, range.startIndex);\n  const end = Math.max(start, clampIndex(container, range.endIndex));\n  const span = end - start;\n  const normalizedOffset = Number.isFinite(offset) ? offset : 0;\n  const clampedOffset = normalizedOffset <= 0 ? 0 : normalizedOffset >= span ? span : normalizedOffset;\n  const index = start + clampedOffset;\n  return container.childNodes.item(index) ?? null;\n}\n\nfunction resolveRangeContainerElement(range: ComponentRange): Element | null {\n  const container = range.container;\n  if (container instanceof Element) {\n    return container;\n  }\n  if (container instanceof Document) {\n    return container.body ?? container.documentElement ?? null;\n  }\n  if (container instanceof DocumentFragment) {\n    const first = container.firstElementChild;\n    return first ?? null;\n  }\n  return null;\n}\n", "import type {\n  SlotMeta,\n  SlotPathDescriptor,\n  ListPathDescriptor,\n  ComponentPathDescriptor,\n} from './types';\nimport { resolveSlotAnchors, resolveListContainers, applyComponentRanges, ComponentRange } from './manifest';\nimport { Logger } from './logger';\n\ntype RowRecord = { nodes: Node[] };\ntype RowPrimeInfo = { key: string; count: number };\n\nexport class DomRegistry {\n  private slots = new Map<number, Node>();\n  private lists = new Map<\n    number,\n    { container: Element; rows: Map<string, RowRecord>; order: string[] }\n  >();\n\n  reset(): void {\n    this.slots.clear();\n    this.lists.clear();\n    Logger.debug('[DomRegistry]', 'reset');\n  }\n\n  prime(componentPaths?: ComponentPathDescriptor[], options?: { root?: ParentNode | null }) {\n    return applyComponentRanges(componentPaths, options);\n  }\n\n  registerSlotAnchors(descriptors?: SlotPathDescriptor[], overrides?: Map<string, ComponentRange>): void {\n    const anchors = resolveSlotAnchors(descriptors, overrides);\n    anchors.forEach((node, id) => this.slots.set(id, node));\n    Logger.debug('[DomRegistry]', 'registered slot anchors', { count: anchors.size });\n  }\n\n  registerListContainers(\n    descriptors?: ListPathDescriptor[],\n    overrides?: Map<string, ComponentRange>,\n    rowMeta?: Map<number, RowPrimeInfo[]>,\n  ): void {\n    const containers = resolveListContainers(descriptors, overrides);\n    containers.forEach((element, id) => {\n      const info = rowMeta?.get(id);\n      const { rows, order } = collectRows(element, info);\n      this.lists.set(id, { container: element, rows, order });\n    });\n    Logger.debug('[DomRegistry]', 'registered list containers', { count: containers.size });\n  }\n\n  registerSlots(slotDescriptors: SlotMeta[]): void {\n    if (!Array.isArray(slotDescriptors)) {\n      return;\n    }\n    slotDescriptors.forEach((slot) => {\n      if (slot && typeof slot.anchorId === 'number' && !this.slots.has(slot.anchorId)) {\n        const placeholder = typeof document !== 'undefined' ? document.createTextNode('') : null;\n        if (placeholder) {\n          this.slots.set(slot.anchorId, placeholder);\n        }\n      }\n    });\n    Logger.debug('[DomRegistry]', 'registered additional slots', { total: this.slots.size });\n  }\n\n  getSlot(id: number): Node | undefined {\n    return this.slots.get(id);\n  }\n\n  registerLists(\n    listDescriptors?: ListPathDescriptor[],\n    overrides?: Map<string, ComponentRange>,\n    rowMeta?: Map<number, RowPrimeInfo[]>,\n  ): void {\n    this.registerListContainers(listDescriptors, overrides, rowMeta);\n  }\n\n  getList(id: number): Element | undefined {\n    return this.lists.get(id)?.container;\n  }\n\n  getRow(slotId: number, key: string): RowRecord | undefined {\n    return this.lists.get(slotId)?.rows.get(key);\n  }\n\n  insertRow(slotId: number, key: string, nodes: Node[], index: number): void {\n    if (!key || nodes.length === 0) {\n      return;\n    }\n    const list = this.lists.get(slotId);\n    if (!list) {\n      return;\n    }\n    list.rows.set(key, { nodes: [...nodes] });\n    const clamped = clampIndex(list.order.length, index);\n    list.order.splice(clamped, 0, key);\n    Logger.debug('[DomRegistry]', 'inserted row', { slotId, key, index: clamped });\n  }\n\n  deleteRow(slotId: number, key: string): void {\n    const list = this.lists.get(slotId);\n    if (!list) {\n      return;\n    }\n    list.rows.delete(key);\n    const idx = list.order.indexOf(key);\n    if (idx >= 0) {\n      list.order.splice(idx, 1);\n    }\n    Logger.debug('[DomRegistry]', 'deleted row', { slotId, key });\n  }\n\n  moveRow(slotId: number, key: string, toIndex: number): void {\n    const list = this.lists.get(slotId);\n    if (!list) {\n      return;\n    }\n    const current = list.order.indexOf(key);\n    if (current === -1) {\n      return;\n    }\n    list.order.splice(current, 1);\n    const clamped = clampIndex(list.order.length, toIndex);\n    list.order.splice(clamped, 0, key);\n    Logger.debug('[DomRegistry]', 'moved row', { slotId, key, to: clamped });\n  }\n\n  getRowKeyAt(slotId: number, index: number): string | undefined {\n    const list = this.lists.get(slotId);\n    if (!list) {\n      return undefined;\n    }\n    const order = list.order ?? [];\n    if (index < 0 || index >= order.length) {\n      return undefined;\n    }\n    return order[index];\n  }\n\n  getRowFirstNode(slotId: number, key: string): Node | undefined {\n    const record = this.getRow(slotId, key);\n    return record?.nodes[0];\n  }\n}\n\nfunction collectRows(\n  container: Element | null,\n  meta?: RowPrimeInfo[],\n): { rows: Map<string, RowRecord>; order: string[] } {\n  const rows = new Map<string, RowRecord>();\n  const order: string[] = [];\n  if (!container || !Array.isArray(meta) || meta.length === 0) {\n    return { rows, order };\n  }\n  const nodes = Array.from(container.childNodes);\n  let cursor = 0;\n  for (const info of meta) {\n    if (!info || !info.key) {\n      continue;\n    }\n    const count = Math.max(1, Number(info.count) || 1);\n    const span: Node[] = [];\n    for (let i = 0; i < count && cursor < nodes.length; i += 1, cursor += 1) {\n      const node = nodes[cursor];\n      if (node) {\n        span.push(node);\n      }\n    }\n    if (span.length === 0) {\n      continue;\n    }\n    rows.set(info.key, { nodes: span });\n    order.push(info.key);\n  }\n  return { rows, order };\n}\n\nfunction clampIndex(length: number, index: number): number {\n  if (!Number.isFinite(index) || index < 0) {\n    return 0;\n  }\n  if (index > length) {\n    return length;\n  }\n  return index;\n}\n", "import type { RefBindingDescriptor, RefDelta, RefMeta } from './types';\nimport type { ComponentRange } from './manifest';\nimport { resolveNodeInComponent } from './manifest';\nimport { Logger } from './logger';\n\ninterface RefListeners {\n  element: Element;\n  listeners: Map<string, EventListener>;\n}\n\nexport class RefRegistry {\n  private meta = new Map<string, RefMeta>();\n  private bindings = new Map<string, RefListeners>();\n\n  constructor() {}\n\n  clear(): void {\n    Array.from(this.bindings.keys()).forEach((id) => this.detach(id));\n    this.meta.clear();\n    Logger.debug('[Refs]', 'cleared all bindings');\n  }\n\n  apply(delta?: RefDelta | null): void {\n    if (!delta) {\n      return;\n    }\n    if (Array.isArray(delta.del)) {\n      for (const id of delta.del) {\n        this.detach(id);\n        this.meta.delete(id);\n      }\n    }\n    if (delta.add) {\n      for (const [id, meta] of Object.entries(delta.add)) {\n        if (id) {\n          this.meta.set(id, meta);\n        }\n      }\n    }\n    Logger.debug('[Refs]', 'applied ref delta', {\n      added: delta.add ? Object.keys(delta.add).length : 0,\n      removed: delta.del?.length ?? 0,\n    });\n  }\n\n  registerBindings(descriptors?: RefBindingDescriptor[] | null, overrides?: Map<string, ComponentRange>): void {\n    if (!Array.isArray(descriptors)) {\n      return;\n    }\n    Logger.debug('[Refs]', 'registering ref bindings', { count: descriptors.length });\n    descriptors.forEach((descriptor, index) => {\n      if (!descriptor || typeof descriptor.refId !== 'string' || descriptor.refId.length === 0) {\n        return;\n      }\n      Logger.debug('[Refs]', 'processing ref binding', {\n        index,\n        descriptor: {\n          componentId: descriptor.componentId,\n          path: descriptor.path,\n          refId: descriptor.refId,\n        },\n        hasRefId: !!descriptor.refId,\n        refIdLength: descriptor.refId?.length ?? 0,\n      });\n      Logger.debug('[Refs]', 'resolving node for ref', {\n        refId: descriptor.refId,\n        componentId: descriptor.componentId,\n        path: descriptor.path,\n      });\n      const node = resolveNodeInComponent(descriptor.componentId, descriptor.path, overrides);\n      Logger.debug('[Refs]', 'node resolved', {\n        refId: descriptor.refId,\n        node,\n        isElement: node instanceof Element,\n        nodeType: node?.nodeType,\n        nodeName: node?.nodeName,\n      });\n      if (node instanceof Element) {\n        Logger.debug('[Refs]', 'attaching ref', { refId: descriptor.refId, node });\n        this.attach(descriptor.refId, node);\n      } else {\n        Logger.debug('[Refs]', 'node is not Element, detaching', { refId: descriptor.refId, node });\n        this.detach(descriptor.refId);\n      }\n    });\n  }\n\n  get(id: string): Element | undefined {\n    return this.bindings.get(id)?.element;\n  }\n\n  private attach(refId: string, element: Element): void {\n    const meta = this.meta.get(refId);\n    if (!meta) {\n      return;\n    }\n    const existing = this.bindings.get(refId);\n    if (existing && existing.element === element) {\n      return;\n    }\n    this.detach(refId);\n    const listeners = new Map<string, EventListener>();\n    this.bindings.set(refId, { element, listeners });\n    Logger.debug('[Refs]', 'attached ref', {\n      refId,\n      tag: element.tagName,\n    });\n  }\n\n  private detach(refId: string): void {\n    const binding = this.bindings.get(refId);\n    if (!binding) {\n      return;\n    }\n    binding.listeners.forEach((listener, event) => {\n      binding.element.removeEventListener(event, listener);\n    });\n    this.bindings.delete(refId);\n    Logger.debug('[Refs]', 'detached ref', { refId });\n  }\n}\n", "import type { SlotBinding, BindingTable } from './types';\nimport { Logger } from './logger';\n\nconst slotTable = new Map<number, SlotBinding[]>();\nconst eventSlots = new Map<string, Set<number>>();\nconst eventObservers = new Set<(event: string) => void>();\n\nexport function registerSlotTable(table?: BindingTable | null): void {\n  slotTable.clear();\n  eventSlots.clear();\n  if (!table) {\n    Logger.debug('[Events]', 'cleared slot table');\n    return;\n  }\n  for (const [key, value] of Object.entries(table)) {\n    const slotId = Number(key);\n    if (Number.isNaN(slotId)) {\n      continue;\n    }\n    const bindings = cloneBindings(value);\n    slotTable.set(slotId, bindings);\n    addEventIndex(slotId, bindings);\n  }\n  Logger.debug('[Events]', 'registered slot table', { slots: slotTable.size });\n}\n\nexport function registerBindingsForSlot(slotId: number, specs: SlotBinding[] | null | undefined): void {\n  if (!Number.isFinite(slotId)) {\n    return;\n  }\n  slotTable.delete(slotId);\n  eventSlots.forEach((set) => set.delete(slotId));\n  if (!Array.isArray(specs)) {\n    return;\n  }\n  const bindings = cloneBindings(specs);\n  slotTable.set(slotId, bindings);\n  addEventIndex(slotId, bindings);\n  Logger.debug('[Events]', 'registered slot bindings', { slotId, count: bindings.length });\n}\n\nexport function getSlotBindings(slotId: number): SlotBinding[] | undefined {\n  const bindings = slotTable.get(slotId);\n  return bindings ? cloneBindings(bindings) : undefined;\n}\n\nexport function forEachSlotBinding(callback: (slotId: number, bindings: SlotBinding[]) => void): void {\n  slotTable.forEach((bindings, slotId) => {\n    callback(slotId, cloneBindings(bindings));\n  });\n}\n\nexport function getSlotsForEvent(event: string): number[] {\n  const set = eventSlots.get(event);\n  return set ? Array.from(set) : [];\n}\n\nexport function getRegisteredSlotEvents(): string[] {\n  return Array.from(eventSlots.keys());\n}\n\nexport function observeSlotEvents(observer: (event: string) => void): () => void {\n  eventObservers.add(observer);\n  return () => eventObservers.delete(observer);\n}\n\nfunction addEventIndex(slotId: number, bindings: SlotBinding[]): void {\n  bindings.forEach((binding) => {\n    const event = binding.event;\n    if (!event) {\n      return;\n    }\n    const set = eventSlots.get(event) ?? new Set<number>();\n    const hadEvent = set.size > 0;\n    set.add(slotId);\n    eventSlots.set(event, set);\n    if (!hadEvent && set.size === 1) {\n      notifyObservers([event]);\n    }\n    Logger.debug('[Events]', 'indexed event', { event, slotId, totalSlots: set.size });\n  });\n}\n\nfunction notifyObservers(events: string[]): void {\n  if (!Array.isArray(events)) {\n    return;\n  }\n  events.forEach((event) => {\n    if (!event) {\n      return;\n    }\n    eventObservers.forEach((observer) => {\n      try {\n        observer(event);\n      } catch {\n        /* ignore */\n      }\n    });\n  });\n}\n\nfunction cloneBindings(specs: SlotBinding[] | undefined): SlotBinding[] {\n  if (!Array.isArray(specs)) {\n    return [];\n  }\n  return specs.map((spec) => ({\n    event: spec?.event ?? '',\n    handler: spec?.handler ?? '',\n    listen: Array.isArray(spec?.listen) ? [...spec.listen] : undefined,\n    props: Array.isArray(spec?.props) ? [...spec.props] : undefined,\n  }));\n}\n", "import type { RouterBindingDescriptor } from './types';\nimport type { ComponentRange } from './manifest';\nimport { resolveNodeInComponent, getComponentRange } from './manifest';\nimport { Logger } from './logger';\n\nexport type RouterMeta = {\n  path?: string;\n  query?: string;\n  hash?: string;\n  replace?: string;\n};\n\nconst routerMeta = new WeakMap<Element, RouterMeta>();\n\nexport function applyRouterBindings(\n  descriptors?: RouterBindingDescriptor[] | null,\n  overrides?: Map<string, ComponentRange>,\n): void {\n  if (!Array.isArray(descriptors)) {\n    return;\n  }\n  let applied = 0;\n  descriptors.forEach((descriptor, index) => {\n    Logger.debug('[Router]', `processing binding ${index}`, {\n      componentId: descriptor?.componentId?.substring(0, 12) + '...',\n      pathLength: descriptor?.path?.length,\n      pathValue: descriptor?.pathValue,\n    });\n    if (!descriptor || typeof descriptor.componentId !== 'string') {\n      Logger.debug('[Router]', `skipping binding ${index}: invalid descriptor`);\n      return;\n    }\n    const range = overrides?.get(descriptor.componentId) ?? getComponentRange(descriptor.componentId);\n    if (range) {\n      Logger.debug('[Router]', `component range for binding ${index}`, {\n        container: range.container.nodeName,\n        start: range.startIndex,\n        end: range.endIndex,\n        childCount: range.container.childNodes.length,\n      });\n    } else {\n      Logger.debug('[Router]', `no component range found for binding ${index}`);\n    }\n    let node = resolveNodeInComponent(descriptor.componentId, descriptor.path, overrides);\n    Logger.debug('[Router]', `resolved node for binding ${index}`, {\n      nodeType: node?.nodeName,\n      isElement: node instanceof Element,\n    });\n\n    // If path resolution failed but the component range container is an Element,\n    // use the container itself. This handles cases where the component's root\n    // element IS the element we want to bind to (e.g., RouterLink's <a> tag).\n    if (!(node instanceof Element) && range && range.container instanceof Element) {\n      Logger.debug('[Router]', `binding ${index} falling back to range container`, {\n        containerNodeName: range.container.nodeName,\n      });\n      node = range.container;\n    }\n\n    if (!(node instanceof Element)) {\n      Logger.debug('[Router]', `binding ${index} failed: node is not an Element`);\n      return;\n    }\n    routerMeta.set(node, {\n      path: descriptor.pathValue ?? undefined,\n      query: descriptor.query ?? undefined,\n      hash: descriptor.hash ?? undefined,\n      replace: descriptor.replace ?? undefined,\n    });\n    // Mark element for debugging\n    (node as any).__routerDebug = {\n      path: descriptor.pathValue,\n      appliedAt: Date.now(),\n      componentId: descriptor.componentId,\n    };\n    Logger.debug('[Router]', `binding ${index} applied successfully`, {\n      path: descriptor.pathValue,\n      nodeName: node.nodeName,\n      isConnected: node.isConnected,\n      hasParent: !!node.parentElement,\n    });\n    applied += 1;\n  });\n  Logger.debug('[Router]', 'applied router bindings', { count: applied });\n}\n\nexport function getRouterMeta(element: Element | null): RouterMeta | undefined {\n  if (!element) {\n    return undefined;\n  }\n  let current: Element | null = element;\n  while (current) {\n    const meta = routerMeta.get(current);\n    if (meta?.path) {\n      return meta;\n    }\n    current = current.parentElement;\n  }\n  return undefined;\n}\n", "import { DomRegistry } from './dom-registry';\nimport { registerBindingsForSlot } from './events';\nimport { applyRouterBindings } from './router-bindings';\nimport { applyComponentRanges } from './manifest';\nimport { RefRegistry } from './refs';\nimport { UploadManager } from './uploads';\nimport { Logger } from './logger';\nimport type {\n  DiffOp,\n  FrameMessage,\n  ListChildOp,\n  ListInsOp,\n  ListDelOp,\n  ListMovOp,\n  ComponentPathDescriptor,\n  SlotPathDescriptor,\n  ListPathDescriptor,\n  BindingsPayload,\n} from './types';\n\nexport class Patcher {\n  constructor(private dom: DomRegistry, private refs?: RefRegistry, private uploads?: UploadManager) {}\n\n  applyFrame(frame: FrameMessage): void {\n    if (!Array.isArray(frame.patch)) {\n      return;\n    }\n    Logger.debug('[Patcher]', 'applying frame patch', { opCount: frame.patch.length });\n    this.applyOps(frame.patch);\n  }\n\n  applyOps(ops: DiffOp[]): void {\n    Logger.debug('[Patcher]', 'applying ops', { count: ops.length });\n    for (const op of ops) {\n      if (!Array.isArray(op) || op.length === 0) {\n        continue;\n      }\n      const kind = op[0];\n      switch (kind) {\n        case 'setText':\n          this.applySetText(op[1], op[2]);\n          break;\n        case 'setAttrs':\n          this.applySetAttrs(op[1], op[2] || {});\n          break;\n        case 'list':\n          this.applyList(op[1], op.slice(2) as ListChildOp[]);\n          break;\n      }\n    }\n  }\n\n  private applySetText(slotId: number, value: string): void {\n    const node = this.dom.getSlot(slotId);\n    if (!node) {\n      Logger.debug('[Patcher]', 'setText skipped (missing slot)', { slotId });\n      return;\n    }\n    if (node instanceof Text) {\n      node.textContent = value ?? '';\n      Logger.debug('[Patcher]', 'setText applied', { slotId, nodeType: 'Text' });\n      return;\n    }\n    if (node instanceof Element) {\n      node.textContent = value ?? '';\n      Logger.debug('[Patcher]', 'setText applied', { slotId, nodeType: node.tagName });\n    }\n  }\n\n  private applySetAttrs(slotId: number, attrs: Record<string, string>): void {\n    const node = this.dom.getSlot(slotId);\n    if (!(node instanceof Element)) {\n      Logger.debug('[Patcher]', 'setAttrs skipped (non-element)', { slotId });\n      return;\n    }\n    Object.entries(attrs ?? {}).forEach(([key, value]) => {\n      if (value === null || value === undefined || value === '') {\n        node.removeAttribute(key);\n      } else {\n        node.setAttribute(key, value);\n      }\n    });\n    Logger.debug('[Patcher]', 'setAttrs applied', { slotId, keys: Object.keys(attrs ?? {}) });\n  }\n\n  private applyList(slotId: number, childOps: ListChildOp[]): void {\n    const container = this.dom.getList(slotId);\n    if (!(container instanceof Element)) {\n      Logger.debug('[Patcher]', 'list op skipped (no container)', { slotId });\n      return;\n    }\n    Logger.debug('[Patcher]', 'list patch', { slotId, opCount: childOps.length });\n    childOps.forEach((op) => {\n      if (!Array.isArray(op)) {\n        return;\n      }\n      switch (op[0]) {\n        case 'del':\n          this.applyListDelete(slotId, container, op as ListDelOp);\n          break;\n        case 'ins':\n          this.applyListInsert(slotId, container, op as ListInsOp);\n          break;\n        case 'mov':\n          this.applyListMove(slotId, container, op as ListMovOp);\n          break;\n      }\n    });\n  }\n\n  private applyListDelete(slotId: number, container: Element, op: ListDelOp): void {\n    const key = op[1];\n    const record = this.dom.getRow(slotId, key);\n    if (!record) {\n      Logger.debug('[Patcher]', 'list delete skipped (missing row)', { slotId, key });\n      return;\n    }\n    record.nodes.forEach((node) => {\n      if (node.parentNode === container) {\n        container.removeChild(node);\n      }\n    });\n    this.dom.deleteRow(slotId, key);\n    Logger.debug('[Patcher]', 'list delete applied', { slotId, key });\n  }\n\n  private applyListInsert(slotId: number, container: Element, op: ListInsOp): void {\n    const [_, index, payload] = op;\n    const html = payload?.html ?? '';\n    if (!html) {\n      Logger.debug('[Patcher]', 'list insert skipped (no html)', { slotId, index });\n      return;\n    }\n    const template = document.createElement('template');\n    template.innerHTML = html;\n    const fragment = template.content;\n    const nodes = Array.from(fragment.childNodes);\n    if (nodes.length === 0) {\n      Logger.debug('[Patcher]', 'list insert skipped (no nodes)', { slotId, index });\n      return;\n    }\n    const beforeKey = this.dom.getRowKeyAt(slotId, index);\n    const before = beforeKey ? this.dom.getRowFirstNode(slotId, beforeKey) : null;\n    container.insertBefore(fragment, before ?? null);\n    this.dom.insertRow(slotId, payload?.key ?? '', nodes, index);\n    const root = nodes.find((node): node is Element => node instanceof Element) ?? null;\n    if (root) {\n      this.registerRowMetadata(\n        root,\n        payload?.componentPaths ?? [],\n        payload?.slotPaths,\n        payload?.listPaths,\n        payload?.bindings,\n      );\n    }\n    Logger.debug('[Patcher]', 'list insert applied', {\n      slotId,\n      index,\n      key: payload?.key,\n      nodeCount: nodes.length,\n    });\n  }\n\n  private applyListMove(slotId: number, container: Element, op: ListMovOp): void {\n    const from = op[1];\n    const to = op[2];\n    if (from === to) {\n      return;\n    }\n    const currentKey = this.dom.getRowKeyAt(slotId, from);\n    if (!currentKey) {\n      Logger.debug('[Patcher]', 'list move skipped (missing source key)', { slotId, from, to });\n      return;\n    }\n    const record = this.dom.getRow(slotId, currentKey);\n    if (!record) {\n      Logger.debug('[Patcher]', 'list move skipped (missing record)', { slotId, from, to });\n      return;\n    }\n    const targetKey = this.dom.getRowKeyAt(slotId, to);\n    const beforeNode = targetKey ? this.dom.getRowFirstNode(slotId, targetKey) : null;\n    record.nodes.forEach((node) => {\n      if (node.parentNode !== container) {\n        return;\n      }\n      container.insertBefore(node, beforeNode ?? null);\n    });\n    this.dom.moveRow(slotId, currentKey, to);\n    Logger.debug('[Patcher]', 'list move applied', { slotId, from, to, key: currentKey });\n  }\n  private registerRowMetadata(\n    root: Element,\n    componentPaths?: ComponentPathDescriptor[] | null,\n    slotPaths?: SlotPathDescriptor[] | null,\n    listPaths?: ListPathDescriptor[] | null,\n    bindings?: BindingsPayload | null,\n  ): void {\n    const overrides = applyComponentRanges(componentPaths ?? [], { root });\n    this.dom.registerSlotAnchors(slotPaths ?? undefined, overrides);\n    this.dom.registerLists(listPaths ?? undefined, overrides);\n    if (bindings?.slots) {\n      Object.entries(bindings.slots).forEach(([slot, specs]) => {\n        registerBindingsForSlot(Number(slot), specs);\n      });\n    }\n    if (bindings?.router) {\n      applyRouterBindings(bindings.router, overrides);\n    }\n    if (bindings?.refs) {\n      this.refs?.registerBindings(bindings.refs, overrides);\n    }\n    if (bindings?.uploads) {\n      this.uploads?.registerBindings(bindings.uploads, overrides, { replace: false });\n    }\n    Logger.debug('[Patcher]', 'row metadata registered', {\n      slots: bindings?.slots ? Object.keys(bindings.slots).length : 0,\n      routers: bindings?.router?.length ?? 0,\n      refs: bindings?.refs?.length ?? 0,\n      uploads: bindings?.uploads?.length ?? 0,\n    });\n  }\n}\n", "import { resolveNodeInComponent, type ComponentRange } from './manifest';\nimport type {\n  UploadBindingDescriptor,\n  UploadControlMessage,\n  UploadMeta,\n} from './types';\nimport type { LiveRuntime } from './runtime';\nimport { Logger } from './logger';\n\ntype BindingRecord = {\n  id: string;\n  element: HTMLInputElement;\n  descriptor: UploadBindingDescriptor;\n  changeHandler: (event: Event) => void;\n};\n\ntype ActiveUpload = {\n  xhr: XMLHttpRequest;\n  element: HTMLInputElement;\n};\n\nexport class UploadManager {\n  private bindings = new Map<string, BindingRecord>();\n  private elementToUpload = new WeakMap<Element, string>();\n  private active = new Map<string, ActiveUpload>();\n  private componentBindings = new Map<string, Set<string>>();\n\n  constructor(private runtime: LiveRuntime) {}\n\n  clear(): void {\n    this.bindings.forEach((binding) => {\n      binding.element.removeEventListener('change', binding.changeHandler);\n    });\n    this.bindings.clear();\n    this.componentBindings.clear();\n    this.active.forEach((upload) => upload.xhr.abort());\n    this.active.clear();\n    Logger.debug('[Uploads]', 'cleared bindings and active uploads');\n  }\n\n  prime(\n    descriptors?: UploadBindingDescriptor[] | null,\n    overrides?: Map<string, ComponentRange>,\n  ): void {\n    this.clear();\n    this.registerBindings(descriptors, overrides);\n    Logger.debug('[Uploads]', 'primed upload bindings', { count: descriptors?.length ?? 0 });\n  }\n\n  registerBindings(\n    descriptors?: UploadBindingDescriptor[] | null,\n    overrides?: Map<string, ComponentRange>,\n    options?: { replace?: boolean },\n  ): void {\n    if (!Array.isArray(descriptors)) {\n      return;\n    }\n    Logger.debug('[Uploads]', 'register bindings', {\n      count: descriptors.length,\n      replace: options?.replace !== false,\n    });\n    if (options?.replace === false) {\n      descriptors.forEach((descriptor) => {\n        if (!descriptor || typeof descriptor.uploadId !== 'string' || descriptor.uploadId.length === 0) {\n          return;\n        }\n        this.attachDescriptor(descriptor, overrides);\n      });\n      return;\n    }\n    const grouped = new Map<string, UploadBindingDescriptor[]>();\n    descriptors.forEach((descriptor) => {\n      if (!descriptor || typeof descriptor.uploadId !== 'string' || descriptor.uploadId.length === 0) {\n        return;\n      }\n      const componentId = descriptor.componentId || '__root__';\n      const list = grouped.get(componentId) ?? [];\n      list.push(descriptor);\n      grouped.set(componentId, list);\n    });\n    grouped.forEach((list, componentId) => {\n      this.replaceBindingsForComponent(componentId, list, overrides);\n    });\n  }\n\n  replaceBindingsForComponent(\n    componentId: string,\n    descriptors?: UploadBindingDescriptor[] | null,\n    overrides?: Map<string, ComponentRange>,\n  ): void {\n    const id = componentId || '__root__';\n    const existing = this.componentBindings.get(id);\n    if (existing) {\n      existing.forEach((uploadId) => this.detachBinding(uploadId));\n      this.componentBindings.delete(id);\n    }\n    if (!descriptors || descriptors.length === 0) {\n      return;\n    }\n    const next = new Set<string>();\n    descriptors.forEach((descriptor) => {\n      if (!descriptor || typeof descriptor.uploadId !== 'string' || descriptor.uploadId.length === 0) {\n        return;\n      }\n      this.attachDescriptor(descriptor, overrides);\n      next.add(descriptor.uploadId);\n    });\n    if (next.size > 0) {\n      this.componentBindings.set(id, next);\n    }\n    Logger.debug('[Uploads]', 'component bindings replaced', {\n      componentId: id,\n      count: descriptors?.length ?? 0,\n    });\n  }\n\n  handleControl(message: UploadControlMessage): void {\n    if (!message || !message.id) {\n      return;\n    }\n    Logger.debug('[Uploads]', 'control message', { op: message.op, id: message.id });\n    if (message.op === 'cancel') {\n      this.abortUpload(message.id, true);\n    } else if (message.op === 'error') {\n      this.abortUpload(message.id, true);\n    }\n  }\n\n  private attachDescriptor(\n    descriptor: UploadBindingDescriptor,\n    overrides?: Map<string, ComponentRange>,\n  ): void {\n    const node = resolveNodeInComponent(descriptor.componentId, descriptor.path, overrides);\n    const element = this.resolveInput(node);\n    if (!element) {\n      return;\n    }\n    const uploadId = descriptor.uploadId;\n    this.detachBinding(uploadId);\n    const handler = () => this.handleInputChange(uploadId, element, descriptor);\n    element.addEventListener('change', handler);\n    this.syncAttributes(element, descriptor);\n    this.bindings.set(uploadId, { id: uploadId, element, descriptor, changeHandler: handler });\n    this.elementToUpload.set(element, uploadId);\n    const componentId = descriptor.componentId || '__root__';\n    const set = this.componentBindings.get(componentId) ?? new Set<string>();\n    set.add(uploadId);\n    this.componentBindings.set(componentId, set);\n    Logger.debug('[Uploads]', 'attached upload descriptor', {\n      uploadId,\n      componentId,\n      multiple: Boolean(descriptor.multiple),\n    });\n  }\n\n  private detachBinding(uploadId: string): void {\n    const binding = this.bindings.get(uploadId);\n    if (!binding) {\n      return;\n    }\n    binding.element.removeEventListener('change', binding.changeHandler);\n    this.bindings.delete(uploadId);\n    this.elementToUpload.delete(binding.element);\n    this.abortUpload(uploadId, false);\n    const componentId = binding.descriptor.componentId || '__root__';\n    const set = this.componentBindings.get(componentId);\n    if (set) {\n      set.delete(uploadId);\n      if (set.size === 0) {\n        this.componentBindings.delete(componentId);\n      }\n    }\n  }\n\n  private resolveInput(node: Node | null): HTMLInputElement | null {\n    if (!node) {\n      return null;\n    }\n    if (node instanceof HTMLInputElement) {\n      return node;\n    }\n    if (node instanceof Element) {\n      if (node.tagName.toLowerCase() === 'input' && node.getAttribute('type') === 'file') {\n        return node as HTMLInputElement;\n      }\n      const descendant = node.querySelector('input[type=\"file\"]');\n      if (descendant instanceof HTMLInputElement) {\n        return descendant;\n      }\n    }\n    return null;\n  }\n\n  private syncAttributes(element: HTMLInputElement, descriptor: UploadBindingDescriptor): void {\n    if (Array.isArray(descriptor.accept) && descriptor.accept.length > 0) {\n      element.setAttribute('accept', descriptor.accept.join(','));\n    } else {\n      element.removeAttribute('accept');\n    }\n    if (descriptor.multiple) {\n      element.multiple = true;\n    } else {\n      element.multiple = false;\n      element.removeAttribute('multiple');\n    }\n  }\n\n  private handleInputChange(\n    uploadId: string,\n    element: HTMLInputElement,\n    descriptor: UploadBindingDescriptor,\n  ): void {\n    const files = element.files;\n    if (!files || files.length === 0) {\n      this.sendUploadMessage({ op: 'cancelled', id: uploadId });\n      this.abortUpload(uploadId, true);\n      return;\n    }\n    const file =\n      typeof files.item === 'function' ? files.item(0) : (files as any)[0] ?? null;\n    if (!file) {\n      this.sendUploadMessage({ op: 'cancelled', id: uploadId });\n      return;\n    }\n    if (typeof descriptor.maxSize === 'number' && descriptor.maxSize > 0 && file.size > descriptor.maxSize) {\n      this.sendUploadMessage({\n        op: 'error',\n        id: uploadId,\n        error: `File exceeds maximum size (${descriptor.maxSize} bytes)`,\n      });\n      element.value = '';\n      return;\n    }\n    const meta: UploadMeta = { name: file.name, size: file.size, type: file.type };\n    this.sendUploadMessage({ op: 'change', id: uploadId, meta });\n    this.startUpload(uploadId, file, element);\n    Logger.debug('[Uploads]', 'input change processed', {\n      uploadId,\n      file: file.name,\n      size: file.size,\n    });\n  }\n\n  private startUpload(uploadId: string, file: File, element: HTMLInputElement): void {\n    const sid = this.runtime.getSessionId();\n    if (!sid) {\n      return;\n    }\n    const base = this.runtime.getUploadEndpoint();\n    const target = this.buildUploadURL(base, sid, uploadId);\n    this.abortUpload(uploadId, false);\n    const xhr = new XMLHttpRequest();\n    xhr.upload.onprogress = (event: ProgressEvent<EventTarget>) => {\n      const loaded = event.loaded ?? 0;\n      const total = event.lengthComputable ? event.total : file.size;\n      this.sendUploadMessage({ op: 'progress', id: uploadId, loaded, total });\n    };\n    xhr.onerror = () => {\n      this.active.delete(uploadId);\n      this.sendUploadMessage({ op: 'error', id: uploadId, error: 'Upload failed' });\n    };\n    xhr.onabort = () => {\n      this.active.delete(uploadId);\n      this.sendUploadMessage({ op: 'cancelled', id: uploadId });\n    };\n    xhr.onload = () => {\n      this.active.delete(uploadId);\n      if (xhr.status < 200 || xhr.status >= 300) {\n        this.sendUploadMessage({\n          op: 'error',\n          id: uploadId,\n          error: `Upload failed (${xhr.status})`,\n        });\n      } else {\n        this.sendUploadMessage({ op: 'progress', id: uploadId, loaded: file.size, total: file.size });\n        element.value = '';\n      }\n    };\n    const form = new FormData();\n    form.append('file', file);\n    xhr.open('POST', target, true);\n    xhr.send(form);\n    this.active.set(uploadId, { xhr, element });\n    Logger.debug('[Uploads]', 'upload started', { uploadId, target });\n  }\n\n  private abortUpload(uploadId: string, clearInput: boolean): void {\n    const active = this.active.get(uploadId);\n    if (!active) {\n      return;\n    }\n    active.xhr.abort();\n    if (clearInput) {\n      active.element.value = '';\n    }\n    this.active.delete(uploadId);\n    Logger.debug('[Uploads]', 'upload aborted', { uploadId, cleared: clearInput });\n  }\n\n  private sendUploadMessage(payload: {\n    op: 'change' | 'progress' | 'error' | 'cancelled';\n    id: string;\n    meta?: UploadMeta;\n    loaded?: number;\n    total?: number;\n    error?: string;\n  }): void {\n    if (!payload.id) {\n      return;\n    }\n    this.runtime.sendUploadMessage(payload);\n    Logger.debug('[Uploads]', 'sent upload message', payload);\n  }\n\n  private buildUploadURL(base: string | undefined, sid: string, uploadId: string): string {\n    const normalized = (base && base.length > 0 ? base : '/pondlive/upload/').replace(/\\/+$/, '');\n    return `${normalized}/${encodeURIComponent(sid)}/${encodeURIComponent(uploadId)}`;\n  }\n}\n", "import type { MetadataEffect, MetadataTagPayload, LinkTagPayload, ScriptTagPayload } from './types';\nimport { Logger } from './logger';\n\nexport class MetadataManager {\n  private metaTags = new Map<string, HTMLMetaElement>();\n  private linkTags = new Map<string, HTMLLinkElement>();\n  private scriptTags = new Map<string, HTMLScriptElement>();\n  private descriptionMeta: HTMLMetaElement | null = null;\n\n  constructor() {\n    this.indexExistingTags();\n  }\n\n  private indexExistingTags(): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n\n    document.querySelectorAll('meta[data-live-key]').forEach((el) => {\n      if (el instanceof HTMLMetaElement) {\n        const key = el.getAttribute('data-live-key');\n        if (key) {\n          this.metaTags.set(key, el);\n          if (el.name === 'description') {\n            this.descriptionMeta = el;\n          }\n        }\n      }\n    });\n\n    document.querySelectorAll('link[data-live-key]').forEach((el) => {\n      if (el instanceof HTMLLinkElement) {\n        const key = el.getAttribute('data-live-key');\n        if (key) {\n          this.linkTags.set(key, el);\n        }\n      }\n    });\n\n    document.querySelectorAll('script[data-live-key]').forEach((el) => {\n      if (el instanceof HTMLScriptElement) {\n        const key = el.getAttribute('data-live-key');\n        if (key) {\n          this.scriptTags.set(key, el);\n        }\n      }\n    });\n  }\n\n  applyEffect(effect: MetadataEffect): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n\n    Logger.debug('[Metadata]', 'applying effect', effect);\n\n    if (effect.title !== undefined) {\n      document.title = effect.title;\n    }\n\n    if (effect.description !== undefined) {\n      this.updateDescription(effect.description);\n    } else if (effect.clearDescription) {\n      this.clearDescription();\n    }\n\n    if (effect.metaRemove) {\n      for (const key of effect.metaRemove) {\n        this.removeMeta(key);\n      }\n    }\n\n    if (effect.metaAdd) {\n      for (const payload of effect.metaAdd) {\n        this.addOrUpdateMeta(payload);\n      }\n    }\n\n    if (effect.linkRemove) {\n      for (const key of effect.linkRemove) {\n        this.removeLink(key);\n      }\n    }\n\n    if (effect.linkAdd) {\n      for (const payload of effect.linkAdd) {\n        this.addOrUpdateLink(payload);\n      }\n    }\n\n    if (effect.scriptRemove) {\n      for (const key of effect.scriptRemove) {\n        this.removeScript(key);\n      }\n    }\n\n    if (effect.scriptAdd) {\n      for (const payload of effect.scriptAdd) {\n        this.addOrUpdateScript(payload);\n      }\n    }\n  }\n\n  private updateDescription(content: string): void {\n    if (!this.descriptionMeta) {\n      this.descriptionMeta = document.createElement('meta');\n      this.descriptionMeta.name = 'description';\n      this.descriptionMeta.setAttribute('data-live-managed', 'true');\n      document.head.appendChild(this.descriptionMeta);\n    }\n    this.descriptionMeta.content = content;\n  }\n\n  private clearDescription(): void {\n    if (this.descriptionMeta && this.descriptionMeta.hasAttribute('data-live-managed')) {\n      this.descriptionMeta.remove();\n      this.descriptionMeta = null;\n    }\n  }\n\n  private addOrUpdateMeta(payload: MetadataTagPayload): void {\n    let el = this.metaTags.get(payload.key);\n\n    if (!el) {\n      el = document.createElement('meta');\n      el.setAttribute('data-live-key', payload.key);\n      document.head.appendChild(el);\n      this.metaTags.set(payload.key, el);\n    }\n\n    if (payload.name) el.name = payload.name;\n    if (payload.content !== undefined) el.content = payload.content;\n    if (payload.property) el.setAttribute('property', payload.property);\n    if (payload.charset) el.setAttribute('charset', payload.charset);\n    if (payload.httpEquiv) el.setAttribute('http-equiv', payload.httpEquiv);\n    if (payload.itemProp) el.setAttribute('itemprop', payload.itemProp);\n\n    if (payload.attrs) {\n      for (const [key, value] of Object.entries(payload.attrs)) {\n        el.setAttribute(key, value);\n      }\n    }\n\n    if (payload.name === 'description') {\n      this.descriptionMeta = el;\n    }\n  }\n\n  private removeMeta(key: string): void {\n    const el = this.metaTags.get(key);\n    if (el) {\n      if (el === this.descriptionMeta) {\n        this.descriptionMeta = null;\n      }\n      el.remove();\n      this.metaTags.delete(key);\n    }\n  }\n\n  private addOrUpdateLink(payload: LinkTagPayload): void {\n    let el = this.linkTags.get(payload.key);\n\n    if (!el) {\n      el = document.createElement('link');\n      el.setAttribute('data-live-key', payload.key);\n      document.head.appendChild(el);\n      this.linkTags.set(payload.key, el);\n    }\n\n    if (payload.rel) el.rel = payload.rel;\n    if (payload.href) el.href = payload.href;\n    if (payload.type) el.type = payload.type;\n    if (payload.as) el.setAttribute('as', payload.as);\n    if (payload.media) el.media = payload.media;\n    if (payload.hreflang) el.hreflang = payload.hreflang;\n    if (payload.title) el.title = payload.title;\n    if (payload.crossorigin) el.setAttribute('crossorigin', payload.crossorigin);\n    if (payload.integrity) el.integrity = payload.integrity;\n    if (payload.referrerpolicy) el.setAttribute('referrerpolicy', payload.referrerpolicy);\n    if (payload.sizes) el.setAttribute('sizes', payload.sizes);\n\n    if (payload.attrs) {\n      for (const [key, value] of Object.entries(payload.attrs)) {\n        el.setAttribute(key, value);\n      }\n    }\n  }\n\n  private removeLink(key: string): void {\n    const el = this.linkTags.get(key);\n    if (el) {\n      el.remove();\n      this.linkTags.delete(key);\n    }\n  }\n\n  private addOrUpdateScript(payload: ScriptTagPayload): void {\n    const existing = this.scriptTags.get(payload.key);\n    if (existing) {\n      existing.remove();\n      this.scriptTags.delete(payload.key);\n    }\n\n    const el = document.createElement('script');\n    el.setAttribute('data-live-key', payload.key);\n\n    if (payload.src) el.src = payload.src;\n    if (payload.type) el.type = payload.type;\n    if (payload.async) el.async = true;\n    if (payload.defer) el.defer = true;\n    if (payload.module) el.type = 'module';\n    if (payload.noModule) el.setAttribute('nomodule', '');\n    if (payload.crossorigin) el.setAttribute('crossorigin', payload.crossorigin);\n    if (payload.integrity) el.integrity = payload.integrity;\n    if (payload.referrerpolicy) el.setAttribute('referrerpolicy', payload.referrerpolicy);\n    if (payload.nonce) el.nonce = payload.nonce;\n    if (payload.inner) el.textContent = payload.inner;\n\n    if (payload.attrs) {\n      for (const [key, value] of Object.entries(payload.attrs)) {\n        el.setAttribute(key, value);\n      }\n    }\n\n    document.head.appendChild(el);\n    this.scriptTags.set(payload.key, el);\n  }\n\n  private removeScript(key: string): void {\n    const el = this.scriptTags.get(key);\n    if (el) {\n      el.remove();\n      this.scriptTags.delete(key);\n    }\n  }\n\n  dispose(): void {\n    this.metaTags.forEach((el) => {\n      if (el.hasAttribute('data-live-key')) {\n        el.remove();\n      }\n    });\n    this.linkTags.forEach((el) => {\n      if (el.hasAttribute('data-live-key')) {\n        el.remove();\n      }\n    });\n    this.scriptTags.forEach((el) => {\n      if (el.hasAttribute('data-live-key')) {\n        el.remove();\n      }\n    });\n    this.metaTags.clear();\n    this.linkTags.clear();\n    this.scriptTags.clear();\n    this.descriptionMeta = null;\n  }\n}\n", "import type { TemplatePayload, FrameMessage, DOMRequestMessage, Effect, DOMActionEffect, CookieEffect } from './types';\nimport type { LiveRuntime } from './runtime';\nimport { DomRegistry } from './dom-registry';\nimport { RefRegistry } from './refs';\nimport { Patcher } from './patcher';\nimport { registerSlotTable } from './events';\nimport { applyRouterBindings } from './router-bindings';\nimport type { ComponentPathDescriptor } from './types';\nimport type { ComponentRange } from './manifest';\nimport { UploadManager } from './uploads';\nimport { MetadataManager } from './metadata';\nimport { Logger } from './logger';\n\nexport interface HydrationOptions {\n  root?: ParentNode | null;\n}\n\nexport class HydrationManager {\n  private readonly runtime: LiveRuntime;\n  private readonly options: HydrationOptions;\n  private readonly dom = new DomRegistry();\n  private readonly refs: RefRegistry;\n  private readonly uploads: UploadManager;\n  private readonly patcher: Patcher;\n  private readonly metadata: MetadataManager;\n  private componentRanges?: Map<string, ComponentRange>;\n\n  constructor(runtime: LiveRuntime, options?: HydrationOptions) {\n    this.runtime = runtime;\n    this.options = options ?? {};\n    this.uploads = new UploadManager(runtime);\n    this.refs = new RefRegistry();\n    this.metadata = new MetadataManager();\n    this.patcher = new Patcher(this.dom, this.refs, this.uploads);\n    this.runtime.on('init', (msg) => this.applyTemplate(msg));\n    this.runtime.on('template', (msg) => this.applyTemplate(msg));\n    this.runtime.on('frame', (msg) => this.applyFrame(msg));\n    this.runtime.on('upload', (msg) => this.uploads.handleControl(msg));\n    this.runtime.on('domreq', (msg) => this.handleDOMRequest(msg));\n    const boot = this.runtime.getBootPayload();\n    if (boot) {\n      this.applyTemplate(boot);\n    }\n  }\n\n  private applyTemplate(payload: TemplatePayload): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n    if (typeof payload.html !== 'string') {\n      return;\n    }\n    const root = this.resolveRoot();\n    if (!root) {\n      return;\n    }\n    const componentPaths = payload.componentPaths as ComponentPathDescriptor[] | undefined;\n    Logger.debug('[Hydration]', 'applying template', {\n      slotPaths: payload.slotPaths?.length ?? 0,\n      listPaths: payload.listPaths?.length ?? 0,\n      componentPaths: componentPaths?.length ?? 0,\n      htmlLength: payload.html?.length ?? 0,\n    });\n    if (root instanceof Document) {\n      const container = root.body ?? root.documentElement ?? (root as unknown as HTMLElement);\n      if (container) {\n        container.innerHTML = payload.html;\n        pruneWhitespace(container);\n      }\n      const overrides = this.dom.prime(componentPaths, { root });\n      this.componentRanges = overrides;\n      this.primeRegistries(payload, container ?? root, overrides);\n      return;\n    }\n    if (root instanceof ShadowRoot) {\n      root.innerHTML = payload.html;\n      pruneWhitespace(root);\n      const overrides = this.dom.prime(componentPaths, { root });\n      this.componentRanges = overrides;\n      this.primeRegistries(payload, root, overrides);\n      return;\n    }\n    (root as Element).innerHTML = payload.html;\n    pruneWhitespace(root as ParentNode);\n    const overrides = this.dom.prime(componentPaths, { root });\n    this.componentRanges = overrides;\n    this.primeRegistries(payload, root as Element, overrides);\n  }\n\n  private applyFrame(frame: FrameMessage): void {\n    Logger.debug('[Hydration]', 'applying frame', {\n      seq: frame.seq,\n      ver: frame.ver,\n      patchOps: Array.isArray(frame.patch) ? frame.patch.length : 0,\n      effects: frame.effects?.length ?? 0,\n    });\n    this.patcher.applyFrame(frame);\n    if (frame.bindings?.slots) {\n      registerSlotTable(frame.bindings.slots);\n    }\n    if (frame.bindings?.router) {\n      applyRouterBindings(frame.bindings.router, this.componentRanges);\n    }\n    if (frame.bindings?.refs) {\n      this.refs.registerBindings(frame.bindings.refs, this.componentRanges);\n    }\n    if (frame.bindings?.uploads) {\n      this.uploads.registerBindings(frame.bindings.uploads, this.componentRanges);\n    }\n    if (frame.bindings?.slots === undefined && frame.bindings?.router) {\n      // no-op; placeholder for incremental updates\n    }\n    this.refs.apply(frame.refs);\n    if (frame.effects) {\n      this.applyEffects(frame.effects);\n    }\n    if (frame.nav) {\n      this.applyNavigation(frame.nav);\n    }\n    Logger.debug('[Hydration]', 'frame applied', {\n      hasSlots: Boolean(frame.bindings?.slots),\n      hasRouter: Boolean(frame.bindings?.router?.length),\n      hasRefs: Boolean(frame.bindings?.refs?.length),\n      hasUploads: Boolean(frame.bindings?.uploads?.length),\n      refDeltaAdd: frame.refs?.add ? Object.keys(frame.refs.add).length : 0,\n      refDeltaDel: frame.refs?.del?.length ?? 0,\n      effectsApplied: frame.effects?.length ?? 0,\n      navApplied: Boolean(frame.nav?.push || frame.nav?.replace),\n    });\n  }\n\n  private applyEffects(effects: Effect[]): void {\n    for (const effect of effects) {\n      if (effect.type === 'metadata') {\n        this.metadata.applyEffect(effect);\n      } else if (effect.type === 'dom') {\n        this.applyDOMAction(effect);\n      } else if (effect.type === 'cookies') {\n        this.applyCookieEffect(effect);\n      }\n    }\n  }\n\n  private applyDOMAction(effect: DOMActionEffect): void {\n    if (!effect.ref || !effect.kind) {\n      return;\n    }\n    const element = this.refs.get(effect.ref);\n    if (!element) {\n      Logger.debug('[Hydration]', 'DOM action skipped (element not found)', { ref: effect.ref, kind: effect.kind });\n      return;\n    }\n    try {\n      const kind = effect.kind;\n      if (kind === 'dom.call' && effect.method) {\n        if (typeof (element as any)[effect.method] === 'function') {\n          const args = Array.isArray(effect.args) ? effect.args : [];\n          (element as any)[effect.method](...args);\n          Logger.debug('[Hydration]', 'DOM action call', { ref: effect.ref, method: effect.method });\n        }\n      } else if (kind === 'dom.set' && effect.prop) {\n        (element as any)[effect.prop] = effect.value;\n        Logger.debug('[Hydration]', 'DOM action set', { ref: effect.ref, prop: effect.prop });\n      } else if (kind === 'dom.toggle' && effect.prop) {\n        (element as any)[effect.prop] = effect.value;\n        Logger.debug('[Hydration]', 'DOM action toggle', { ref: effect.ref, prop: effect.prop, value: effect.value });\n      } else if (kind === 'dom.class' && effect.class && element instanceof Element) {\n        if (effect.on === true) {\n          element.classList.add(effect.class);\n        } else {\n          element.classList.remove(effect.class);\n        }\n        Logger.debug('[Hydration]', 'DOM action class', { ref: effect.ref, class: effect.class, on: effect.on });\n      } else if (kind === 'dom.scroll' && element instanceof Element) {\n        const options: ScrollIntoViewOptions = {};\n        if (effect.behavior) options.behavior = effect.behavior as ScrollBehavior;\n        if (effect.block) options.block = effect.block as ScrollLogicalPosition;\n        if (effect.inline) options.inline = effect.inline as ScrollLogicalPosition;\n        element.scrollIntoView(options);\n        Logger.debug('[Hydration]', 'DOM action scroll', { ref: effect.ref, options });\n      }\n    } catch (error) {\n      Logger.warn('[Hydration]', 'DOM action failed', { ref: effect.ref, kind: effect.kind, error });\n    }\n  }\n\n  private applyCookieEffect(effect: CookieEffect): void {\n    if (typeof window === 'undefined' || typeof fetch !== 'function') {\n      return;\n    }\n    if (!effect.endpoint || !effect.sid || !effect.token) {\n      Logger.debug('[Hydration]', 'Cookie effect skipped (missing required fields)', effect);\n      return;\n    }\n    const method = effect.method || 'POST';\n    Logger.debug('[Hydration]', 'Applying cookie effect', { endpoint: effect.endpoint, method });\n    fetch(effect.endpoint, {\n      method,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        sid: effect.sid,\n        token: effect.token,\n      }),\n      credentials: 'include',\n    })\n      .then((response) => {\n        if (response.ok) {\n          Logger.debug('[Hydration]', 'Cookie effect succeeded', { endpoint: effect.endpoint });\n        } else {\n          Logger.warn('[Hydration]', 'Cookie effect failed', { endpoint: effect.endpoint, status: response.status });\n        }\n      })\n      .catch((error) => {\n        Logger.warn('[Hydration]', 'Cookie effect error', { endpoint: effect.endpoint, error });\n      });\n  }\n\n  private applyNavigation(nav: { push?: string; replace?: string; back?: boolean }): void {\n    if (typeof window === 'undefined' || typeof history === 'undefined') {\n      return;\n    }\n    if (!nav.push && !nav.replace && !nav.back) {\n      return;\n    }\n    if (nav.back) {\n      try {\n        history.back();\n        Logger.debug('[Hydration]', 'Navigation back');\n      } catch (error) {\n        Logger.warn('[Hydration]', 'Navigation back failed', { error });\n      }\n      return;\n    }\n    const url = nav.replace || nav.push;\n    if (!url || typeof url !== 'string') {\n      Logger.debug('[Hydration]', 'Navigation skipped (invalid URL)', nav);\n      return;\n    }\n    try {\n      if (nav.replace) {\n        history.replaceState(null, '', nav.replace);\n        Logger.debug('[Hydration]', 'Navigation replace', { url: nav.replace });\n      } else {\n        history.pushState(null, '', nav.push!);\n        Logger.debug('[Hydration]', 'Navigation push', { url: nav.push });\n      }\n    } catch (error) {\n      Logger.warn('[Hydration]', 'Navigation failed', { url, error });\n    }\n  }\n\n  private resolveRoot(): Element | Document | ShadowRoot | null {\n    const root = this.options.root ?? document.body ?? document;\n    if (!root) {\n      return null;\n    }\n    if (root instanceof Element || root instanceof Document || root instanceof ShadowRoot) {\n      return root;\n    }\n    return document.body ?? document;\n  }\n\n  private primeRegistries(payload: TemplatePayload, root: ParentNode | null, overrides?: Map<string, any>): void {\n    if (!root) {\n      return;\n    }\n    this.dom.reset();\n    this.refs.clear();\n    this.refs.apply(payload.refs);\n    if (payload.bindings?.slots) {\n      registerSlotTable(payload.bindings.slots);\n    } else {\n      registerSlotTable(undefined);\n    }\n    const listRowIndex = buildListRowIndex(payload);\n    this.dom.registerSlotAnchors(payload.slotPaths, overrides);\n    if (Array.isArray(payload.slots)) {\n      this.dom.registerSlots(payload.slots);\n    }\n    this.dom.registerListContainers(payload.listPaths, overrides, listRowIndex);\n    if (payload.bindings?.router) {\n      applyRouterBindings(payload.bindings.router, overrides);\n    }\n    if (payload.bindings?.refs) {\n      this.refs.registerBindings(payload.bindings.refs, overrides);\n    }\n    this.uploads.prime(payload.bindings?.uploads ?? null, overrides);\n    Logger.debug('[Hydration]', 'registries primed', {\n      slots: payload.slotPaths?.length ?? 0,\n      lists: payload.listPaths?.length ?? 0,\n      routers: payload.bindings?.router?.length ?? 0,\n      refs: payload.bindings?.refs?.length ?? 0,\n      uploads: payload.bindings?.uploads?.length ?? 0,\n    });\n  }\n\n  private handleDOMRequest(msg: DOMRequestMessage): void {\n    if (!msg || !msg.id || !msg.ref) {\n      this.runtime.sendDOMResponse({ id: msg?.id ?? '', error: 'invalid request' });\n      return;\n    }\n    const element = this.refs.get(msg.ref);\n    if (!element) {\n      this.runtime.sendDOMResponse({ id: msg.id, error: 'element not found' });\n      return;\n    }\n    try {\n      let result: any;\n      const values: Record<string, any> = {};\n      if (msg.method && typeof (element as any)[msg.method] === 'function') {\n        const args = Array.isArray(msg.args) ? msg.args : [];\n        result = (element as any)[msg.method](...args);\n      }\n      if (Array.isArray(msg.props)) {\n        msg.props.forEach((prop) => {\n          if (prop) {\n            values[prop] = (element as any)[prop];\n          }\n        });\n      }\n      this.runtime.sendDOMResponse({\n        id: msg.id,\n        result,\n        values: Object.keys(values).length > 0 ? values : undefined,\n      });\n    } catch (error) {\n      this.runtime.sendDOMResponse({\n        id: msg.id,\n        error: error instanceof Error ? error.message : 'unknown error',\n      });\n    }\n  }\n\n  getRegistry(): DomRegistry {\n    return this.dom;\n  }\n}\n\nfunction pruneWhitespace(root: ParentNode | null): void {\n  if (!root || typeof Node === 'undefined') {\n    return;\n  }\n  const doc = (root instanceof Document ? root : root.ownerDocument) ?? document;\n  if (!doc || typeof doc.createTreeWalker !== 'function') {\n    return;\n  }\n  const walker = doc.createTreeWalker(root, NodeFilter.SHOW_TEXT, null);\n  const removals: Node[] = [];\n  let current = walker.nextNode();\n  while (current) {\n    if (current.nodeType === Node.TEXT_NODE) {\n      const text = current.textContent ?? '';\n      if (!text.trim()) {\n        removals.push(current);\n      }\n    }\n    current = walker.nextNode();\n  }\n  removals.forEach((node) => {\n    if (node.parentNode) {\n      node.parentNode.removeChild(node);\n    }\n  });\n}\n\nfunction buildListRowIndex(payload: TemplatePayload): Map<number, { key: string; count: number }[]> {\n  const map = new Map<number, { key: string; count: number }[]>();\n  if (!payload || !Array.isArray(payload.d)) {\n    return map;\n  }\n  const slots = Array.isArray(payload.slots) ? payload.slots : [];\n  payload.d.forEach((slot, index) => {\n    if (!slot || slot.kind !== 'list' || !Array.isArray(slot.list) || slot.list.length === 0) {\n      return;\n    }\n    const entries = slot.list\n      .map((row) => {\n        if (!row || typeof row.key !== 'string' || row.key.length === 0) {\n          return undefined;\n        }\n        const count = Math.max(1, Number(row.rootCount) || 1);\n        return { key: row.key, count };\n      })\n      .filter((entry): entry is { key: string; count: number } => Boolean(entry));\n    if (entries.length === 0) {\n      return;\n    }\n    const slotId = slots[index]?.anchorId ?? index;\n    map.set(slotId, entries);\n  });\n  return map;\n}\n", "interface ExtractOptions {\n  refElement?: Element;\n}\n\nexport function extractEventDetail(event: Event, props?: string[] | null, options?: ExtractOptions): Record<string, unknown> | undefined {\n  if (!Array.isArray(props) || props.length === 0) {\n    return undefined;\n  }\n  const detail: Record<string, unknown> = {};\n  props.forEach((path) => {\n    if (typeof path !== 'string' || path.length === 0) {\n      return;\n    }\n    const value = resolvePath(path, event, options);\n    if (value !== undefined) {\n      detail[path] = value;\n    }\n  });\n  return Object.keys(detail).length > 0 ? detail : undefined;\n}\n\nfunction resolvePath(path: string, event: Event, options?: ExtractOptions): unknown {\n  const segments = path.split('.').map((segment) => segment.trim()).filter(Boolean);\n  if (segments.length === 0) {\n    return undefined;\n  }\n  const root = segments.shift()!;\n  let current: any;\n  switch (root) {\n    case 'event':\n      current = event;\n      break;\n    case 'target':\n      current = event.target ?? null;\n      break;\n    case 'currentTarget':\n      current = event.currentTarget ?? null;\n      break;\n    case 'element':\n    case 'ref':\n      current = options?.refElement ?? (event.currentTarget instanceof Element ? event.currentTarget : null);\n      break;\n    default:\n      return undefined;\n  }\n  for (const segment of segments) {\n    if (current == null) {\n      return undefined;\n    }\n    try {\n      current = current[segment as keyof typeof current];\n    } catch {\n      return undefined;\n    }\n  }\n  return serializeValue(current);\n}\n\nfunction serializeValue(value: unknown): unknown {\n  if (value === null || value === undefined) {\n    return null;\n  }\n  const type = typeof value;\n  if (type === 'string' || type === 'number' || type === 'boolean') {\n    return value;\n  }\n  if (Array.isArray(value)) {\n    const mapped = value.map(serializeValue).filter((entry) => entry !== undefined);\n    return mapped.length > 0 ? mapped : null;\n  }\n  if (value instanceof Date) {\n    return value.toISOString();\n  }\n  if (value instanceof DOMTokenList) {\n    return Array.from(value);\n  }\n  if (value instanceof Node) {\n    return undefined;\n  }\n  try {\n    return JSON.parse(JSON.stringify(value));\n  } catch {\n    return undefined;\n  }\n}\n", "import { getSlotBindings, getSlotsForEvent, getRegisteredSlotEvents, observeSlotEvents } from './events';\nimport { getRouterMeta } from './router-bindings';\nimport { DomRegistry } from './dom-registry';\nimport type { LiveRuntime } from './runtime';\nimport { extractEventDetail } from './event-detail';\nimport { Logger } from './logger';\n\nexport class EventDelegation {\n  private handlers = new Map<string, EventListener>();\n  private stopSlotObserver?: () => void;\n\n  constructor(private dom: DomRegistry, private runtime: LiveRuntime) {}\n\n  setup(): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n    this.registerEvents(['click']);\n    this.registerEvents(getRegisteredSlotEvents());\n    this.stopSlotObserver = observeSlotEvents((event) => this.bind(event));\n    Logger.debug('[Delegation]', 'event delegation setup complete', {\n      handlers: this.handlers.size,\n    });\n  }\n\n  teardown(): void {\n    if (typeof document === 'undefined') {\n      return;\n    }\n    if (this.stopSlotObserver) {\n      this.stopSlotObserver();\n      this.stopSlotObserver = undefined;\n    }\n    this.handlers.forEach((listener, event) => {\n      document.removeEventListener(event, listener, true);\n    });\n    this.handlers.clear();\n    Logger.debug('[Delegation]', 'event delegation torn down');\n  }\n\n  registerEvents(events: string[]): void {\n    events.forEach((event) => this.bind(event));\n  }\n\n  private bind(event: string): void {\n    if (this.handlers.has(event) || typeof document === 'undefined') {\n      return;\n    }\n    const listener = (e: Event) => this.handleEvent(event, e);\n    document.addEventListener(event, listener, true);\n    this.handlers.set(event, listener);\n    Logger.debug('[Delegation]', 'bound event listener', { event });\n  }\n\n  private handleEvent(event: string, e: Event): void {\n    const target = e.target;\n    if (!(target instanceof Element)) {\n      return;\n    }\n\n    const router = getRouterMeta(target);\n\n    if (event === 'click') {\n      // Check parent chain for debug markers\n      let debugInfo: any[] = [];\n      let current: Element | null = target;\n      while (current && debugInfo.length < 5) {\n        const debug = (current as any).__routerDebug;\n        debugInfo.push({\n          tag: current.tagName,\n          hasDebug: !!debug,\n          debugPath: debug?.path,\n          isConnected: current.isConnected,\n        });\n        current = current.parentElement;\n      }\n\n      Logger.debug('[Delegation]', 'click event', {\n        tag: target.tagName,\n        hasRouterMeta: !!router,\n        hasPath: !!router?.path,\n        parentChain: debugInfo,\n      });\n    }\n\n    if (router && router.path && event === 'click') {\n      Logger.debug('[Delegation]', 'router navigation triggered', {\n        path: router.path,\n        query: router.query,\n        hash: router.hash,\n        replace: router.replace,\n      });\n      this.runtime.sendNavigation(router.path, router.query ?? '', router.hash ?? '');\n      e.preventDefault();\n      return;\n    }\n\n    const slotIds = getSlotsForEvent(event);\n    for (const slotId of slotIds) {\n      const specs = getSlotBindings(slotId) ?? [];\n      const node = this.dom.getSlot(slotId);\n      if (node instanceof Element && (node === target || node.contains(target))) {\n        const binding = specs.find((spec) => spec.event === event);\n        if (binding) {\n          const detail = extractEventDetail(e, binding.props);\n          this.runtime.sendEvent(binding.handler, detail ? { name: event, detail } : { name: event });\n          Logger.debug('[Delegation]', 'slot event dispatched', {\n            slotId,\n            handler: binding.handler,\n            event,\n          });\n          break;\n        }\n      }\n    }\n  }\n}\n", "import { LiveRuntime } from './runtime';\nimport type { RuntimeOptions } from './runtime';\nimport { HydrationManager } from './hydration';\nimport { EventDelegation } from './event-delegation';\nimport type { BootPayload, ConnectionState, EventPayload } from './types';\n\nexport class LiveUI {\n  private readonly runtime: LiveRuntime;\n  private readonly _hydration: HydrationManager;\n  private readonly events: EventDelegation;\n\n  constructor(options?: RuntimeOptions) {\n    this.runtime = new LiveRuntime(options);\n    this._hydration = new HydrationManager(this.runtime);\n    this.events = new EventDelegation(this._hydration.getRegistry(), this.runtime);\n    this.events.setup();\n  }\n\n  connect(): Promise<void> {\n    return this.runtime.connect();\n  }\n\n  disconnect(): void {\n    this.runtime.disconnect();\n    this.events.teardown();\n  }\n\n  destroy(): void {\n    this.runtime.destroy();\n    this.events.teardown();\n  }\n\n  getState(): ConnectionState {\n    return this.runtime.getState();\n  }\n\n  getBootPayload(): BootPayload | null {\n    return this.runtime.getBootPayload();\n  }\n\n  on<K extends Parameters<LiveRuntime['on']>[0]>(\n    event: K,\n    listener: Parameters<LiveRuntime['on']>[1],\n  ): ReturnType<LiveRuntime['on']> {\n    return this.runtime.on(event, listener);\n  }\n\n  once<K extends Parameters<LiveRuntime['once']>[0]>(\n    event: K,\n    listener: Parameters<LiveRuntime['once']>[1],\n  ): ReturnType<LiveRuntime['once']> {\n    return this.runtime.once(event, listener);\n  }\n\n  off<K extends Parameters<LiveRuntime['off']>[0]>(\n    event: K,\n    listener: Parameters<LiveRuntime['off']>[1],\n  ): void {\n    this.runtime.off(event, listener);\n  }\n\n  sendEvent(handlerId: string, payload: EventPayload, cseq?: number): void {\n    this.runtime.sendEvent(handlerId, payload, cseq);\n  }\n\n  sendNavigation(path: string, q: string, hash?: string): void {\n    this.runtime.sendNavigation(path, q, hash);\n  }\n\n  getHydrationManager(): HydrationManager {\n    return this._hydration;\n  }\n}\n\nexport { LiveRuntime } from './runtime';\nexport type { RuntimeOptions } from './runtime';\nexport * from './types';\nexport default LiveUI;\n"],
  "mappings": "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",
  "names": ["exports", "PresenceEventTypes", "ServerActions", "ClientActions", "ChannelState", "ErrorTypes", "SystemSender", "ChannelReceiver", "Events", "PubSubEvents", "exports", "exports", "message", "_Channel_emptyQueue", "_Channel_init", "_Channel_onMessage", "_Channel_publish", "_Channel_subscribeToPresence", "PondClient", "_PondClient_createPublisher", "_PondClient_handleAcknowledge", "_PondClient_init", "WebSocket", "PondClient", "PondClient", "clampIndex", "overrides"]
}
